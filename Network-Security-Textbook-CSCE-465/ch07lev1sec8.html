<html><head><title>7.8. Euler's Theorem</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch07lev1sec7.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch07lev1sec9.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch07lev1sec8"></a>
<h3 id="title-IDAIH0CG" class="docSection1Title">7.8. Euler's Theorem</h3>
<p class="docText"><span class="docEmphStrong">Theorem:</span> For all <span class="docEmphasis">a</span> in <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>*, <span class="docEmphasis">a</span><sup>&#966;(<span class="docEmphasis">n</span>)</sup> = 1 mod <span class="docEmphasis">n</span>.</p>
<p class="docText"><span class="docEmphStrong">Proof:</span> Multiply all &#966;(<span class="docEmphasis">n</span>) elements of <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>* together, and call the product <span class="docEmphasis">x</span>. Notice that since <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>* is closed under multiplication, <span class="docEmphasis">x</span> is in <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>* and so has an inverse <span class="docEmphasis">x</span><sup>-1</sup>. Now multiply each element of <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>* by <span class="docEmphasis">a</span>, and multiply all those together. The result will be <span class="docEmphasis">a</span><sup>&#966;(<span class="docEmphasis">n</span>)</sup><span class="docEmphasis">x</span>. But remember that multiplying the elements of <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>* by <span class="docEmphasis">a</span> merely rearranges them (see <a class="docLink" href="ch07lev1sec9.html#ch07lev1sec9">Homework Problem 6</a>), so the product must also be <span class="docEmphasis">x</span>. In other words, <span class="docEmphasis">a</span><sup>&#966;(<span class="docEmphasis">n</span>)</sup><span class="docEmphasis">x</span> = <span class="docEmphasis">x</span>. Multiplying both sides by <span class="docEmphasis">x</span><sup>-1</sup> gives the desired result.</p>
<p class="docText"><span class="docEmphStrong">Euler's Theorem Variant:</span> For all <span class="docEmphasis">a</span> in <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>*, and any non-negative integer <span class="docEmphasis">k</span>, <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span> mod <span class="docEmphasis">n</span>.</p>
<p class="docText"><span class="docEmphStrong">Proof:</span> <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)</sup><span class="docEmphasis">a</span> = <span class="docEmphasis">a</span><sup>&#966;(<span class="docEmphasis">n</span>)<span class="docEmphasis">k</span></sup> <span class="docEmphasis">a</span> = 1<span class="docEmphasis"><sup>k</sup>a</span> = <span class="docEmphasis">a</span>.</p>
<p class="docText">The variant doesn't tell us that raising any number <span class="docEmphasis">m</span> to the power <span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>) + 1 gets <span class="docEmphasis">m</span> back mod <span class="docEmphasis">n</span>. It only works for <span class="docEmphasis">m</span> in <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>*, which means <span class="docEmphasis">m</span> must be relatively prime to <span class="docEmphasis">n</span>. It turns out that for numbers <span class="docEmphasis">n</span> of the form we are interested in for RSA (the product of two primes), it is still the case that <span class="docEmphasis">m</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">m</span> mod <span class="docEmphasis">n</span>, even if <span class="docEmphasis">m</span> was not relatively prime to <span class="docEmphasis">n</span>.</p>
<p class="docText">Do we really care? What is the probability that we'll ever find a number to encrypt that isn't relatively prime to <span class="docEmphasis">n</span>? (See <a class="docLink" href="ch07lev1sec9.html#ch07lev1sec9">Homework Problem 11</a>.) Well, in case we care, RSA will still work even if the message is not relatively prime to <span class="docEmphasis">n</span>. And the proof isn't very hard.</p>
<a name="ch07lev2sec2"></a>
<h4 id="title-IDA0O0CG" class="docSection2Title">7.8.1. A Generalization of Euler's Theorem</h4>
<p class="docText">We will show that for numbers <span class="docEmphasis">n</span> of the form used in RSA, namely <span class="docEmphasis">n</span> = <span class="docEmphasis">pq</span>, where <span class="docEmphasis">p</span> and <span class="docEmphasis">q</span> are distinct primes, <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span> mod <span class="docEmphasis">n</span> for all <span class="docEmphasis">a</span> in <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span> (not just for <span class="docEmphasis">a</span> in <span class="docEmphStrong">Z</span><span class="docEmphasis"><sub>n</sub></span>*) as long as <span class="docEmphasis">k</span> is a non-negative integer. We will use the Chinese Remainder Theorem.</p>
<p class="docText">If <span class="docEmphasis">a</span> is relatively prime to <span class="docEmphasis">n</span>, the result is true by Euler's Theorem Variant. So our only problem is if <span class="docEmphasis">a</span> is not relatively prime to <span class="docEmphasis">n</span>, which means <span class="docEmphasis">a</span> is a multiple of <span class="docEmphasis">p</span> or <span class="docEmphasis">q</span>. Let's say <span class="docEmphasis">a</span> is a multiple of <span class="docEmphasis">q</span>. Let's compute the decomposed representation for <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> mod <span class="docEmphasis">n</span>. In other words, we want to find out what <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> is mod <span class="docEmphasis">p</span> and mod <span class="docEmphasis">q</span>. Then, by the Chinese Remainder Theorem, we'll know what it is mod <span class="docEmphasis">n</span>.</p>
<p class="docText">Since <span class="docEmphasis">a</span> is a multiple of <span class="docEmphasis">q</span>, it must be relatively prime to <span class="docEmphasis">p</span> (or else <span class="docEmphasis">a</span> is a multiple of <span class="docEmphasis">n</span>, in which case it is 0 and the result is trivially true). Since <span class="docEmphasis">a</span> is relatively prime to <span class="docEmphasis">p</span>, by Euler's Theorem <span class="docEmphasis">a</span><sup>&#966;(<span class="docEmphasis">p</span>)</sup> = 1 mod <span class="docEmphasis">p</span>. Since &#966;(<span class="docEmphasis">n</span>) = &#966;(<span class="docEmphasis">p</span>)&#966;(<span class="docEmphasis">q</span>), we find that, mod <span class="docEmphasis">p</span>, <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)</sup>&#183;<span class="docEmphasis">a</span> = <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">p</span>)&#966;(<span class="docEmphasis">q</span>)</sup>&#183;<span class="docEmphasis">a</span> = 1<sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">q</span>)</sup>&#183;<span class="docEmphasis">a</span> = <span class="docEmphasis">a</span>. And mod <span class="docEmphasis">q</span>, <span class="docEmphasis">a</span> = 0, so <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = 0<sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = 0 = <span class="docEmphasis">a</span>.</p>
<p class="docText">So <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span> mod <span class="docEmphasis">p</span> and <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span> mod <span class="docEmphasis">q</span>, so by the Chinese Remainder Theorem, <span class="docEmphasis">a</span><sup><span class="docEmphasis">k</span>&#966;(<span class="docEmphasis">n</span>)+1</sup> = <span class="docEmphasis">a</span> mod <span class="docEmphasis">n</span>.</p>
<a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch07lev1sec7.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch07lev1sec9.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>