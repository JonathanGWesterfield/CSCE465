<html><head><title>5.6. SHA-1</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05lev1sec5.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec7.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch05lev1sec6"></a>
<h3 id="title-IDAXD2NF" class="docSection1Title">5.6. SHA-1</h3>
<p class="docText"><a name="iddle1699"></a><a name="iddle1991"></a>SHA-1 (<span class="docEmphStrong">secure hash algorithm</span>) was proposed by NIST as a message digest function. SHA-1 takes a message of length at most 2<sup>64</sup> bits and produces a 160-bit output. It is similar to the MD5 message digest function, but it is a little slower to execute and presumably more secure. MD4 made three passes over each block of data; MD5 made four; SHA-1 makes five. It also produces a 160-bit digest as opposed to the 128 of the MDs.</p>
<a name="ch05lev2sec19"></a>
<h4 id="title-IDAVE2NF" class="docSection2Title">5.6.1. SHA-1 Message Padding</h4>
<p class="docText">SHA-1 pads messages in the same manner as MD4 and MD5, except that SHA-1 is not defined for a message that is longer than 2<sup>64</sup> bits. We don't consider that a problem. If there were such a message it would take several hundred years to transmit it at 10 Gigabits per second, and it would take even longer to compute the SHA-1 message digest for it at 1000 MIPS. As our grandmothers would surely have said, had the occasion arisen,</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="1"><col width="550"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">If you can't say something in less that 2<sup>64</sup> bits, you shouldn't say it at all</span>.</p></td></tr></table></p><br />
<a name="ch05lev2sec20"></a>
<h4 id="title-IDAEG2NF" class="docSection2Title">5.6.2. Overview of SHA-1 Message Digest Computation</h4>
<p class="docText">Just like MD4 and MD5, SHA-1 operates in stages (see <a class="docLink" href="ch05lev1sec5.html#ch05fig08">Figure 5-8</a>). Each stage mangles the pre-stage message digest by a sequence of operations based on the current message block. At the end of the stage, each word of the mangled message digest is added to its pre-stage value to produce the post-stage value (which becomes the pre-stage value for the next stage). Therefore, the current value of the message digest must be saved at the beginning of the stage so that it can be added in at the end of the stage.</p>
<p class="docText">The 160-bit message digest consists of five 32-bit words. Let's call them <span class="docEmphasis">A</span>, <span class="docEmphasis">B</span>, <span class="docEmphasis">C</span>, <span class="docEmphasis">D</span>, and <span class="docEmphasis">E</span>. Before the first stage they are set to <span class="docEmphasis">A</span> = 67452301<sub>16</sub>, <span class="docEmphasis">B</span> = efcdab89<sub>16</sub>, <span class="docEmphasis">C</span> = 98badcfe<sub>16</sub>, <span class="docEmphasis">D</span> = 10325476<sub>16</sub>, <span class="docEmphasis">E</span> = c3d2e1f0<sub>16</sub>. After the last stage, the value of <span class="docEmphasis">A</span>|<span class="docEmphasis">B</span>|<span class="docEmphasis">C</span>|<span class="docEmphasis">D</span>|<span class="docEmphasis">E</span> is the message digest for the entire message.</p>
<p class="docText">SHA-1 is extremely similar in structure to MD4 and MD5, even more so than their descriptions might indicate (see <a class="docLink" href="ch05lev1sec8.html#ch05qa1q7">Homework Problem 7</a>).</p>
<a name="ch05lev2sec21"></a>
<h4 id="title-IDATI2NF" class="docSection2Title">5.6.3. SHA-1 Operation on a 512-bit Block</h4>
<p class="docText">At the start of each stage, the 512-bit message block is used to create a 5x512-bit chunk (see <a class="docLink" href="#ch05fig09">Figure 5-9</a>). The first 512 bits of the chunk consist of the message block. The rest gets filled in, a 32-bit word at a time, according to the bizarre rule that the <span class="docEmphasis">n</span><sup>th</sup> word (starting from word 16, since words 0 through 15 consist of the 512-bit message block) is the <img src="U2295.GIF" border="0" /> of words <span class="docEmphasis">n</span>-3, <span class="docEmphasis">n</span>-8, <span class="docEmphasis">n</span>-14, and <span class="docEmphasis">n</span>-16. In SHA-1, the <img src="U2295.GIF" border="0" /> of words <span class="docEmphasis">n</span>-3, <span class="docEmphasis">n</span>-8, <span class="docEmphasis">n</span>-14, and <span class="docEmphasis">n</span>-16 is rotated left one bit before being stored as word <span class="docEmphasis">n</span>; this is the only modification from the original SHA.</p>
<a name="ch05fig09"></a><p><center>
<h5 class="docFigureTitle">Figure 5-9. Inner Loop of SHA-1Â80 Iterations per Block</h5>
</center></p><p class="docText"><div class="v1"><a target="_blank" href="05fig09_alt.jpg">[View full size image]</a></div><img border="0" alt="" width="500" height="126" src="05fig09.jpg" /></p>
<br />
<p class="docText">Now we have a buffer of eighty 32-bit words (5x512 bits). Let's call the eighty 32-bit words <span class="docEmphasis">W</span><sub>0</sub>, <span class="docEmphasis">W</span><sub>1</sub>, ...<span class="docEmphasis">W</span><sub>79</sub>. Now, a little program:</p>
<p class="docText">For <span class="docEmphasis">t</span> = 0 through 79, modify <span class="docEmphasis">A</span>, <span class="docEmphasis">B</span>, <span class="docEmphasis">C</span>, <span class="docEmphasis">D</span>, and <span class="docEmphasis">E</span> as follows:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="4"><col width="100"></col><col width="100"></col><col width="100"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">B</span> = old <span class="docEmphasis">A</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">C</span> = old <span class="docEmphasis">B</span>
<img border="0" alt="" width="10" height="11" src="136equ06.jpg" />


 30</p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">D</span> = old <span class="docEmphasis">C</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">E</span> = old <span class="docEmphasis">D</span></p></td></tr></table></p><br />
<p class="docText">&quot;Hmm,&quot; you're thinking. &quot;This isn't too hard to follow.&quot; Well, we haven't yet said what the new <span class="docEmphasis">A</span> is! Since the new <span class="docEmphasis">A</span> depends on the old <span class="docEmphasis">A</span>, <span class="docEmphasis">B</span>, <span class="docEmphasis">C</span>, <span class="docEmphasis">D</span>, and <span class="docEmphasis">E</span>, a programmer would first compute the new <span class="docEmphasis">A</span> into a temporary variable <span class="docEmphasis">V</span>, and then after computing the new values of <span class="docEmphasis">B</span>, <span class="docEmphasis">C</span>, <span class="docEmphasis">D</span>, and <span class="docEmphasis">E</span>, set the new <span class="docEmphasis">A</span> equal to <span class="docEmphasis">V</span>. For clarity we didn't bother. In the following computation, everything to the right of the equal refers to the old values of <span class="docEmphasis">A</span>, <span class="docEmphasis">B</span>, <span class="docEmphasis">C</span>, <span class="docEmphasis">D</span>, and <span class="docEmphasis">E</span>:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="1"><col width="550"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">A</span> = <span class="docEmphasis">E</span> + (<span class="docEmphasis">A</span>
<img border="0" alt="" width="10" height="11" src="136equ06.jpg" />


5) + <span class="docEmphasis">W<sub>t</sub></span> + <span class="docEmphasis">K<sub>t</sub></span> + <span class="docEmphasis">f</span>(<span class="docEmphasis">t</span>,<span class="docEmphasis">B</span>,<span class="docEmphasis">C</span>,<span class="docEmphasis">D</span>)</p></td></tr></table></p><br />
<p class="docText">Let's look at each of the terms. <span class="docEmphasis">E</span> and <span class="docEmphasis">A</span>
<img border="0" alt="" width="10" height="11" src="136equ06.jpg" />


5 are easy. <span class="docEmphasis">W<sub>t</sub></span> is the <span class="docEmphasis">t</span><sup>th</sup> 32-bit word in the 80-word block. <span class="docEmphasis">K<sub>t</sub></span> is a constant, but it varies according to which word you're on (do you like the concept of a variable constant?):</p>
<a name="f141equ01"></a>
<p class="docText">
<img border="0" alt="" width="275" height="81" src="141equ03.jpg" /></p>
<br />
<p class="docText"><a name="iddle1428"></a><span class="docEmphasis">f</span>(<span class="docEmphasis">t</span>,<span class="docEmphasis">B</span>,<span class="docEmphasis">C</span>,<span class="docEmphasis">D</span>) is a function that varies according to which of the eighty words you're working on:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="2"><col width="300"></col><col width="200"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">f</span>(<span class="docEmphasis">t</span>,<span class="docEmphasis">B</span>,<span class="docEmphasis">C</span>,<span class="docEmphasis">D</span>) = (<span class="docEmphasis">B</span> <img src="U2227.GIF" border="0" /> <span class="docEmphasis">C</span>) <img src="U2228.GIF" border="0" /> (~<span class="docEmphasis">B</span> <img src="U2227.GIF" border="0" /> <span class="docEmphasis">D</span>)</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">(0 &lt;= <span class="docEmphasis">t</span> &lt;= 19)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">f</span> (<span class="docEmphasis">t</span>,<span class="docEmphasis">B</span>,<span class="docEmphasis">C</span>,<span class="docEmphasis">D</span>) = <span class="docEmphasis">B</span> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">C</span> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">D</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">(20 &lt;= <span class="docEmphasis">t</span> &lt;= 39)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">f</span>(<span class="docEmphasis">t</span>,<span class="docEmphasis">B</span>,<span class="docEmphasis">C</span>,<span class="docEmphasis">D</span>) = (<span class="docEmphasis">B</span> <img src="U2227.GIF" border="0" /> <span class="docEmphasis">C</span>) <img src="U2228.GIF" border="0" /> (<span class="docEmphasis">B</span> <img src="U2227.GIF" border="0" /> <span class="docEmphasis">D</span>) <img src="U2228.GIF" border="0" /> (<span class="docEmphasis">C</span> <img src="U2227.GIF" border="0" /> <span class="docEmphasis">D</span>)</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">(40 &lt;= <span class="docEmphasis">t</span> &lt;= 59)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">f</span> (<span class="docEmphasis">t</span>,<span class="docEmphasis">B</span>,<span class="docEmphasis">C</span>,<span class="docEmphasis">D</span>) = <span class="docEmphasis">B</span> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">C</span> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">D</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">(60 &lt;= <span class="docEmphasis">t</span> &lt;= 79)</p></td></tr></table></p><br />
<a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05lev1sec5.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec7.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>