<html><head><title>9.1. Password-Based Authentication</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch09.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch09lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch09lev1sec1"></a>
<h3 id="title-IDAROCHG" class="docSection1Title">9.1. Password-Based Authentication</h3>
<blockquote>
<p class="docText"><span class="docEmphasis">It's not who you know. It's what you know.</span></p>
</blockquote>
<p class="docText">Everyone knows what a password is, right? We thought so, too, until we tried to define it. When we use the phrase <span class="docEmphStrong">password-based authentication</span> we are referring to a secret quantity (the <b><a class="docLink" href="app02.html#gloss01_158">password</a></b>) that you state to prove you know it. The big problem with password-based authentication is eavesdropping.</p>
<a name="f216fig01"></a>
<p class="docText">
<img border="0" alt="" width="400" height="70" src="216fig01.jpg" /></p>
<p class="docText"><a name="iddle1154"></a>There are certain types of systems that might be thought of as password-based that we are excluding from our definition. For instance, in some systems a user has a secret word or phrase that the user thinks of as a password, but the string known by the user is converted into a cryptographic key. We consider such a system a cryptographic rather than a password-based authentication system.</p>
<p class="docText">Why does anyone use password-based authentication when cryptographic authentication is more secure? When dealing with people unaided by a workstation (e.g. the declining fraction of people at &quot;dumb terminals&quot;), it's difficult to avoid basing protocols on passwords, though as we will see (&sect;<a class="docLink" href="ch10lev1sec8.html#ch10lev1sec8">10.8</a> <span class="docEmphasis">Authentication Tokens</span>), there are some clever devices being manufactured today that make cryptographic solutions compatible with human beings.</p>
<p class="docText">Unfortunately, even computer-computer authentication is often based on passwords. Sometimes cryptography is not used because the protocol started out as a human-computer protocol and was not redesigned when its use got expanded to computer-computer communication. Sometimes it isn't used because the protocol designers assumed (perhaps correctly) that cryptography would be overly expensive in implementation time or processing resources. And sometimes cryptography is avoided because of legal issues.</p>
<p class="docText">There are some cases in which it is really annoying that the designers opted for a simple password-based scheme. For instance, some older cellular phones transmit the telephone number of the phone and a password when making a call, and if the password corresponds to the telephone number, the phone company lets the call go through and bills that telephone number. The problem is, anyone can eavesdrop on cellular phone transmissions and <span class="docEmphStrong">clone</span> such a phone, meaning they can make a phone that uses the overheard &lt;telephone number, password&gt; pair. Indeed, this <span class="docEmphasis">is</span> a problemÂcriminals do clone phones for stealing phone service and/or making untraceable calls. It would have been technologically easy to implement a simple cryptographic challenge-response protocol in the phone, and indeed the newer cell phones do this.</p>
<p class="docText">There are other issues involved in using passwords. If you are using a workstation, accessing lots of resources across the network, it would be inconvenient for you to have to do a remote login, typing a name and password, every time you accessed a resource such as a file server. For a distributed system to be as convenient to use as a centralized one, you should only need a single password and should only need to enter it once per session. Your workstation could remember your name and password and transmit them on your behalf every time you accessed a remote resource, but this assumes you have the same password on every remote system. How could it be possible to have the same password on many systems? You could individually set your password to the same value on all the systems, but how would you manage to change your password and have the stored password information change simultaneously on all the systems?</p>
<a name="ch09lev2sec1"></a>
<h4 id="title-IDAKRCHG" class="docSection2Title">9.1.1. Off- vs. On-Line Password Guessing</h4>
<p class="docText"><a name="iddle1048"></a><a name="iddle1058"></a><a name="iddle1063"></a><a name="iddle1099"></a><a name="iddle1103"></a><a name="iddle1265"></a><a name="iddle1725"></a><a name="iddle1744"></a><a name="iddle1772"></a><a name="iddle1778"></a>One way of guessing passwords is simply to type passwords at the system that is going to verify the password. To thwart such an <span class="docEmphStrong">on-line attack</span>, the system can make it impossible to guess too many passwords in this manner. For instance, <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_011">ATM</a></span> machines eat your card if you type three incorrect passwords. Alternatively, the system can be designed to be slow, so as not to allow very many guesses per unit time. Also, with an on-line attack, the system can become suspicious that someone might be attempting to break in, based on noticing an unusually large number of incorrect passwords. The system might then dispatch a human to investigate.</p>
<p class="docText">In contrast, in an <span class="docEmphStrong">off-line attack</span>, an intruder can capture a quantity <span class="docEmphasis">X</span> that is derived from a password in a known way. Then the intruder can, in complete privacy, use an arbitrary amount of compute power to guess passwords, convert them in the known way, and see if <span class="docEmphasis">X</span> is produced. Because a source of good password guesses is a dictionary, an off-line password guessing attack is sometimes referred to as a <span class="docEmphStrong">dictionary attack</span>.</p>
<p class="docText">If it is possible for an intruder to do off-line guessing, the secret must be chosen from a much larger space (see &sect;<a class="docLink" href="ch10lev1sec3.html#ch10lev1sec3">10.3</a> <span class="docEmphasis">Off-Line Password Guessing</span>).</p>
<a name="ch09lev2sec2"></a>
<h4 id="title-IDAGVCHG" class="docSection2Title">9.1.2. Storing User Passwords</h4>
<p class="docText">How does a server know Alice's password? There are several possibilities.</p>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Alice's authentication information is individually configured into every server Alice will use.</p></div></li><li><div style="font-weight:normal"><p class="docList">One location, which we'll call an <span class="docEmphStrong">authentication storage node</span>, stores Alice's information, and servers retrieve that information when they want to authenticate Alice.</p></div></li><li><div style="font-weight:normal"><p class="docList">One location, which we'll call an <span class="docEmphStrong">authentication facilitator node</span>, stores Alice's information, and a server that wants to authenticate Alice sends the information received from Alice to the authentication facilitator node, which does the authentication and tells the server <span class="docEmphRomanAlt">yes</span> or <span class="docEmphRomanAlt">no</span>.</p></div></li></ol></div>
<p class="docText">In cases 2 and 3, it's important for the server to authenticate the authentication storage or facilitator node, since if the server were fooled into thinking a bad guy's node was the authentication storage or facilitator node, the server could be tricked into believing the wrong authentication information, and therefore let bad guys impersonate valid users.</p>
<p class="docText">Regardless of where authentication information is stored, it is undesirable to have the database consist of unencrypted passwords because anyone who captured the database could impersonate all the users. Someone could capture the database by breaking into the node with the database, or by stealing a backup tape. In the first case above (authentication information individually configured into every server), capturing a server's database (of unencrypted passwords) would enable <a name="iddle1696"></a><a name="iddle1773"></a><a name="iddle2141"></a>someone to impersonate all the users of that server. Also, if a user had the same password on multiple servers, that user could then be impersonated at the other servers as well. In the second and third cases, many servers would use the one location, and capturing its database would enable someone to impersonate the users of all those servers. There's a trade-off, though. It might be difficult to physically protect every server, whereas if all the security information is in one location, it is only necessary to protect that one location.</p>
<blockquote>
<p class="docText"><span class="docEmphasis">Put all your eggs in one basket, and then watch that basket very carefully.</span></p>
<p class="docText">ÂAnonymous</p></blockquote>
<p class="docText">An alternative to storing unencrypted passwords is to store hashes of passwords, as is done in UNIX and <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_241">VMS</a></span> (see &sect;<a class="docLink" href="ch10lev1sec3.html#ch10lev1sec3">10.3</a> <span class="docEmphasis">Off-Line Password Guessing</span>). Then if anyone were to read the password database they could do off-line password-guessing attacks, but would not be able to obtain passwords of users who chose passwords carefully.</p>
<p class="docText">Alternatively, we could have the node that stores the password information encrypt the stored passwords (so that the server could decrypt a given password when needed). With hashed passwords an intruder who can read the hashed password database can do a password-guessing attack because the intruder will likely know the hash function (the function itself would not be secret). But with encrypted passwords the intruder can't get the passwords without knowledge of the node's key. Since the node would be a computer, the node's key would be a high-quality key, not derived from a password a human might be able to remember, and therefore invulnerable to guessing. Seemingly, then, encrypting (rather than hashing) the password database would be more secure, since an intruder would not only have to be able to read the node's database of encrypted passwords, but also acquire the node's key.</p>
<p class="docText">Encryption of the password database is indeed fairly secure for storage of the database on backup media, but it really isn't much protection against an intruder compromising the node itself, since the node's key is probably easily obtainable once inside the system. Most likely the node's key would be stored in some easily accessible place, readable by anyone with privileges (intruders always seem to obtain privileges). Worse yet, if the key isn't stored in nonvolatile memory somewhere, it likely would have to be typed in by the system manager every time the node was rebooted, in which case the key would most likely be handwritten and pasted to the keyboard.</p>
<p class="docText">It is possible to combine both techniques by encrypting the database of hashed passwords. Then you get the security benefits of both.</p>
<p class="docText">Sun Microsystems' <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_136">NIS</a></span> (Network Information Service), formerly known as <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_249">YP</a></span> (Yellow Pages), uses the directory service as an authentication storage node and stores the user's hashed password there. Like the original UNIX password file, the directory service information is world-readable, which means that anything can claim to be a server needing to see some user's authentication information. As generally deployed, the NIS directory service does not prove its identity to the server requesting the user's authentication information, so impersonation of the <a name="iddle1079"></a><a name="iddle1348"></a><a name="iddle1864"></a><a name="iddle1939"></a>directory service is somewhat of a security hole. NIS does make authentication across a network more convenient, but we suspect its availability will not convince NSA that it is safe to hook all its computers to the Internet.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch09.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch09lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>