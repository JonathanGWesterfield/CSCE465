<html><head><title>6.2. Modular Arithmetic</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch06lev1sec1.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch06lev1sec3.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch06lev1sec2"></a>
<h3 id="title-IDAHRW5M" class="docSection1Title">6.2. Modular Arithmetic</h3>
<blockquote>
<p class="docText"><a name="iddle1013"></a><a name="iddle1471"></a><a name="iddle1661"></a><span class="docEmphasis">There was a young fellow named Ben</span></p>
<p class="docText"><span class="docEmphasis">Who could only count modulo ten.</span></p>
<p class="docText"><span class="docEmphasis">He said, &quot;When I go</span></p>
<p class="docText"><span class="docEmphasis">Past my last little toe</span></p>
<p class="docText"><span class="docEmphasis">I shall have to start over again.&quot;</span></p>
<p class="docText">ÂAnonymous</p></blockquote>
<p class="docText">Most of the public key algorithms are based on modular arithmetic. Modular arithmetic uses the non-negative integers less than some positive integer <span class="docEmphasis">n</span>, performs ordinary arithmetic operations such as addition and multiplication, and then replaces the result with its remainder when divided by <span class="docEmphasis">n</span>. The result is said to be <span class="docEmphStrong">modulo</span> <span class="docEmphasis">n</span> or <span class="docEmphStrong">mod</span> <span class="docEmphasis">n</span>. When we write &quot;<span class="docEmphasis">x</span> mod <span class="docEmphasis">n</span>&quot;, we mean the remainder of <span class="docEmphasis">x</span> when divided by <span class="docEmphasis">n</span>. Sometimes we'll leave out &quot;mod <span class="docEmphasis">n</span>&quot; when it's clear from context.</p>
<a name="ch06lev2sec1"></a>
<h4 id="title-IDAEUW5M" class="docSection2Title">6.2.1. Modular Addition</h4>
<p class="docText">Let's look at mod 10 addition. 3 + 5 = 8, just like in regular arithmetic. The answer is already between 0 and 9. 7 + 6 = 13 in regular arithmetic, but the mod 10 answer is 3. Basically, one can perform mod 10 arithmetic by using the last digit of the answer. For example,</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="1"><col width="500"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText">5 + 5 = 0</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">3 + 9 = 2</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">2 + 2 = 4</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">9 + 9 = 8</p></td></tr></table></p><br />
<p class="docText">Let's look at the mod 10 addition table (<a class="docLink" href="#ch06fig01">Figure 6-1</a>). Addition of a constant mod 10 can be used as a scheme for encrypting digits, in that it maps each decimal digit to a different decimal digit in a way that is reversible; the constant is our secret key. It's not a <span class="docEmphasis">good</span> cipher, of course, but it is a cipher. (It's actually a Caesar cipher.) Decryption would be done by subtracting the secret key modulo 10, which is an easy operationÂjust do ordinary subtraction and if the result is less than 0, add 10.</p>
<a name="ch06fig01"></a><p><center>
<h5 class="docFigureTitle">Figure 6-1. Addition Modulo 10</h5>
</center></p><p class="docText">
<img border="0" alt="" width="350" height="207" src="06fig01.jpg" /></p>
<br />
<p class="docText">Just like in regular arithmetic, subtracting <span class="docEmphasis">x</span> can be done by adding -<span class="docEmphasis">x</span>, also known as <span class="docEmphasis">x</span>'s <span class="docEmphStrong">additive inverse</span>. An additive inverse of <span class="docEmphasis">x</span> is the number you'd have to add to <span class="docEmphasis">x</span> to get 0. For example, 4's inverse will be 6, because in mod 10 arithmetic 4 + 6 = 0. If the secret key were 4, then to encrypt we'd add 4 (mod 10), and to decrypt we'd add 6 (mod 10).</p>
<a name="ch06lev2sec2"></a>
<h4 id="title-IDAZXW5M" class="docSection2Title">6.2.2. Modular Multiplication</h4>
<p class="docText">Now let's look at the mod 10 multiplication table (<a class="docLink" href="#ch06fig02">Figure 6-2</a>). Multiplication by 1, 3, 7, or 9 works as a cipher, because it performs a one-to-one substitution of the digits. But multiplication by any of the other numbers will not work as a cipher. For instance, if you tried to encrypt by multiplying by <a name="iddle1352"></a><a name="iddle1474"></a><a name="iddle1669"></a><a name="iddle1805"></a><a name="iddle1899"></a><a name="iddle2087"></a>5, half the numbers would encrypt to 0 and the other half would encrypt to 5. You've lost information. You can't decrypt the ciphertext 5, since the plaintext could be any of {1, 3, 5, 7, 9}. So multiplication mod 10 can be used for encryption, provided that you choose the multiplier wisely. But how do you decrypt? Well, just like with addition, where we undid the addition by adding the additive inverse, we'll undo the multiplication by multiplying by the multiplicative inverse. In ordinary arithmetic, <span class="docEmphasis">x</span>'s multiplicative inverse is 1/<span class="docEmphasis">x</span>. If <span class="docEmphasis">x</span> is an integer, then its multiplicative inverse is a fraction. In modular arithmetic though, the only numbers that exist are integers. The <span class="docEmphStrong">multiplicative inverse</span> of <span class="docEmphasis">x</span> (written <span class="docEmphasis">x</span><sup>-1</sup>) is the number by which you'd multiply <span class="docEmphasis">x</span> to get 1. Only the numbers {1, 3, 7, 9} have multiplicative inverses mod 10. For example, 7 is the multiplicative inverse of 3. So encryption could be performed by multiplying by 3, and decryption could be performed by multiplying by 7. 9 is its own inverse. And 1 is its own inverse. Multiplication mod <span class="docEmphasis">n</span> is not a secure cipher, but it works, in the sense that we can scramble the digits by multiplying by <span class="docEmphasis">x</span> and get back to the original digits by multiplying by <span class="docEmphasis">x</span><sup>-1</sup>.</p>
<a name="ch06fig02"></a><p><center>
<h5 class="docFigureTitle">Figure 6-2. Multiplication Modulo 10</h5>
</center></p><p class="docText">
<img border="0" alt="" width="350" height="208" src="06fig02.jpg" /></p>
<br />
<p class="docText">It is by no means obvious how you find a multiplicative inverse in mod <span class="docEmphasis">n</span> arithmetic, especially if <span class="docEmphasis">n</span> is very large. For instance if <span class="docEmphasis">n</span> was a 100-digit number, you would not be able to do a brute-force search for an inverse. But it turns out there is an algorithm that will efficiently find inverses mod <span class="docEmphasis">n</span>. It is known as Euclid's algorithm. &sect;<a class="docLink" href="ch07lev1sec4.html#ch07lev1sec4">7.4</a> <span class="docEmphasis">Euclid's Algorithm</span> gives the details of the algorithm. For here, all you need to know is what it does. Given <span class="docEmphasis">x</span> and <span class="docEmphasis">n</span>, it finds the number <span class="docEmphasis">y</span> such that <span class="docEmphasis">x</span>&#183;<span class="docEmphasis">y</span> mod <span class="docEmphasis">n</span> = 1 (if there is one).</p>
<p class="docText">What's special about the numbers {1, 3, 7, 9}? Why is it they're the only ones, mod 10, with multiplicative inverses? The answer is that those numbers are all relatively prime to 10. <span class="docEmphStrong">Relatively prime</span> means they do not share any common factors other than 1. For instance, the largest integer that divides both 9 and 10 is 1. The largest integer that divides both 7 and 10 is 1. In contrast, 6 is not one of {1, 3, 7, 9}, and it does not have a multiplicative inverse mod 10. It's also not relatively prime to 10 because 2 divides both 10 and 6. In general, when we're working mod <span class="docEmphasis">n</span>, all the numbers relatively prime to <span class="docEmphasis">n</span> will have multiplicative inverses, and none of the other numbers will. And mod <span class="docEmphasis">n</span> multiplication by any number <span class="docEmphasis">x</span> relatively prime to <span class="docEmphasis">n</span> will work as a cipher because we can multiply by <span class="docEmphasis">x</span> to encrypt, and then multiply by <span class="docEmphasis">x</span><sup>-1</sup> to decrypt. (Again let us hasten to reassure you that we're not claiming it's a <span class="docEmphasis">good</span> cipher, in the sense of being secure. What we mean by its being a cipher is that we can modify the information through one algorithm (multiplication by <span class="docEmphasis">x</span> mod <span class="docEmphasis">n</span>) and then reverse the process (by multiplying by <span class="docEmphasis">x</span><sup>-1</sup> mod <span class="docEmphasis">n</span>).</p>
<p class="docText">How many numbers less than <span class="docEmphasis">n</span> are relatively prime to <span class="docEmphasis">n</span>? Why would anyone care? Well, it turns out to be so useful that it's been given its own notationÂ&#966;(<span class="docEmphasis">n</span>). &#966; is called the <b><a class="docLink" href="app02.html#gloss01_226">totient function</a></b>, supposedly from <span class="docEmphasis">total</span> and <span class="docEmphasis">quotient</span>. How big is &#966;(<span class="docEmphasis">n</span>)? If <span class="docEmphasis">n</span> is prime, then all the integers {1, 2,...<span class="docEmphasis">n</span>-1} are relatively prime to <span class="docEmphasis">n</span>, so &#966;(<span class="docEmphasis">n</span>) = <span class="docEmphasis">n</span>-1. If <span class="docEmphasis">n</span> is a product of two distinct primes, say <span class="docEmphasis">p</span> and <span class="docEmphasis">q</span>, then there are (<span class="docEmphasis">p</span>-1)(<span class="docEmphasis">q</span>-1) numbers relatively prime to <span class="docEmphasis">n</span>, so &#966;(<span class="docEmphasis">n</span>) = (<span class="docEmphasis">p</span>-1)(<span class="docEmphasis">q</span>-1). Why is that? Well, there are <span class="docEmphasis">n</span> = <span class="docEmphasis">pq</span> total numbers in {0, 1, 2,...<span class="docEmphasis">n</span>-1}, and we want to exclude those numbers that aren't relatively prime to <span class="docEmphasis">n</span>. Those are the numbers that are either multiples of <span class="docEmphasis">p</span> or of <span class="docEmphasis">q</span>. There are <span class="docEmphasis">p</span> multiples of <span class="docEmphasis">q</span> less than <span class="docEmphasis">pq</span> and <span class="docEmphasis">q</span> multiples of <span class="docEmphasis">p</span> less than <span class="docEmphasis">pq</span>. So there are <span class="docEmphasis">p</span>+<span class="docEmphasis">q</span>-1 numbers less than <a name="iddle1355"></a><span class="docEmphasis">pq</span> that aren't relatively prime to <span class="docEmphasis">pq</span> (we can't count 0 twice!). Thus &#966;(<span class="docEmphasis">pq</span>) = <span class="docEmphasis">pq</span> - (<span class="docEmphasis">p</span>+<span class="docEmphasis">q</span>-1) = (<span class="docEmphasis">p</span>-1)(<span class="docEmphasis">q</span>-1).</p>
<a name="ch06lev2sec3"></a>
<h4 id="title-IDADBX5M" class="docSection2Title">6.2.3. Modular Exponentiation</h4>
<p class="docText">Modular exponentiation is again just like ordinary exponentiation. Once you get the answer, you divide by <span class="docEmphasis">n</span> and get the remainder. For instance, 4<sup>6</sup> <span class="docEmphStrong">=</span> 6 mod 10 because 4<sup>6</sup> = 4096 in ordinary arithmetic, and 4096 = 6 mod 10. Let's look at the exponentiation table mod 10. We are purposely putting in extra columns because in exponentiation, <span class="docEmphasis">x<sup>y</sup></span> mod <span class="docEmphasis">n</span> is not the same as <span class="docEmphasis">x</span><sup>y+<span class="docEmphasis">n</span></sup> mod <span class="docEmphasis">n</span>. For instance, 3<sup>1</sup> = 3 mod 10, but 3<sup>11</sup> = 7 mod 10 (it's 177147 in ordinary arithmetic).</p>
<p class="docText">Let's look at mod 10 exponentiation (<a class="docLink" href="#ch06fig03">Figure 6-3</a>). Note that exponentiation by 3 would act as an encryption of the digits, in that it rearranges all the digits. Exponentiation by 2 would not, because both 2<sup>2</sup> and 8<sup>2</sup> are 4 mod 10. How would you decrypt? Is there an exponentiative inverse like there is a multiplicative inverse? Just like with multiplication, the answer is <span class="docEmphasis">sometimes</span>. (I bet people are going to hate our inventing the word <span class="docEmphasis">exponentiative</span>, but it's a useful word.)</p>
<a name="ch06fig03"></a><p><center>
<h5 class="docFigureTitle">Figure 6-3. Exponentiation Modulo 10</h5>
</center></p><p class="docText">
<img border="0" alt="" width="400" height="222" src="06fig03.jpg" /></p>
<br />
<p class="docText">Now we'll throw in an amazing fact about &#966;(<span class="docEmphasis">n</span>). Looking at the exponentiation table, we notice that columns 1 and 5 are the same, and 2 and 6 are the same, and 3 and 7 are the same. It turns out that <span class="docEmphasis">x<sup>y</sup></span> mod <span class="docEmphasis">n</span> is the same as <span class="docEmphasis">x</span><sup>(<span class="docEmphasis">y</span> mod &#966;(<span class="docEmphasis">n</span>))</sup> mod <span class="docEmphasis">n</span>. In the case of 10, the numbers relatively prime to 10 are {1, 3, 7, 9}, so &#966;(<span class="docEmphasis">n</span>) = 4. So that's why the <span class="docEmphasis">i</span><sup>th</sup> column is the same as the <span class="docEmphasis">i</span>+4<sup>th</sup> column. (Note for picky mathematiciansÂthis fact isn't true for all <span class="docEmphasis">n</span>, but it's true for all <span class="docEmphasis">n</span> we care <a name="iddle1936"></a><a name="iddle2028"></a>about. It's true for primes and it's true for any product of distinct primes, i.e. it's true for any <span class="docEmphasis">n</span> that doesn't have <span class="docEmphasis">p</span><sup>2</sup> as a factor for any prime <span class="docEmphasis">p</span>Âsuch an <span class="docEmphasis">n</span> is known as <span class="docEmphStrong">square free</span>.)</p>
<p class="docText">What we'll find important is the special case of this where <span class="docEmphasis">y</span> = 1 mod &#966;(<span class="docEmphasis">n</span>), i.e. if <span class="docEmphasis">y</span> = 1 mod &#966;(<span class="docEmphasis">n</span>), then for any number <span class="docEmphasis">x</span>, <span class="docEmphasis">x <sup>y</sup></span> = <span class="docEmphasis">x</span> mod <span class="docEmphasis">n</span>. Armed with this knowledge, let's look at RSA.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch06lev1sec1.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch06lev1sec3.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>