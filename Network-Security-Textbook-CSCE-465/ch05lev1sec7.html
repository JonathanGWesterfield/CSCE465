<html><head><title>5.7. HMAC</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05lev1sec6.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec8.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch05lev1sec7"></a>
<h3 id="title-IDAIHDRG" class="docSection1Title">5.7. HMAC</h3>
<p class="docText">The idea of using a message digest algorithm in the construction of a MAC algorithm was described in section &sect;<a class="docLink" href="ch05lev1sec2.html#ch05lev2sec2">5.2.2</a> <span class="docEmphasis">Computing a MAC with a Hash</span>. Given that one intuitively reasonable approachÂcomputing the digest of the concatenation of a shared secret with the messageÂhas flaws, cryptographers set out to find a construction that could be proven secure. Proving security of a cryptographic algorithm is difficult. First you have to start by defining &quot;secure&quot;. Then the best you can do is prove that one algorithm is at least as secure as another.</p>
<p class="docText">HMAC resulted from an effort to find a MAC algorithm that could be proven to be secure if the underlying message digest's compression function (see &sect;<a class="docLink" href="ch05lev1sec4.html#ch05lev2sec9">5.4.2</a> <span class="docEmphasis">Overview of MD4 Message Digest Computation</span>) was secure. They defined secure as having two properties:</p>
<ul><li><p class="docList">collision resistance (infeasible to find two inputs that yield the same output)</p></li><li><p class="docList">an attacker that doesn't know the key <span class="docEmphasis">K</span> cannot compute the proper digest(<span class="docEmphasis">K</span>,<span class="docEmphasis">x</span>) for data <span class="docEmphasis">x</span>, even if the attacker can see the value of digest(<span class="docEmphasis">K</span>,<span class="docEmphasis">y</span>), for arbitrary numbers of inputs <span class="docEmphasis">y</span>, with <span class="docEmphasis">y</span> not equal to <span class="docEmphasis">x</span>.</p></li></ul>
<p class="docText">So in the case of HMAC, they proved that HMAC was secure (had those 2 properties) provided that the underlying compression function was secure (had those 2 properties). Although there are likely other alternatives that are more efficient and just as secure, nobody has offered the same sort of proof of those alternatives. So HMAC seems likely to become the <span class="docEmphasis">de facto</span> standard.</p>
<p class="docText">In essence, HMAC prepends the key to the data, digests it, and then prepends the key to the result and digests that. This nested digest with secret inputs to both iterations prevents the extension attacks that would be possible if you simply digested the key and message once. In detail, HMAC function takes a variable-length key and a variable-sized message and produces a fixed-size output that is the same size as the output of the underlying digest. It first pads the key with <span class="docEmphRomanAlt">0</span> bits to 512 bits. If the key is larger than 512 bits, then HMAC first digests the key, resulting in 128 bits or 160 bits (depending on the size of output of the digest function) and pads the result out to 512 bits. It then <img src="U2295.GIF" border="0" />s the padded key with a constant string of octets of value 36<sub>16</sub>, concatenates it with the message to be protected and computes a message digest. It <img src="U2295.GIF" border="0" />s the padded key with a different constant string of octets of value 5c<sub>16</sub>, concatenates that with the result of the first digest, and computes a second digest on the result.</p>
<a name="ch05fig10"></a><p><center>
<h5 class="docFigureTitle">Figure 5-10. HMAC</h5>
</center></p><p class="docText">
<img border="0" alt="" width="300" height="325" src="05fig10.jpg" /></p>
<br />
<a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05lev1sec6.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec8.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>