<html><head><title>24.6. DCE Security</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch24lev1sec5.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch24lev1sec7.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch24lev1sec6"></a>
<h3 id="title-IDARCO1H" class="docSection1Title">24.6. DCE Security</h3>
<blockquote>
<p class="docText"><span class="docEmphasis">I declare this thing openÂwhatever it is.</span></p>
<p class="docText">ÂPrince Philip</p></blockquote>
<p class="docText">DCE stands for <span class="docEmphasis">Distributed Computing Environment</span>. It is an <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_151">OSF (Open Software Foundation)</a></span> product. OSF is a multivendor consortium. DCE security has been incorporated into a number of products from a variety of vendors. DCE security is conceptually similar to Kerberos, and indeed uses Kerberos V5 as one of its components. DCE has a modular design. Kerberos V5 is used for authentication although alternative mechanisms can in principle be substituted. Authentication, authorization, and encryption mechanisms are architecturally separate.</p>
<p class="docText">Recall that Kerberos uses KDCs and Ticket Granting Servers, and in the Kerberos chapters we called both things the KDC, since they have to share the same database and same keys and therefore really are the same thing. DCE adds <b><a class="docLink" href="app02.html#gloss01_173">Privilege Servers</a></b> and <span class="docEmphStrong">Registration Servers</span>. In practice a Privilege Server and a Registration Server come packaged with a KDC. Privilege Servers and Registration Servers are on-line trusted entities, like KDCs. The purpose of a Privilege Server is to get the principal's UUID (universal unique ID), and the groups (see &sect;<a class="docLink" href="ch15lev1sec8.html#ch15lev2sec23">15.8.3</a> <span class="docEmphasis">Groups</span>) to which that principal belongs, to be included in a Kerberos ticket in a secure way. The purpose of a Registration Server is to provide a combined database for a KDC and corresponding Privilege Server. <a name="iddle1009"></a>The KDC uses a master key for each principal, along with other stuff that's less interesting. The Privilege Server uses, for each principal, a UUID and the set of groups to which that principal belongs.</p>
<p class="docText">ACLs (access control lists) exist outside the context of DCE and in many of the operating systems that support DCE. ACLs could list principals by name, but names are long and subject to change. So in most implementations, ACLs list UIDs (user IDs) and GIDs (group IDs) instead. In Kerberos the principal's name is in a ticket, and Kerberos gives no help in translating from name to UID or in looking up the set of GIDs associated with a principal. Furthermore, Kerberos does not standardize UIDs and GIDs. Different platforms have different forms of UID and GID. For example, most UNIX systems have 32-bit UIDs and GIDs. Some really old UNIX systems have 16-bit UIDs and GIDs. Kerberos assumes systems will translate names to UIDs in some platform-specific way.</p>
<p class="docText">DCE standardizes group and user UUIDs at 128 bits long and standardizes DCE ACLs containing those UUIDs. Additionally, DCE does the translation from name to UUID, which is convenient for the applications but makes it difficult for them to use the native ACL format with DCE. The DCE designers, knowing that a UID field of 32 bits was really insufficient, hoped that they'd inspire the operating systems to migrate to their standard of 128 bits. In the meantime most DCE implementations use 32-bit UIDs and GIDs padded out with a constant to look like 128-bit UUIDs.</p>
<p class="docText">A UUID in an ACL can belong to either a principal or a group. A user Alice will in general not need to know her own UUID, but usually is capable of remembering her own name, so the login exchange is based on her name.</p>
<p class="docText">A user should be authorized to access something if the user's UUID is in the ACL or if a group to which the user belongs is listed in the ACL. DCE wanted an efficient method of knowing to which groups a user belongs, and this was done by including group information in the ticket.</p>
<p class="docText">It is interesting how the DCE designers managed to get this information to be included in Kerberos tickets without modifying Kerberos. It would have been a small change to Kerberos to have the KDC maintain UUID and group membership with each principal, and put that information into the ticket. But instead, they designed elaborate mechanisms so they could work with an architecturally pure Kerberos. They still can't use unmodified KDCs, however, because they access the KDC using DCE RPC instead of UDP datagrams, and because management depends on being able to modify data through the Registration Server.</p>
<p class="docText">Kerberos V5 has a field known as <span class="docEmphSmaller">AUTHORIZATION DATA</span>. Kerberos does not interpret the contents of this field. Rather it allows a user (say Alice), when requesting a TGT, to specify a value for that field. Kerberos just copies the requested value into the <span class="docEmphSmaller">AUTHORIZATION DATA</span> field of the TGT, and then copies that field into the <span class="docEmphSmaller">AUTHORIZATION DATA</span> field of any tickets issued based on that TGT. Alice's workstation requests TGTs and tickets on Alice's behalf, but does not maintain the database of Alice's UUID or group memberships. Even if it has that information, it can't be trusted to supply it. So Alice's Privilege Server supplies that information. The Privilege Server reads the database of user name/UUID/group membership from the Registration Server.</p>
<p class="docText"><a name="iddle1858"></a><a name="iddle1870"></a>With DCE, Alice logs in just like in Kerberos (see <a class="docLink" href="#ch24fig05">Figure 24-6</a>). Alice's workstation gets an ordinary Kerberos TGT with Alice's name inside. The workstation then requests a ticket to the Privilege Server, which to the KDC is just another principal in the realm. The workstation then contacts the Privilege Server. The Privilege Server extracts Alice's name from the ticket, looks up Alice's UUID and group membership, and requests a TGT from the KDC with the Privilege Server's name in the <span class="docEmphSmaller">CLIENT NAME</span> field, and Alice's UUID and group membership in the <span class="docEmphSmaller">AUTHORIZATION DATA</span>. This TGT is referred to in DCE as a <span class="docEmphStrong">PTGT</span>, for <b><a class="docLink" href="app02.html#gloss01_222">Privilege Ticket Granting Ticket</a></b>. The Privilege Server then, in an encrypted message, gives Alice's workstation the PTGT and the corresponding session key (the one encrypted inside the PTGT). Alice's workstation uses the PTGT and corresponding key instead of the original TGT. Note that the above description is architecturalÂsince the Privilege Server and KDC are packaged together, the messages between them might not actually occur.</p>
<a name="ch24fig05"></a><p><center>
<h5 class="docFigureTitle">Figure 24-6. Obtaining a PTGT in DCE</h5>
</center></p><p class="docText"><div class="v1"><a target="_blank" href="24fig06_alt.jpg">[View full size image]</a></div><img border="0" alt="" width="500" height="300" src="24fig06.jpg" /></p>
<br />
<p class="docText">Now let's say that Alice asks to talk to server Bob. The workstation sends the PTGT to the KDC, along with the request for a ticket to Bob. The KDC will return to Alice a ticket to Bob with the <span class="docEmphSmaller">AUTHORIZATION DATA</span> field copied from the PTGT (so that it will contain Alice's UUID and group membership), and with the <span class="docEmphSmaller">CLIENT NAME</span> field equal to the Privilege Server's name. The ticket does not contain Alice's name, but it is not needed, since ACLs list Alice's UUID or use group UUIDs.</p>
<p class="docText">A DCE application, Bob, refuses to honor Kerberos tickets unless the Privilege Server's name is in the <span class="docEmphSmaller">CLIENT NAME</span> field. Once Bob checks to make sure the Privilege Server's name is in the ticket, Bob uses the <span class="docEmphSmaller">AUTHORIZATION DATA</span> field to discover Alice's UUID and group membership. Since the only way for Alice's workstation to obtain such a ticket (and corresponding session key) is through following the proper procedure, Bob can be assured that the UUID and group information in the ticket is correct. Bob checks this against the ACL of the resource Alice is asking to use.</p>
<p class="docText">Multirealm DCE is similar to multirealm Kerberos. Suppose Alice is in realm A and Bob (the resource Alice would like to access) is in realm B. Furthermore, assume B is not a principal in A, so that it is necessary to go through transit realm C. (See <a class="docLink" href="#ch24fig06">Figure 24-7</a>.)</p>
<a name="ch24fig06"></a><p><center>
<h5 class="docFigureTitle">Figure 24-7. Multirealm DCE</h5>
</center></p><p class="docText"><div class="v1"><a target="_blank" href="24fig07_alt.jpg">[View full size image]</a></div><img border="0" alt="" width="500" height="450" src="24fig07.jpg" /></p>
<br />
<p class="docText">Alice (her workstation) uses her PTGT to request from her KDC a ticket to Bob. Her KDC knows that Bob is not local, so instead gives her a ticket to the KDC in realm C. The <span class="docEmphSmaller">AUTHORIZATION DATA</span> and <span class="docEmphSmaller">CLIENT NAME</span> will get copied from the PTGT into the ticket to C, so the ticket to the KDC in realm C will still contain A's Privilege Server as <span class="docEmphSmaller">CLIENT NAME</span>, and Alice's UUID and groups in <span class="docEmphSmaller">AUTHORIZATION DATA</span>. Alice uses the ticket to the KDC in C to ask for a ticket to the Privilege Server in Bob's realm (B). C's KDC will return a ticket to the KDC in B. <span class="docEmphSmaller">CLIENT NAME</span> will still be A's Privilege Server. <span class="docEmphSmaller">AUTHORIZATION DATA</span> will still be Alice's UUID and groups. The <span class="docEmphSmaller">TRANSITED</span> field will contain C. Alice then uses the ticket to B's KDC to ask the KDC for a ticket to B's Privilege Server. The reason she needs to do this is to get a ticket with B's Privilege Server's name in the <span class="docEmphSmaller">CLIENT NAME</span> field, since Bob will not honor a ticket unless the <span class="docEmphSmaller">CLIENT NAME</span> is the name of the Privilege Server in Bob's realm. Alice then contacts B's Privilege Server.</p>
<p class="docText">B's Privilege Server checks the ticket for legality. Since the ticket is coming from outside the realm, B's Privilege Server will reject it if the <span class="docEmphSmaller">CLIENT NAME</span> is not the standard text string that denotes Privilege Server. B's Privilege Server also checks the <span class="docEmphSmaller">TRANSITED</span> field for acceptability. The recommended policy for an acceptable transit path is traversal of the tree implied by the hierarchical names, going up to the least common ancestor and then down, though with a single cross-link allowed on the path. With DCE security it is only Privilege Servers that check the <span class="docEmphSmaller">TRANSITED</span> field. In fact, once a Privilege Server returns a PTGT, the transit information is gone. DCE made the decision that it was more practical for the Privilege Server to check the transit information. Kerberos, remember, leaves it up to each application.</p>
<p class="docText">Assuming B's Privilege Server accepts the transit information, it requests a ticket from B's KDC that contains <span class="docEmphRomanAlt">Privilege Server B</span> as <span class="docEmphSmaller">CLIENT NAME</span>, and Alice's UUID, group information, and realm UUID as <span class="docEmphSmaller">AUTHORIZATION DATA</span>. That's a PTGT just like the original PTGT, except now it has B's Privilege Server's name instead of A's. Alice uses that PTGT to request, from B's KDC, a ticket to Bob. Finally she gets a ticket to Bob, with <span class="docEmphSmaller">CLIENT NAME</span> <span class="docEmphRomanAlt">Privilege Server B</span> and <span class="docEmphSmaller">AUTHORIZATION DATA</span> equal to her UUID, group membership, and realm UUID.</p>
<p class="docText">Because of the way that DCE did groups, a user can only be in groups maintained by the Privilege Server of the user's realm. It is possible to put groups and individuals from other realms into a DCE ACL, since each ACL entry effectively consists of a pair of UUIDs: the UUID of either the individual or the group, and the UUID of the realm in which the group or individual resides.</p>
<p class="docText">Once Alice and Bob have mutually authenticated, DCE does not use the Kerberos integrity-protected or encrypted data exchanges. Instead, DCE has its own mechanisms for integrity protection, or integrity plus privacy protection within its RPC protocol, using the session key Kerberos does provide. As with Kerberos, the protocols are designed to allow multiple different cryptographic algorithms, but today DCE uses MD5 and DES.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch24lev1sec5.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch24lev1sec7.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>