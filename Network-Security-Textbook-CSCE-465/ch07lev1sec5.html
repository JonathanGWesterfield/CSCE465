<html><head><title>7.5. Chinese Remainder Theorem</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch07lev1sec4.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch07lev1sec6.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch07lev1sec5"></a>
<h3 id="title-IDA3VPWJ" class="docSection1Title">7.5. Chinese Remainder Theorem</h3>
<p class="docText">The Chinese Remainder Theorem states that if <span class="docEmphasis">z</span><sub>1</sub>, <span class="docEmphasis">z</span><sub>2</sub>, <span class="docEmphasis">z</span><sub>3</sub>,..., <span class="docEmphasis">z<sub>k</sub></span> are relatively prime, and you know that some number is <span class="docEmphasis">x</span><sub>1</sub> mod <span class="docEmphasis">z</span><sub>1</sub>, and is <span class="docEmphasis">x</span><sub>2</sub> mod <span class="docEmphasis">z</span><sub>2</sub>, and in general is <span class="docEmphasis">x<sub>k</sub></span> mod <span class="docEmphasis">z<sub>k</sub></span>, then you can calculate what the number is mod <span class="docEmphasis">z</span><sub>1</sub><span class="docEmphasis">z</span><sub>2</sub> <span class="docEmphasis">z</span><sub>3</sub>...<span class="docEmphasis">z<sub>k</sub></span>. Likewise, if something equals <span class="docEmphasis">x</span> mod <span class="docEmphasis">z</span><sub>1</sub><span class="docEmphasis">z</span><sub>2</sub><span class="docEmphasis">z</span><sub>3</sub>...<span class="docEmphasis">z<sub>k</sub></span>, then you can calculate what the number is mod <span class="docEmphasis">z</span><sub>1</sub>, mod <span class="docEmphasis">z</span><sub>2</sub>,.... In other words, there are two representations of a number. These representations are equivalent in the sense that they define the same number, and it is easy to convert from one representation to the other.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="2"><col width="280"></col><col width="270"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><blockquote><p></p><p class="docList"><span class="docEmphStrong">Standard Representation</span>:</p></blockquote></td></tr></table></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">x</span> mod <span class="docEmphasis">z</span><sub>1</sub><span class="docEmphasis">z</span><sub>2</sub><span class="docEmphasis">z</span><sub>3</sub>...<span class="docEmphasis">z<sub>k</sub></span> (all the <span class="docEmphasis">z</span>s relatively prime)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><blockquote><p></p><p class="docList"><span class="docEmphStrong">Decomposed Representation</span>:</p></blockquote></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">x</span><sub>1</sub> mod <span class="docEmphasis">z</span><sub>1</sub>, <span class="docEmphasis">x</span><sub>2</sub> mod <span class="docEmphasis">z</span><sub>2</sub>,..., <span class="docEmphasis">x<sub>k</sub></span> mod <span class="docEmphasis">z<sub>k</sub></span>&gt;</p></td></tr></table><br />
<p class="docText">Why is it true? Well, it's pretty easy to see that if you have a number <span class="docEmphasis">x</span>, you can calculate what it is mod <span class="docEmphasis">z<sub>i</sub></span> simply by dividing by <span class="docEmphasis">z<sub>i</sub></span> and taking the remainder. Therefore going from the standard representation to the decomposed representation is very easy.</p>
<p class="docText"></p><a name="ch07sb01"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">Euclidean Algorhyme</h2>
<blockquote>
<blockquote>
<span class="docEmphasis">You're given two numbers, and now you desire</span><br />
<span class="docEmphasis">a method for finding their common divisor.</span><br />
<span class="docEmphasis">(The greatest, of course, is the one you must name.)</span><br />
<span class="docEmphasis">To do it, you'll keep shared divisors the same</span><br />
<span class="docEmphasis">while repeatedly shrinking each number in turn</span><br />
<span class="docEmphasis">'til one of them's zero, and then you discern</span><br />
<span class="docEmphasis">that the other's the greatest divisor they share.</span><br />
<span class="docEmphasis">So how do you manage to lessen the pair?</span><br />
<span class="docEmphasis">You divide large by small, then large is ejected,</span><br />
<span class="docEmphasis">small becomes large, as remainder's injected.</span><br />
</blockquote>
</blockquote>
<p class="docText"><a name="iddle1023"></a><span class="docEmphStrong">Multiplicative inVerse</span></p>
<blockquote>
<blockquote>
<span class="docEmphasis">Now if clever you are you can take this lots farther,</span><br />
<span class="docEmphasis">by some bookkeeping work which is not much a bother.</span><br />
<span class="docEmphasis">Each number you deal with, depict as a duple</span><br />
<span class="docEmphasis">to dot-product with the original couple.</span><br />
<span class="docEmphasis">You start with one-zero, and then zero-one,</span><br />
<span class="docEmphasis">then each new remainder's the combination</span><br />
<span class="docEmphasis">of the smaller one's duple times minus the quotient</span><br />
<span class="docEmphasis">plus one times the larger one's duple. The notion?</span><br />
<span class="docEmphasis">If the numbers you're given are relative primes,</span><br />
<span class="docEmphasis">then gcd's duple holds inverses (times).</span><br />
<p class="docText">ÂMike Speciner</p>
</blockquote>
</blockquote>
</td></tr></table></p><br />
<p class="docText">To go from the decomposed representation to the standard representation is not as obvious, but it is still fairly easy. We'll do the special case where <span class="docEmphasis">k</span> = 2. You can do the general case (<a class="docLink" href="ch07lev1sec9.html#ch07lev1sec9">Homework Problem 5</a>).</p>
<p class="docText">We know that the number is <span class="docEmphasis">x</span><sub>1</sub> mod <span class="docEmphasis">z</span><sub>1</sub> and <span class="docEmphasis">x</span><sub>2</sub> mod <span class="docEmphasis">z</span><sub>2</sub>. We want to find out what it is mod <span class="docEmphasis">z</span><sub>1</sub><span class="docEmphasis">z</span><sub>2</sub>. We also know that <span class="docEmphasis">z</span><sub>1</sub> and <span class="docEmphasis">z</span><sub>2</sub> are relatively prime. And to get rid of subscripts, and to match the notation used for RSA, we'll call the two <span class="docEmphasis">z</span>s <span class="docEmphasis">p</span> and <span class="docEmphasis">q</span>. So we know that something equals <span class="docEmphasis">x</span><sub>1</sub> mod <span class="docEmphasis">p</span> and <span class="docEmphasis">x</span><sub>2</sub> mod <span class="docEmphasis">q</span>, and we want to know what it equals mod <span class="docEmphasis">pq</span>. Call this mod <span class="docEmphasis">pq</span> value <span class="docEmphasis">x</span>.</p>
<p class="docText">Given that <span class="docEmphasis">p</span> and <span class="docEmphasis">q</span> are relatively prime, we can use Euclid's algorithm to find <span class="docEmphasis">a</span> and <span class="docEmphasis">b</span> such that <span class="docEmphasis">ap</span> + <span class="docEmphasis">bq</span> = 1. (Note that <span class="docEmphasis">a</span> = <span class="docEmphasis">p</span><sup>-1</sup> mod <span class="docEmphasis">q</span> and <span class="docEmphasis">b</span> = <span class="docEmphasis">q</span><sup>-1</sup> mod <span class="docEmphasis">p</span>.) If we multiply this equation by <span class="docEmphasis">x</span>, we get <span class="docEmphasis">x</span> = <span class="docEmphasis">xap</span> + <span class="docEmphasis">xbq</span>. Since <span class="docEmphasis">x</span> differs from <span class="docEmphasis">x</span><sub>1</sub> by a multiple of <span class="docEmphasis">p</span> and <span class="docEmphasis">x</span> differs from <span class="docEmphasis">x</span><sub>2</sub> by a multiple of <span class="docEmphasis">q</span>, taking both sides mod <span class="docEmphasis">pq</span> gives <span class="docEmphasis">x</span> = <span class="docEmphasis">x</span><sub>2</sub><span class="docEmphasis">ap</span> + <span class="docEmphasis">x</span><sub>1</sub><span class="docEmphasis">bq</span> mod <span class="docEmphasis">pq</span>.</p>
<p class="docText">The Chinese Remainder Theorem will help us compute Euler's totient function and generalize Euler's Theorem. It also gives us some other interesting results that we used in <a class="docLink" href="ch06.html#ch06">Chapter 6</a> <span class="docEmphasis">Public Key Algorithms</span>:</p>
<ul><li><p class="docList"><a name="iddle2146"></a>an explanation of why 1 has more than two square roots mod <span class="docEmphasis">n</span> if <span class="docEmphasis">n</span> has two relatively prime factors &gt; 2</p></li><li><p class="docList">a way to speed up RSA exponentiations in generating signatures and decrypting (the operations using the private key)</p></li><li><p class="docList">an amusing reason not to use 3 as the public exponent, since seeing a message <span class="docEmphasis">m</span> encrypted according to three different public keys will enable you to figure out what <span class="docEmphasis">m</span> is</p></li></ul>
<p class="docText">Why does 1 have more than two square roots mod <span class="docEmphasis">n</span> if <span class="docEmphasis">n</span> has two relatively prime factors &gt; 2? Suppose <span class="docEmphasis">n</span> = <span class="docEmphasis">pq</span> where <span class="docEmphasis">p</span> and <span class="docEmphasis">q</span> are relatively prime and &gt; 2.</p>
<p class="docText">1 mod <span class="docEmphasis">n</span> will equal 1 mod <span class="docEmphasis">p</span> and 1 mod <span class="docEmphasis">q</span>. Also, -1 mod <span class="docEmphasis">n</span> will equal -1 mod <span class="docEmphasis">p</span> and -1 mod <span class="docEmphasis">q</span>. Both -1 and 1 are square roots of <span class="docEmphasis">n</span>.</p>
<p class="docText">However, look at the number <span class="docEmphasis">z</span> which is -1 mod <span class="docEmphasis">p</span> and 1 mod <span class="docEmphasis">q</span>. It won't be 1 or -1 mod <span class="docEmphasis">n</span> (since by the Chinese Remainder Theorem, there can't be two different values of the form &lt;<span class="docEmphasis">x</span><sub>1</sub> mod <span class="docEmphasis">p</span>, <span class="docEmphasis">x</span><sub>2</sub> mod <span class="docEmphasis">q</span>&gt; that equal the same value mod <span class="docEmphasis">pq</span>.) However, if you square <span class="docEmphasis">z</span> mod <span class="docEmphasis">p</span> you'll get 1 (since -1 &#183; -1 = 1 mod <span class="docEmphasis">p</span>). And if you square <span class="docEmphasis">z</span> mod <span class="docEmphasis">q</span> you'll also get 1. So <span class="docEmphasis">z</span><sup>2</sup> = 1 mod <span class="docEmphasis">n</span>, which means <span class="docEmphasis">z</span> is a square root of <span class="docEmphasis">n</span> different from 1 or -1. And the number &lt;1 mod <span class="docEmphasis">p</span>, -1 mod <span class="docEmphasis">q</span>&gt; also is a square root of 1. So 1 will have at least four square roots. If <span class="docEmphasis">n</span> has <span class="docEmphasis">k</span> relatively prime factors &gt; 2, 1 will have at least 2<span class="docEmphasis"><sup>k</sup></span> square roots! (every combination of 1's and -1's mod each of the factors).</p>
<p class="docText">In general, if <span class="docEmphasis">n</span> = 2<sup>&#945;<sub>0</sub></sup><span class="docEmphasis">p</span><sub>1</sub><sup>&#945;<sub>1</sub></sup><span class="docEmphasis">p</span><sub>2</sub><sup>&#945;<sub>2</sub></sup><span class="docEmphasis">p</span><sub>3</sub><sup>&#945;<sub>3</sub></sup>...<span class="docEmphasis">p<sub>k</sub></span><sup>&#945;<sub><span class="docEmphasis">k</span></sub></sup> where <span class="docEmphasis">p<sub>i</sub></span> are distinct odd primes and &#945;<span class="docEmphasis"><sub>i</sub></span> &gt; 0 for <span class="docEmphasis">i</span> &gt; 0, then, mod <span class="docEmphasis">n</span>, 1 will have 2<span class="docEmphasis"><sup>k</sup></span> square roots if &#945;<sub>0</sub> <img src="U2264.GIF" border="0" /> 1, 2<sup><span class="docEmphasis">k</span>+1</sup> square roots if &#945;<sub>0</sub> = 2, and 2<sup><span class="docEmphasis">k</span>+2</sup> square roots if &#945;<sub>0</sub> <img src="U2265.GIF" border="0" /> 3. The number of square roots of 1 mod <span class="docEmphasis">n</span> is important, as we saw in &sect;<a class="docLink" href="ch06lev1sec3.html#ch06lev4sec1">6.3.4.2.1</a> <span class="docEmphasis">Finding Big Primes p and q</span>, because of the Miller-Rabin primality test.</p>
<ul></ul></div></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch07lev1sec4.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch07lev1sec6.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table><!--IP User 2--></td></body></head></html>