<html><head><title>15.6. PKIX and X.509</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch15lev1sec5.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch15lev1sec7.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch15lev1sec6"></a>
<h3 id="title-IDAMDOUH" class="docSection1Title">15.6. PKIX and X.509</h3>
<p class="docText">PKIX is a profile of X.509, which means PKIX specifies which X.509 options should be supported. X.509 is a particularly awkward format for certificates, but it seems to be what the world is assuming PKIs will be based upon. Despite its awkwardness, it is not totally unusable. We<sub>1,2</sub> both manage to implement products with it, but we hope you'll forgive us poking a little fun at it in our description below.</p>
<a name="ch15lev2sec17"></a>
<h4 id="title-IDA0DOUH" class="docSection2Title">15.6.1. Names</h4>
<p class="docText">How easily and efficiently the PKI concepts can be implemented is influenced by the certificate formats. Somewhat astonishingly, the IETF chose to base the certificate formats on X.509. Given how simple the basic concept isÂsigning a name, issue date, expiration date, and public keyÂX.509 was a particularly inappropriate and unfortunate choice. The names were X.500 names. We are all familiar with Internet names (known as <i><a class="docLink" href="app02.html#gloss01_075">DNS</a></i> <span class="docEmphasis">names</span>). They look like <span class="docEmphRomanAlt">sun.com</span> or <span class="docEmphRomanAlt">mit.edu</span>. We are also familiar with Internet email names, such as <span class="docEmphRomanAlt">user@organization.com</span>.</p>
<p class="docText">X.500 names, on the other hand, look like <span class="docEmphRomanAlt">C=US, O=examplecompany name, OU=research, CN=Alice</span>, where <span class="docEmphRomanAlt">C</span> means <span class="docEmphasis">country</span>, <span class="docEmphRomanAlt">O</span> means <span class="docEmphasis">organization</span>, <span class="docEmphRomanAlt">OU</span> means <span class="docEmphasis">organizational unit</span>, and <span class="docEmphRomanAlt">CN</span> is <span class="docEmphasis">common name</span>. There are rules about what types of name components are allowed to be under what others. And the example name <span class="docEmphRomanAlt">C=US, O=examplecompany name, OU=research, CN=Alice</span> is supposed to be human-friendly. That's not how it's actually encoded. The actually encoding consists of OIDs (see section &sect;<a class="docLink" href="#ch15lev2sec18">15.6.2</a> <span class="docEmphasis">OIDs</span>) for each of the name component types (<span class="docEmphRomanAlt">C</span>, <span class="docEmphRomanAlt">OU</span>, etc.). Compared to OIDs, the <span class="docEmphRomanAlt">OU=</span> syntax <span class="docEmphasis">is</span> human-friendly. There is no standard for display of X.500 namesÂdifferent applications display them differently.</p>
<p class="docText">Few if any Internet applications use X.500 names. Choosing ASN.1 as the encoding dooms certificates to be inefficient in space and computationally expensive and memory intensive to parse.</p>
<p class="docText">What happens when you try to use a certificate format for binding names to public keys, but your applications use a different form of name than what appears in the certificate? You wind up either with security flaws or the invention of awkward work-arounds. For instance, an Internet email standard, S/MIME, uses X.509 certificates. How do you reconcile an email name such as <a name="iddle1440"></a><a name="iddle1722"></a><a name="iddle1730"></a><span class="docEmphRomanAlt">radia@alum.mit.edu</span> with an X.500 name? Older implementations mandated that the X.500 name contain a newly invented component <span class="docEmphRomanAlt">email=radia@alum.mit.edu</span> (displayed differently by different applications). All the X.500 name components other than <span class="docEmphRomanAlt">email</span> would be ignored, though they were available for the user to examine if she so chose. The standard later specified that you should put the email name into the <span class="docEmphSmaller">SUBJECT</span>A<span class="docEmphSmaller">LT</span>N<span class="docEmphSmaller">AME</span> field in the certificate.</p>
<p class="docText">SSL had the same problem since it uses X.509 certificates. URLs contain DNS names, not X.500 names. When someone visits the site <span class="docEmphRomanAlt">www.sun.com</span>, and the server presents a certificate that contains an X.500 name, how can this be at all useful to reassure the user Alice that the site she is talking to is really what she expects it to be? Some browser implementations ignored the name entirely, but still made sure the certificate was properly signed. So if Alice mistakenly contacted <span class="docEmphRomanAlt">snakeoil.com</span> instead of her broker, the site would present a certificate with an X.500 name, Alice's browser would happily do the math and decide it was properly signed, and reassure Alice that everything was secure! It certainly isn't difficult to get a certificate.</p>
<p class="docText">A more common (and secure) work-around is to demand that the <span class="docEmphRomanAlt">CN</span> portion of the X.500 name be the DNS name.</p>
<p class="docText">Eventually X.509 added the ability to have alternate names. PKIX allows end entities (nonCAs) not to have X.500 names, but CAs still must have X.500 names even if they also have a DNS name in the <span class="docEmphSmaller">SUBJECT</span>A<span class="docEmphSmaller">LT</span>N<span class="docEmphSmaller">AME</span> field in the certificate.</p>
<p class="docText">There is no widely deployed X.500 directory. There is a widely deployed directory for Internet namesÂDNS. DNS may be just a &quot;lookup service&quot; and not a &quot;true directory&quot; according to the X.500 proponents' definition. But frankly, when we want to be able to look up attributes of a name, such as its IP address, its certificate, cross-certificates it has signed, etc., the fancy X.500 system doesn't let us do that because there isn't a widely deployed set of X.500 directory servers with referrals for name resolution. To be fair, certificates are not posted in DNS today, either. Given that there is no way to look up certificates in directories today, strategies in deployed systems today include emailing certificates (as in S/MIME) or sending them as part of the exchange (as in SSL/TLS, and IPsec). One place where certificates are posted today is in LDAP directories serving closed user communities (e.g., within a company).</p>
<a name="ch15lev2sec18"></a>
<h4 id="title-IDAMJOUH" class="docSection2Title">15.6.2. OIDs</h4>
<p class="docText">An <b><a class="docLink" href="app02.html#gloss01_145">OID <span class="docEmphRoman">(</span><span class="docEmphStrong">object identifier</span><span class="docEmphRoman">)</span></a></b> is a hierarchically assigned value consisting of a sequence of numbers separated by periods, used in ASN.1. It is a way of obtaining unique numbers for things without having any central administration hand out values. In IETF, the <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_103">IANA</a></span> (Internet Assigned Numbers Authority) assigns numbers, and they used to periodically publish an RFC titled <span class="docEmphasis">Assigned Numbers</span> which listed all the numbers that were assigned for parameter values in various protocols. For instance, in the <span class="docEmphSmaller">PROTOCOL</span> field in IP, the value 6 means TCP, 50 means ESP, and 51 means AH. <a name="iddle1159"></a><a name="iddle2108"></a><a name="iddle2139"></a>The final such RFC was 1700. Now the IANA publishes the numbers on their web site as <a class="docLink" target="_blank" href="http://www.iana.org/numbers.html">http://www.iana.org/numbers.html</a>.</p>
<p class="docText">With ASN.1, instead of having to send a request in to IANA for a value, you can obtain your own number by going to anyone who already has an OID. For example, if someone already has the value <span class="docEmphRomanAlt">1.2.840.113549.1.1.2</span>, you can ask them to give you an OID, and they might give you <span class="docEmphRomanAlt">1.2.840.113549.1.1.2.79</span>. Then you can assign all the values you want provided they all have the prefix <span class="docEmphRomanAlt">1.2.840.113549.1.1.2.79</span>. As you see, OIDs can get quite large.</p>
<p class="docText">Furthermore, different organizations can give different OIDs to the same thing. In fact, even the same organization can give different OIDs to the same thing. For instance, in the PEM standard, there are two possible ways of specifying RSA. One uses the OID <span class="docEmphRomanAlt">2.5.8.1.1</span>, which is defined as RSA with one parameter specifying the number of bits in the RSA modulus. The other uses OID <span class="docEmphRomanAlt">1.2.840.113549.1.1.1</span> and takes one parameter, which is null.</p>
<a name="ch15lev2sec19"></a>
<h4 id="title-IDAMMOUH" class="docSection2Title">15.6.3. Specification of Time</h4>
<p class="docText">UNIX time, defined a decade before ASN.1 defined a format for time, was in units of seconds, took four octets to specify, and lasted until 2038. ASN.1, a decade later, came up with a format that was also in units of seconds, but took fifteen octets to specify! Furthermore, it only had a two-digit year! The PKIX people decided that the two digits could be used for specifying years between 1950 and 2049, so at least it expired in 2049 rather than 1999. There is another name form in ASN.1 called GeneralizedTime, which has a four-digit year and uses seventeen octets. PKIX mandates use of the two-digit-year format (called UTCTimeÂuniversal coordinated time) for specifying all dates through 2049, and use of GeneralizedTime for dates after 2049.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch15lev1sec5.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch15lev1sec7.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>