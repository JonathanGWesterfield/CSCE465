<html><head><title>21.13. Forwarding and Enclosures</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch21lev1sec12.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch21lev1sec14.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch21lev1sec13"></a>
<h3 id="title-IDAYV5YI" class="docSection1Title">21.13. Forwarding and Enclosures</h3>
<p class="docText"><a name="iddle1390"></a>Alice might want to forward to Bob a message she received from someone else, inside a message of her own:</p>
<p><table cellspacing="0" class="allBorders" border="1" rules="rows" cellpadding="4"><colgroup align="left" span="1"><col width="550"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphStrong"><tt>-----BEGIN PRIVACY-ENHANCED MESSAGE-----</tt></span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">header, saying</span> <span class="docEmphStrong"><tt>MIC-CLEAR</tt></span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">MIC (message digest signed with Bob's private key)</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><div class="docText"><pre>50</pre></div><br /><div class="docText"><pre><span class="docEmphStrong">BobÂ</span>
<span class="docEmphStrong">Get a load of the outrageous stuff Fred is sending me!</span>
<span class="docEmphStrong">- --Alice</span>
<span class="docEmphStrong">- ----BEGIN PRIVACY-ENHANCED MESSAGE-----</span></pre></div><br /></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">header, saying</span> <span class="docEmphStrong"><tt>MIC-CLEAR</tt></span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">MIC (message digest signed with Fred's private key)</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><div class="docText"><pre>50</pre></div><br /><div class="docText"><pre><span class="docEmphStrong">AliceÂ</span>
<span class="docEmphStrong">The rhythm of your typing at the terminal is driving me insane.</span>
<span class="docEmphStrong">Either type completely rhythmically or completely unrhythmically.</span>
<span class="docEmphStrong">I will complain to upper level management if you don't adjust your typing.</span>
<span class="docEmphStrong">- - --Fred</span>
<span class="docEmphStrong">- ----END PRIVACY-ENHANCED MESSAGE-----</span>
<span class="docEmphStrong">-----END PRIVACY-ENHANCED MESSAGE-----</span></pre></div><br /></p></td></tr></table></p><br />
<a name="ch21lev2sec1"></a>
<h4 id="title-IDAD15YI" class="docSection2Title">21.13.1. Forwarding a Message</h4>
<p class="docText">What should you do to a message from Fred before forwarding it to Bob so that Bob can verify Fred's signature? With non-PEM mailers, one often extracts text from one message and includes it in another. PEM certainly doesn't stop you from doing that, but if you don't send a message with the PEM information intact, there's no way for Bob to cryptographically verify that the original text was really from Fred. With public keys, it is possible to usefully forward PEM signatures. But secret key based source authentication information cannot be usefully forwarded because such information cannot be verified by a third party. Therefore, in this section, we'll assume user keys are based on public key technology.</p>
<p class="docText">Suppose Alice is just forwarding a message from Fred to Bob without adding any annotations of her own, and in the same format as she received it (<span class="docEmphRomanAlt">ENCRYPTED, MIC-CLEAR</span>, or <span class="docEmphRomanAlt">MIC-ONLY</span>). In that case she processes the message like a distribution list exploder:</p>
<ul><li><p class="docList"><a name="iddle1298"></a><a name="iddle2111"></a>In the case of a <span class="docEmphRomanAlt">MIC-CLEAR</span> or <span class="docEmphRomanAlt">MIC-ONLY</span> message, she just forwards it, without having to do any processing on it.</p></li><li><p class="docList">In the case of an <span class="docEmphRomanAlt">ENCRYPTED</span> message, she decrypts the per-message key, reencrypts it with Bob's key, and adds the encrypted key and Bob's name to the header.</p></li></ul>
<p class="docText">It could be that Alice wants to change the format of the message. The term <span class="docEmphStrong">upgrading</span> means that she turns an unencrypted message into an encrypted message. The term <span class="docEmphStrong">downgrading</span> means she turns an encrypted message into an unencrypted message. The PEM designers were careful to have the signature on a message apply to the unencrypted message, so that a message can be downgraded or upgraded without changing the signature.</p>
<p class="docText">For example, let's assume Alice has a <span class="docEmphRomanAlt">MIC-ONLY</span> message from Fred. It contains</p>
<ul><li><p class="docList">header, saying <span class="docEmphRomanAlt">MIC-ONLY</span></p></li><li><p class="docList">MIC (message digest signed with Fred's private key)</p></li><li><p class="docList">message (encoded but unencrypted)</p></li></ul>
<p class="docText">In order to encrypt it to send it to Bob, Alice picks a per-message key <span class="docEmphasis">K</span> in order to encrypt the message. Now, she can't simply encrypt the encoded message, since PEM mandates that encryption is based on an unencoded message. So she has to decode the message, encrypt the result, and encode the result of the encryption. So what she sends is</p>
<ul><li><p class="docList">header, saying <span class="docEmphRomanAlt">ENCRYPTED</span></p></li><li><p class="docList"><span class="docEmphasis">K</span> encrypted with Bob's public key</p></li><li><p class="docList">encrypted MIC, consisting of the message digest signed with Fred's private key and encrypted with <span class="docEmphasis">K</span>. Note that Alice can't sign the MIC with Fred's private key, so she has to use the MIC she received. Since the MIC she received from Fred is encoded (to pass through mailers), she has to decode the MIC to obtain the actual message digest signed with Fred's public key. That is the quantity she encrypts and then encodes.</p></li><li><p class="docList">message encrypted with <span class="docEmphasis">K</span></p></li></ul>
<p class="docText">Downgrading a message is just reversing the process. If Alice wants to annotate Fred's message before forwarding it, then she can enclose the complete message inside the text of her message, and then sign or encrypt her own message as she desires.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch21lev1sec12.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch21lev1sec14.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>