<html><head><title>17.5. So, Do We Need AH?</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch17lev1sec4.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch17lev1sec6.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch17lev1sec5"></a>
<h3 id="title-IDAQ3K2H" class="docSection1Title">17.5. So, Do We Need AH?</h3>
<p class="docText">We clearly need ESP, since it's the only one that provides encryption. But since you can do integrity-only with ESP, as well as encryption + integrity with ESP, it might seem like AH is unnecessary. What reasons do people give for keeping AH?</p>
<ul><li><p class="docList">AH protects the IP header itself, whereas ESP only protects everything beyond the ESP header. We don't think protecting the IP header matters for security.</p></li><li><p class="docList">An implementation of IPsec that only implemented AH might be more exportable. Indeed, at least one vendor reported that they were able to get export approval for their implementation of IPsec specifically because it only supported AH. But other vendors were able to get export approval for ESP. It's not unusual for different companies to get different answers for export, and the rules change with time. We think that even if an implementation of IPsec that only did AH were more exportable, it's not very important because who would buy it?</p></li><li><p class="docList">As we discussed in &sect;<a class="docLink" href="ch17lev1sec1.html#ch17lev2sec4">17.1.4</a> <span class="docEmphasis">AH and ESP</span>, with ESP, even when not using encryption, firewalls and routers cannot look beyond the layer 3 header at information such as TCP ports. This sounds like a reasonable argument, and indeed a proposal was made for TF-ESP (transport-friendly ESP), which allowed for copying all fields of interest into an unencrypted portion of the header. The arguments against TF-ESP which convinced people not to bother with it were</p><ul><li><p class="docList">Routers and firewalls have no right to look at anything above layer 3.</p></li><li><p class="docList">Anything copied over in cleartext exposes some information that might be better hidden from eavesdroppers.</p></li><li><p class="docList">Since the IPsec key is end-to-end, it is impossible for intermediate devices to verify that the cleartext fields are accurate. It would be possible to sneak past a firewall, for instance, if you set the ports in cleartext to something the firewall would allow through. The destination could, in theory, check that the cleartext fields are the same as the fields inside the ESP-protected payload when they arrive. But someone colluding with the source could change them back after the packet gets through the firewall, or if the destination were colluding with the source, it could simply not do the check.</p></li></ul></li></ul>
<p class="docText">The arguments against TF-ESP are credible, but it is unfair to simultaneously claim that intermediate devices have no right or need to look at upper layer information, and to criticize ESP for not exposing layer 4 information. It seems very unlikely that anyone would bother with IPsec for integrity protection only, and so &quot;fixing&quot; ESP to give people (e.g., firewall administrators, and router vendors who want to claim that their routers do some fancy thing) what they want is probably the only way to provide those features. In other words, rather than seeing the feature of exposed layer 4 information as a reason to keep AH, we believe that IPsec should be considered as essentially always providing encryption, and therefore if the layer 4 information needs to be exposed, there will have to be a way of exposing it with ESP. Or (our preference) decide the world can and should do without this information, especially since there's no way, even with AH, to ensure that the information is accurate, except at the endpoints.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch17lev1sec4.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch17lev1sec6.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>