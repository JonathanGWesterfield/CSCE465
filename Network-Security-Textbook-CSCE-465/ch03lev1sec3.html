<html><head><title>3.3. Data Encryption Standard (DES)</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="15051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch03lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch03lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch03lev1sec3"></a>
<h3 id="title-IDA3YSIM" class="docSection1Title">3.3. Data Encryption Standard (DES)</h3>
<p class="docText"><a name="iddle1256"></a><a name="iddle1441"></a><a name="iddle1583"></a><a name="iddle1679"></a><a name="iddle1680"></a><a name="iddle1697"></a><a name="iddle1715"></a>DES was published in 1977 by the National Bureau of Standards (since renamed to the National Institute of Standards and Technology) for use in commercial and unclassified (hmm...) U.S. Government applications. It was designed by IBM based on their own <span class="docEmphasis">Lucifer cipher</span> and input from NSA. DES uses a 56-bit key, and maps a 64-bit input block into a 64-bit output block. The key actually looks like a 64-bit quantity, but one bit in each of the 8 octets is used for odd parity on each octet. Therefore, only 7 of the bits in each octet are actually meaningful as a key.</p>
<p class="docText">DES is efficient to implement in hardware but relatively slow if implemented in software. Although making software implementations difficult was not a documented goal of DES, people have asserted that DES was specifically designed with this in mind, perhaps because this would limit its use to organizations that could afford hardware-based solutions, or perhaps because it made it easier to control access to the technology. At any rate, advances in CPUs have made it feasible to do DES in software. For instance, a 500-MIP CPU can encrypt at about 30 Koctets per second (and perhaps more depending on the details of the CPU design and the cleverness of the implementation). This is adequate for many applications.</p>
<p class="docText"></p><a name="ch03sb01"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">Why 56 bits?</h2>
<p class="docText"><a name="iddle1716"></a>Use of a 56-bit key is one of the most controversial aspects of DES. Even before DES was adopted, people outside of the intelligence community complained that 56 bits provided inadequate security [<a class="docLink" href="biblio01.html#biblio01_041">DENN82</a>, <a class="docLink" href="biblio01.html#biblio01_046">DIFF76a</a>, <a class="docLink" href="biblio01.html#biblio01_048">DIFF77</a>, <a class="docLink" href="biblio01.html#biblio01_077">HELL79</a>]. So why were only 56 of the 64 bits of a DES key used in the algorithm? The disadvantage of using 8 bits of the key for parity checking is that it makes DES considerably less secure (256 times less secure against exhaustive search).</p>
<p class="docText">OK, so what is the advantage of using 8 bits of the key for parity? Well, uh, let's say you receive a key electronically, and you want to sanity-check it to see if it could actually be a key. If you check the parity of the quantity, and it winds up not having the correct parity, then you'll know something went wrong.</p>
<p class="docText">There are two problems with this reasoning. One is that there is a 1 in 256 chance (given the parity scheme) that even if you were to get 64 bits of garbage, that the result will happen to have the correct parity and therefore look like a key. That is way too large a possibility of error for it to afford any useful protection to any application. The other problem with the reasoning is that there is nothing terribly bad about getting a bad key. You'll discover the key is bad when you try to use it for encrypting or decrypting.</p>
<p class="docText">The key, at 56 bits, is pretty much universally acknowledged to be too small to be secure. Perhaps one might argue that a smaller key is an advantage because it saves storageÂ but that argument doesn't hold since nobody does data compression on the 64-bit keys in order to fit them into 56 bits. So what benefits are there to usurping 8 bits for parity that offset the loss in security?</p>
<p class="docText">People (not us, surely!) have suggested that our government consciously decided to weaken the security of DES just enough so that NSA would be able to break it. We would like to think there is an alternative explanation, but we have never heard a plausible one proposed.</p>
</td></tr></table></p><br />
<p class="docText">Advances in semiconductor technology make the key-length issue more critical. Chip speeds have caught up so that DES keys can be broken with a bit of cleverness and exhaustive search. Perhaps a 64-bit key might have extended its useful lifetime by a few years. Given hardware price/performance improving about 40% per year, keys must grow by about 1 bit every 2 years. Assuming 56 bits was just sufficient in 1979 (when DES was standardized), 64 bits was about right in 1995, and 128 bits would suffice until 2123.</p>
<p class="docText"></p><a name="ch03sb02"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">How secure is DES?</h2>
<p class="docText"><a name="iddle1266"></a><a name="iddle1422"></a>Suppose you have a single block of &lt;plaintext, ciphertext&gt;. <span class="docEmphasis">Breaking</span> DES in this case would mean finding a key that maps that plaintext to that ciphertext. With DES implemented in software, it would take on the order of half a million MIP-years, through brute force, to find the key. (Is it possible to find the &quot;wrong&quot; key, given a particular pair? Might two different keys map the same plaintext to the same ciphertext? How many keys on the average map a particular pair? See <a class="docLink" href="ch03lev1sec7.html#ch03qa1q3">Homework Problem 3</a>.)</p>
<p class="docText">Often the attacker does not have a &lt;plaintext, ciphertext&gt; block. Instead the attacker has a reasonable amount of ciphertext only. It might be known, for example, that the encrypted data is likely to be 7-bit <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_007">ASCII</a></span>. In that case, it is still just about as efficient to do brute-force search. The ciphertext is decrypted with the guessed key, and if all the 8<span class="docEmphasis"><sup>th</sup></span> bits are zero (which will happen with an incorrect key with probability 1 in 256), then another block is decrypted. After several (say ten) blocks are decrypted, and the result always appears to be 7-bit ASCII, the key has a high probability of being correct.</p>
<p class="docText">Current commercial DES chips do not lend themselves to doing exhaustive key searchÂthey allow encrypting lots of data with a particular key. The relative speed of key loading is much less than the speed of encrypting data. However, it is straightforward to design and manufacture a key-searching DES chip.</p>
<p class="docText">In 1977, Diffie and Hellman [<a class="docLink" href="biblio01.html#biblio01_048">DIFF77</a>] did a detailed analysis of what it would cost to build a DES-breaking engine and concluded that for $20 million you could build a million-chip machine that could find a DES key in twelve hours (given a &lt;plaintext, ciphertext&gt; pair). In 1998, EFF (Electronic Frontier Foundation) [<a class="docLink" href="biblio01.html#biblio01_054">EFF98</a>] built a special-purpose DES-breaking engine, called the EFF DES Cracker, for under $250K. It was designed to find a DES key in 4.5 days. With the design done, the cost of replicating the engine was under $150K.</p>
<p class="docText">There are published papers [<a class="docLink" href="biblio01.html#biblio01_013">BIHA93</a>] claiming that less straightforward attacks can break DES faster than simply searching the key space. However, these attacks involve the premise, unlikely in real-life situations, that the attacker can choose lots of plaintext and obtain the corresponding ciphertext.</p>
<p class="docText">Still it is possible to encrypt multiple times with different keys (see &sect;<a class="docLink" href="ch04lev1sec4.html#ch04lev1sec4">4.4</a> <span class="docEmphasis">Multiple Encryption DES</span>). It is generally believed that DES with triple encryption is 2<sup>56</sup> times as difficult to crack and therefore will be secure for the foreseeable future.</p>
</td></tr></table></p><br />
<a name="ch03lev2sec1"></a>
<h4 id="title-IDAP5SIM" class="docSection2Title">3.3.1. DES Overview</h4>
<p class="docText">DES is quite understandable, and has some very elegant tricks. Let's start with the basic structure of DES (<a class="docLink" href="#ch03fig02">Figure 3-2</a>).</p>
<p class="docText"></p><a name="ch03fig02"></a><p><center>
<h5 class="docFigureTitle">Figure 3-2. Basic Structure of DES</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="450" height="422" src="03fig02.jpg" /></p>
<br />
<p class="docText">The 64-bit input is subjected to an initial permutation to obtain a 64-bit result (which is just the input with the bits shuffled). The 56-bit key is used to generate sixteen 48-bit per-round keys, by taking a different 48-bit subset of the 56 bits for each of the keys. Each round takes as input the 64-bit output of the previous round, and the 48-bit per-round key, and produces a 64-bit output. After the 16<span class="docEmphasis"><sup>th</sup></span> round, the 64-bit output has its halves swapped and is then subjected to another permutation, which happens to be the inverse of the initial permutation.</p>
<p class="docText">That is the overview of how encryption works. Decryption works by essentially running DES backwards. To decrypt a block, you'd first run it through the initial permutation to undo the final permutation (the initial and final permutations are inverses of each other). You'd do the same key generation, though you'd use the keys in the opposite order (first use <span class="docEmphasis">K</span><sub>16</sub>, the key you generated last). Then you run 16 rounds just like for encryption. Why this works will be explained when we explain what happens during a round. After 16 rounds of decryption, the output has its halves swapped and is then subjected to the final permutation (to undo the initial permutation).</p>
<p class="docText">To fully specify DES, we need to specify the initial and final permutations, how the per round keys are generated, and what happens during a round. Let's start with the initial and final permutations of the data.</p>
<a name="ch03lev2sec2"></a>
<h4 id="title-IDAQBTIM" class="docSection2Title">3.3.2. The Permutations of the Data</h4>
<p class="docText"><a name="iddle1260"></a><a name="iddle1800"></a>DES performs an initial and final permutation on the data, which do essentially nothing to enhance DES's security (see <span class="docEmphasis">Why permute?</span> on page <a class="docLink" href="#ch03sb03">67</a>). The most plausible reason for these permutations is to make DES less efficient to implement in software.</p>
<p class="docText">The way the permutations are specified in the DES spec is as follows:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="16"><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="100"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top" colspan="8"><p class="docText"><span class="docEmphRomanAlt">Initial Permutation (IP)</span></p></td><td class="docTableCell" align="center" valign="top" colspan="8"><p class="docText"><span class="docEmphRomanAlt">Final Permutation (IP<sup>-</sup>1)</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">58</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">50</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">42</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">34</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">26</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">18</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">10</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">2</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">40</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">8</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">48</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">16</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">56</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">24</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">64</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">32</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">60</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">52</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">44</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">36</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">28</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">20</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">12</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">4</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">39</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">7</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">47</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">15</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">55</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">23</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">63</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">31</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">62</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">54</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">46</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">38</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">30</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">22</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">14</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">6</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">38</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">6</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">46</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">14</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">54</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">22</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">62</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">30</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">64</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">56</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">48</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">40</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">32</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">24</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">16</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">8</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">37</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">5</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">45</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">13</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">53</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">21</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">61</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">29</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">57</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">49</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">41</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">33</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">25</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">17</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">9</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">1</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">36</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">4</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">44</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">12</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">52</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">20</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">60</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">28</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">59</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">51</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">43</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">35</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">27</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">19</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">11</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">3</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">35</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">3</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">43</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">11</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">51</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">19</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">59</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">27</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">61</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">53</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">45</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">37</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">29</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">21</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">13</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">5</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">34</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">2</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">42</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">10</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">50</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">18</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">58</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">26</span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">63</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">55</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">47</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">39</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">31</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">23</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">15</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">7</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">33</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">1</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">41</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">9</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">49</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">17</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">57</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">25</span></p></td></tr></table></p><br />
<p class="docText">The numbers in the above tables specify the bit numbers of the input to the permutation. The order of the numbers in the tables corresponds to the output bit position. So for example, the initial permutation moves input bit 58 to output bit 1 and input bit 50 to output bit 2.</p>
<p class="docText">The permutation is not a random-looking permutation. <a class="docLink" href="#ch03fig03">Figure 3-3</a> pictures it. The arrows indicate the initial permutation. Reverse the arrows to get the final permutation. We hope you appreciate the time we spent staring at the numbers and discovering this completely useless structure.</p>
<a name="ch03fig03"></a><p><center>
<h5 class="docFigureTitle">Figure 3-3. Initial Permutation of Data Block</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="261" src="03fig03.jpg" /></p>
<br />
<p class="docText"><a name="iddle1261"></a><a name="iddle1262"></a><a name="iddle1801"></a><a name="iddle1802"></a>The input is 8 octets. The output is 8 octets. The bits in the first octet of input get spread into the 8<span class="docEmphasis"><sup>th</sup></span> bits of each of the octets. The bits in the second octet of input get spread into the 7<span class="docEmphasis"><sup>th</sup></span> bits of all the octets. And in general, the bits of the <span class="docEmphasis">i<sup>th</sup></span> octet get spread into the (9-<span class="docEmphasis">i)<sup>th</sup></span> bits of all the octets. The pattern of spreading of the 8 bits in octet <span class="docEmphasis">i</span> of the input among the output octets is that the even-numbered bits go into octets 1Â4, and the odd-numbered bits go into octets 5Â8. Note that if the data happens to be 7-bit ASCII, with the top bit set to zero, then after the permutation the entire 5<span class="docEmphasis"><sup>th</sup></span> octet will be zero. Since the permutation appears to have no security value, it seems nearly certain that there is no security significance to this particular permutation.</p>
<a name="ch03sb03"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">Why permute?</h2>
<p class="docText">Why can't the initial and final permutations of the data be of security value? Well, suppose they were important, i.e., if DES did not have them it would be possible to break DES. Let's call a modified DES that does not have the initial and final permutation <span class="docEmphStrong">EDS</span>. Let's say we can break EDS, i.e., given a &lt;plaintext,ciphertext&gt; EDS pair, we can easily calculate the EDS key that converts the plaintext into the ciphertext. In that case, we can easily break DES as well. Given a DES &lt;plaintext,ciphertext&gt; pair &lt;<span class="docEmphasis">m</span>,<span class="docEmphasis">c</span>&gt;, we simply do the inverse of the initial permutation (i.e. the final permutation) on <span class="docEmphasis">m</span> to get <span class="docEmphasis">m</span>', and the inverse of the final permutation (i.e. the initial permutation) on <span class="docEmphasis">c</span> to get <span class="docEmphasis">c</span>', and feed &lt;<span class="docEmphasis">m</span>',<span class="docEmphasis">c</span>'&gt; to our EDS-breaking code. The resulting EDS key will work as the DES key for &lt;<span class="docEmphasis">m</span>,<span class="docEmphasis">c</span>&gt;.</p>
<p class="docText">Note that when multiple encryptions of DES are being performed, the permutation might have some value. However, if encryption with key<sub>1</sub> is followed by encryption with key<sub>2</sub>, then the final permutation following encryption with key<sub>1</sub> will cancel the initial permutation for key<sub>2</sub>. That is one of the reasons people discuss alternating encrypt operations with decrypt operations (see &sect;<a class="docLink" href="ch04lev1sec4.html#ch04lev1sec4">4.4</a> <span class="docEmphasis">Multiple Encryption DES</span>).</p>
<p class="docText">In &sect;<a class="docLink" href="#ch03lev2sec3">3.3.3</a> <span class="docEmphasis">Generating the Per-Round Keys</span>, we'll see there is also a permutation of the key. It also has no security value (by a similar argument).</p>
</td></tr></table></p><br />
<a name="ch03lev2sec3"></a>
<h4 id="title-IDABJUIM" class="docSection2Title">3.3.3. Generating the Per-Round Keys</h4>
<p class="docText">Next we'll specify how the sixteen 48-bit per-round keys are generated from the DES key. The DES key looks like it's 64 bits long, but 8 of the bits are parity. Let's number the bits of the DES key from left to right as 1, 2,...64. Bits 8, 16,...64 are the parity bits. DES performs a function, which we are about to specify, on these 64 bits to generate sixteen 48-bit keys, which are <span class="docEmphasis">K</span><sub>1</sub>, <span class="docEmphasis">K</span><sub>2</sub>,...<span class="docEmphasis">K</span><sub>16</sub>.</p>
<p class="docText">First it does an initial permutation on the 56 useful bits of the key, to generate a 56-bit output, which it divides into two 28-bit values, called <span class="docEmphasis">C</span><sub>0</sub> and <span class="docEmphasis">D</span><sub>0</sub>. The permutation is specified as</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="14"><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="75"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="40"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top" colspan="7"><p class="docText"><span class="docEmphasis">C</span><sub>0</sub></p></td><td class="docTableCell" align="center" valign="top" colspan="7"><p class="docText"><span class="docEmphasis">D</span><sub>0</sub></p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">57</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">49</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">41</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">33</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">25</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">17</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">9</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">63</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">55</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">47</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">39</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">31</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">23</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">15</span></p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">1</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">58</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">50</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">42</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">34</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">26</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">18</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">7</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">62</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">54</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">46</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">38</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">30</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">22</span></p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">10</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">2</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">59</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">51</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">43</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">35</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">27</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">14</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">6</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">61</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">53</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">45</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">37</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">29</span></p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">19</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">11</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">3</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">60</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">52</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">44</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">36</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">21</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">13</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">5</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">28</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">20</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">12</span></p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">4</span></p></td></tr></table></p><br />
<p class="docText">The way to read the table above is that the leftmost bit of the output is obtained by extracting bit 57 from the key. The next bit is bit 49 of the key, and so forth, with the final bit of <span class="docEmphasis">D</span><sub>0</sub> being bit 4 of the key. Notice that none of the parity bits (8, 16,...64) is used in <span class="docEmphasis">C</span><sub>0</sub> or <span class="docEmphasis">D</span><sub>0</sub>.</p>
<p class="docText">This permutation is not random. <a class="docLink" href="#ch03fig04">Figure 3-4</a> pictures it. Feel free to draw in any arrows or other graphic aids to make it clearer.</p>
<a name="ch03fig04"></a><p><center>
<h5 class="docFigureTitle">Figure 3-4. Initial Permutation of Key</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="161" src="03fig04.jpg" /></p>
<br />
<p class="docText">The initial and final permutations of the bits in the key have no security value (just like the initial and final permutations of the data), so the permutations didn't have to be randomÂthe identity permutation would have done nicely.</p>
<p class="docText">Now the generation of the <span class="docEmphasis">K<sub>i</sub></span> proceeds in 16 rounds (see <a class="docLink" href="#ch03fig05">Figure 3-5</a>). The number of bits shifted is different in the different rounds. In rounds 1, 2, 9, and 16, it is a single-bit rotate left (with <a name="iddle1263"></a><a name="iddle1932"></a>the bit shifted off the left end carried around and shifted into the right end). In the other rounds, it is a two-bit rotate left.</p>
<a name="ch03fig05"></a><p><center>
<h5 class="docFigureTitle">Figure 3-5. Round <span class="docEmphasis">i</span> for generating <span class="docEmphasis">K<sub>i</sub></span></h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="165" src="03fig05.jpg" /></p>
<br />
<p class="docText">The permutations in this case are likely to be of some security value.</p>
<p class="docText">The permutation of <span class="docEmphasis">C<sub>i</sub></span> that produces the left half of <span class="docEmphasis">K<sub>i</sub></span> is the following. Note that bits 9, 18, 22, and 25 are discarded.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="7"><col width="320"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="middle" rowspan="4"><p class="docText">permutation to obtain the left half of <span class="docEmphasis">K<sub>i</sub></span>:</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">14</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">17</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">11</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">24</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">5</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">3</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">28</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">15</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">6</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">21</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">10</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">23</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">19</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">12</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">4</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">26</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">8</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">16</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">7</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">27</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">20</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">13</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">2</p></td></tr></table></p><br />
<p class="docText">The permutation of the rotated <span class="docEmphasis">D</span><sub><span class="docEmphasis">i</span>-1</sub> that produces the right half of <span class="docEmphasis">K<sub>i</sub></span> is as follows (where the bits of the rotated <span class="docEmphasis">D</span><sub><span class="docEmphasis">i</span>-1</sub> are numbered 29, 30,...56, and bits 35, 38, 43, and 54 are discarded).</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="7"><col width="320"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col><col width="30"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="middle" rowspan="4"><p class="docText">permutation to obtain the right half of <span class="docEmphasis">K<sub>i</sub></span>:</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">41</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">52</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">31</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">37</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">47</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">55</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">30</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">40</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">51</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">45</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">33</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">48</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">44</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">49</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">39</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">56</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">34</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">53</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">46</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">42</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">50</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">36</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">29</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">32</p></td></tr></table></p><br />
<p class="docText">Each of the halves of <span class="docEmphasis">K<sub>i</sub></span> is 24 bits, so <span class="docEmphasis">K<sub>i</sub></span> is 48 bits long.</p>
<a name="ch03lev2sec4"></a>
<h4 id="title-IDA2JVIM" class="docSection2Title">3.3.4. A DES Round</h4>
<p class="docText">Now let's look at what a single round of DES does. <a class="docLink" href="#ch03fig06">Figure 3-6</a> shows both how encryption and decryption work.</p>
<a name="ch03fig06"></a><p><center>
<h5 class="docFigureTitle">Figure 3-6. DES Round</h5>
</center></p><p class="docText"><div class="v1"><a target="_blank" href="03fig06_alt.jpg">[View full size image]</a></div><img border="0" alt="" id="118095013052" width="500" height="275" src="03fig06.jpg" /></p>
<br />
<p class="docText">In encryption, the 64-bit input is divided into two 32-bit halves called <span class="docEmphasis">L<sub>n</sub></span> and <span class="docEmphasis">R<sub>n</sub></span>. The round generates as output 32-bit quantities <span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub> and <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub>. The concatenation of <span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub> and <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub> is the 64-bit output of the round.</p>
<p class="docText"><span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub> is simply <span class="docEmphasis">R<sub>n</sub></span>. <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub> is obtained as follows. First <span class="docEmphasis">R<sub>n</sub></span> and <span class="docEmphasis">K<sub>n</sub></span> are input to what we call a <span class="docEmphasis">mangler function</span>, which outputs a 32-bit quantity. That quantity is <img src="U2295.GIF" border="0" />'d with <span class="docEmphasis">L<sub>n</sub></span> to obtain the new <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub>. The mangler takes as input 32 bits of the data plus 48 bits of the key to produce a 32-bit output.</p>
<p class="docText">Given the above, suppose you want to run DES backward, i.e. to decrypt something. Suppose you know <span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub> and <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub>. How do you get <span class="docEmphasis">L<sub>n</sub></span> and <span class="docEmphasis">R<sub>n</sub></span>?</p>
<p class="docText">Well, <span class="docEmphasis">R<sub>n</sub></span> is just <span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub>. Now you know <span class="docEmphasis">R<sub>n</sub></span>, <span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub>, <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub> and <span class="docEmphasis">K<sub>n</sub></span>. You also know that <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub> equals <span class="docEmphasis">L<sub>n</sub></span> <img src="U2295.GIF" border="0" /> mangler(<span class="docEmphasis">R<sub>n</sub></span>, <span class="docEmphasis">K<sub>n</sub></span>). You can compute mangler(<span class="docEmphasis">R<sub>n</sub></span>, <span class="docEmphasis">K<sub>n</sub></span>), since you know <span class="docEmphasis">R<sub>n</sub></span> and <span class="docEmphasis">K<sub>n</sub></span>. Now <img src="U2295.GIF" border="0" /> that with <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub>. The result will be <span class="docEmphasis">L<sub>n</sub></span>. Note that the mangler is never run backwards. DES is elegantly designed to be reversible without constraining the mangler function to be reversible. This design is <a name="iddle1258"></a><a name="iddle1370"></a><a name="iddle1597"></a>due to Feistel [<a class="docLink" href="biblio01.html#biblio01_058">FEIS73</a>]. Theoretically the mangler could map all values to zero, and it would still be possible to run DES backwards, but having the mangler function map all functions to zero would make DES pretty unsecure (see <a class="docLink" href="ch03lev1sec7.html#ch03qa1q5">Homework Problem 5</a>).</p>
<p class="docText">If you examine <a class="docLink" href="#ch03fig06">Figure 3-6</a> carefully, you will see that decryption is identical to encryption with the 32-bit halves swapped. In other words, feeding <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub>|<span class="docEmphasis">L</span><sub><span class="docEmphasis">n</span>+1</sub> into round <span class="docEmphasis">n</span> produces <span class="docEmphasis">R<sub>n</sub></span>|<span class="docEmphasis">L<sub>n</sub></span> as output.</p>
<a name="ch03lev2sec5"></a>
<h4 id="title-IDANSVIM" class="docSection2Title">3.3.5. The Mangler Function</h4>
<p class="docText">The mangler function takes as input the 32-bit <span class="docEmphasis">R<sub>n</sub></span>, which we'll simply call <span class="docEmphasis">R</span>, and the 48-bit <span class="docEmphasis">K<sub>n</sub></span>, which we'll call <span class="docEmphasis">K</span>, and produces a 32-bit output which, when <img src="U2295.GIF" border="0" />'d with <span class="docEmphasis">L<sub>n</sub></span>, produces <span class="docEmphasis">R</span><sub><span class="docEmphasis">n</span>+1</sub> (the next <span class="docEmphasis">R</span>).</p>
<p class="docText">The mangler function first expands <span class="docEmphasis">R</span> from a 32-bit value to a 48-bit value. It does this by breaking <span class="docEmphasis">R</span> into eight 4-bit chunks and then expanding each of those chunks to 6 bits by taking the <a name="iddle1264"></a><a name="iddle1951"></a><a name="iddle2046"></a>adjacent bits and concatenating them to the chunk. The leftmost and rightmost bits of <span class="docEmphasis">R</span> are considered adjacent.</p>
<a name="ch03fig07"></a><p><center>
<h5 class="docFigureTitle">Figure 3-7. Expansion of <span class="docEmphasis">R</span> to 48 bits</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="350" height="62" src="03fig07.jpg" /></p>
<br />
<a name="ch03fig08"></a><p><center>
<h5 class="docFigureTitle">Figure 3-8. Chunk Transformation</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="300" height="219" src="03fig08.jpg" /></p>
<br />
<p class="docText">The 48-bit <span class="docEmphasis">K</span> is broken into eight 6-bit chunks. Chunk <span class="docEmphasis">i</span> of the expanded <span class="docEmphasis">R</span> is <img src="U2295.GIF" border="0" />'d with chunk <span class="docEmphasis">i</span> of <span class="docEmphasis">K</span> to yield a 6-bit output. That 6-bit output is fed into an <span class="docEmphStrong">S-box</span>, a substitution which produces a 4-bit output for each possible 6-bit input. Since there are 64 possible input values (6 bits) and only 16 possible output values (4 bits), the S-box clearly maps several input values to the same output value. As it turns out, there are exactly four input values that map to each possible output value. There's even more pattern to it than that. Each S-box could be thought of as four separate 4-bit to 4-bit S-boxes, with the inner 4 bits of the 6-bit chunk serving as input, and the outer 2 bits selecting which of the four 4-bit S-boxes to use. The S-boxes are specified as follows:</p>
<a name="ch03fig09"></a><p><center>
<h5 class="docFigureTitle">Figure 3-9. Table of 4-bit outputs of S-box 1 (bits 1 thru 4)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig09.jpg" /></p>
<br />
<a name="ch03fig10"></a><p><center>
<h5 class="docFigureTitle">Figure 3-10. Table of 4-bit outputs of S-box 2 (bits 5 thru 8)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig10.jpg" /></p>
<br />
<a name="ch03fig11"></a><p><center>
<h5 class="docFigureTitle">Figure 3-11. Table of 4-bit outputs of S-box 3 (bits 9 thru 12)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig11.jpg" /></p>
<br />
<a name="ch03fig12"></a><p><center>
<h5 class="docFigureTitle">Figure 3-12. Table of 4-bit outputs of S-box 4 (bits 13 thru 16)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig12.jpg" /></p>
<br />
<p class="docText"></p><a name="ch03fig13"></a><p><center>
<h5 class="docFigureTitle">Figure 3-13. Table of 4-bit outputs of S-box 5 (bits 17 thru 20)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig13.jpg" /></p>
<br />
<a name="ch03fig14"></a><p><center>
<h5 class="docFigureTitle">Figure 3-14. Table of 4-bit outputs of S-box 6 (bits 21 thru 24)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig14.jpg" /></p>
<br />
<a name="ch03fig15"></a><p><center>
<h5 class="docFigureTitle">Figure 3-15. Table of 4-bit outputs of S-box 7 (bits 25 thru 28)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig15.jpg" /></p>
<br />
<a name="ch03fig16"></a><p><center>
<h5 class="docFigureTitle">Figure 3-16. Table of 4-bit outputs of S-box 8 (bits 29 thru 32)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="103" src="03fig16.jpg" /></p>
<br />
<p class="docText">The 4-bit output of each of the eight S-boxes is combined into a 32-bit quantity whose bits are then permuted. A permutation at this point is of security value to DES in order to ensure that the bits of the output of an S-box on one round of DES affects the input of multiple S-boxes on the next round. Without the permutation, an input bit on the left would mostly affect the output bits on the left.</p>
<p class="docText"><a name="iddle1976"></a><a name="iddle2129"></a>The actual permutation used is very random looking (we can't find any nice patterns to make the permutation easy to visualizeÂit's possible a non-random looking permutation would not be as secure).</p>
<a name="ch03fig17"></a><p><center>
<h5 class="docFigureTitle">Figure 3-17. Permutation of the 32 bits from the S-boxes</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="500" height="19" src="03fig17.jpg" /></p>
<br />
<p class="docText">The way to read this is that the 1<span class="docEmphasis"><sup>st</sup></span> bit of output of the permutation is the 16<span class="docEmphasis"><sup>th</sup></span> input bit, the 2<span class="docEmphasis"><sup>nd</sup></span> output bit is the 7<span class="docEmphasis"><sup>th</sup></span> input bit,...the 32<span class="docEmphasis"><sup>nd</sup></span> output bit is the 25<span class="docEmphasis"><sup>th</sup></span> input bit.</p>
<a name="ch03lev2sec6"></a>
<h4 id="title-IDA54VIM" class="docSection2Title">3.3.6. Weak and Semi-Weak Keys</h4>
<p class="docText">We include this section mainly for completeness. There are sixteen DES keys that the security community warns people against using, because they have strange properties. But the probability of randomly generating one of these keys is only 16/2<sup>56</sup>, which in our opinion is nothing to worry about. It's probably equally insecure to use a key with a value less than a thousand, since an attacker might be likely to start searching for keys from the bottom.</p>
<p class="docText">Remember from &sect;<a class="docLink" href="#ch03lev2sec3">3.3.3</a> <span class="docEmphasis">Generating the Per-Round Keys</span> that the key is subjected to an initial permutation to generate two 28-bit quantities, <span class="docEmphasis">C</span><sub>0</sub> and <span class="docEmphasis">D</span><sub>0</sub>. The sixteen suspect keys are ones for which <span class="docEmphasis">C</span><sub>0</sub> and <span class="docEmphasis">D</span><sub>0</sub> are one of the four values: all ones, all zeroes, alternating ones and zeroes, alternating zeroes and ones. Since there are four possible values for each half, there are sixteen possibilities in all. The four <span class="docEmphStrong">weak keys</span> are the ones for which each of <span class="docEmphasis">C</span><sub>0</sub> and <span class="docEmphasis">D</span><sub>0</sub> are all ones or all zeroes. Weak keys are their own inverses. <sup class="docFootnote"><a class="docLink" href="#ch03fn01">[*]</a></sup> The remaining twelve keys are the <span class="docEmphStrong">semi-weak keys</span>. Each is the inverse of one of the others.</p><blockquote><p class="docFootnote"><sup><a name="ch03fn01">[*]</a></sup> Two keys are inverses if encrypting with one is the same as decrypting with the other.</p></blockquote>
<a name="ch03lev2sec7"></a>
<h4 id="title-IDA1YAJM" class="docSection2Title">3.3.7. What's So Special About DES?</h4>
<p class="docText">DES is actually quite simple, as is IDEA (which we'll explain next). One gets the impression that anyone could design a secret key encryption algorithm. Just take the bits, shuffle them, shuffle them some more, and you have an algorithm. In fact, however, these things are very mysterious. For example, the S-boxes seem totally arbitrary. Did anyone put any thought into exactly what substitutions each S-box should perform? Well, Biham and Shamir [<a class="docLink" href="biblio01.html#biblio01_011">BIHA91</a>] have shown that with an incredibly trivial change to DES consisting of swapping S-box 3 with S-box 7, DES is about an order of magnitude less secure in the face of a specific (admittedly not very likely) attack.</p>
<p class="docText"><a name="iddle1445"></a><a name="iddle1457"></a><a name="iddle1464"></a><a name="iddle1478"></a>It is unfortunate that the design process for DES was not more public. We don't know if the particular details were well-chosen for strength, whether someone flipped coins, for instance, to construct the S-boxes, or even whether the particular details were well-chosen to have some sort of weakness that could only be exploited by someone involved in the design process. The claim for why the design process was kept secret, and it is a plausible claim, is that the DES designers knew about many kinds of cryptanalytic attacks, and that they specifically designed DES to be strong against all the ones they knew about. If they publicized the design process, they'd have to divulge all the cryptanalytic attacks they knew about, which would then further educate potential bad guys, which might make some cryptographic standards that were designed without this knowledge vulnerable.</p>
<p class="docText">In the hash algorithms designed by Ron Rivest (MD2, MD4, MD5), in order to eliminate the suspicion that they might be specifically chosen to have secret weaknesses, constants that should be reasonably random were chosen through some demonstrable manner, for instance by being the digits of an irrational number such as 

<img border="0" alt="" width="18" height="15" src="root2.jpg" />


.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="15051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch03lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch03lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>