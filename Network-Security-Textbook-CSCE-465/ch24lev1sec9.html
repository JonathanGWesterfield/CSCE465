<html><head><title>24.9. Clipper</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch24lev1sec8.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch24lev1sec10.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch24lev1sec9"></a>
<h3 id="title-IDA21WQH" class="docSection1Title">24.9. Clipper</h3>
<p class="docText">Telephones are easy to tap, and cellular telephones make eavesdropping even easier. Because of this, people have developed encrypting telephones, which so far have been too expensive to catch on, but today it is technically feasible to make encrypting telephones inexpensively. This makes the government nervous because criminals are sometimes convicted using evidence gathered through wiretaps. To fill the need for encryption without the U.S. government giving up the ability to wiretap (with legitimate reason and through a court order), the U.S. government has proposed the Clipper chip. The Clipper proposal offers high-grade encryption while preserving the ability of the U.S. government to wiretap.</p>
<p class="docText">The politics of Clipper are at least as exciting as the technical aspects. We discuss the politics in &sect;<a class="docLink" href="ch01lev1sec10.html#ch01lev1sec10">1.10</a> <span class="docEmphasis">Key Escrow for Law Enforcement</span>. Here we concentrate on the technical aspects.</p>
<p class="docText">Technically the concept of Clipper is reasonably simple. Each Clipper chip manufactured contains a unique 80-bit key and a unique 32-bit ID. For each key <span class="docEmphasis">K</span>, an 80-bit random number <span class="docEmphasis">K</span><sub>1</sub> is selected, and then <span class="docEmphasis">K</span><sub>2</sub>=<span class="docEmphasis">K</span><img src="U2295.GIF" border="0" /><span class="docEmphasis">K</span><sub>1</sub> is computed. Neither quantity <span class="docEmphasis">K</span><sub>1</sub> nor <span class="docEmphasis">K</span><sub>2</sub> gives any information about <span class="docEmphasis">K</span>, but if you know both <span class="docEmphasis">K</span><sub>1</sub> and <span class="docEmphasis">K</span><sub>2</sub>, you can compute <span class="docEmphasis">K</span> easily, since it is <span class="docEmphasis">K</span><sub>1</sub><img src="U2295.GIF" border="0" /><span class="docEmphasis">K</span><sub>2</sub>. <span class="docEmphasis">K</span><sub>1</sub> (and the unique ID) is given to one federal agency, and <span class="docEmphasis">K</span><sub>2</sub> (and the unique ID) is given to a different federal agency. It hasn't been decided which agencies they'll be, but they should be agencies that everyone trusts, like the IRS, and that are independent of one another without likelihood of collusion, like the Army and the Navy.</p>
<p class="docText">Let's say that Alice, using a telephone containing a Clipper chip, wants to talk to Bob, who has a similar device. Alice's chip has been registered with the two agencies (as has Bob's). Let's <a name="iddle1175"></a><a name="iddle1367"></a><a name="iddle1559"></a><a name="iddle1560"></a><a name="iddle1631"></a>say Alice's chip has unique ID ID<sub>A</sub> and secret key <span class="docEmphasis">K</span><sub>A</sub>. With a court order, the government can obtain the two components of Alice's chip's key and then reconstruct <span class="docEmphasis">K</span><sub>A</sub>. Without a court order, <span class="docEmphasis">K</span><sub>A</sub> remains secret.</p>
<p class="docText">What key will Alice and Bob use for communicating? It can't be <span class="docEmphasis">K</span><sub>A</sub> or <span class="docEmphasis">K</span><sub>B</sub> (Bob's chip's secret key) because neither side wants to reveal its secret key. So Alice and Bob use some mechanism, unspecified in the Clipper standard, to produce a shared secret key <span class="docEmphasis">S</span>. A reasonable choice is Diffie-Hellman (see &sect;<a class="docLink" href="ch06lev1sec4.html#ch06lev1sec4">6.4</a> <span class="docEmphasis">Diffie-Hellman</span>), which was what was implemented in the Clipper phones. Alice feeds <span class="docEmphasis">S</span> to her Clipper chip and Bob feeds <span class="docEmphasis">S</span> to his Clipper chip. The chips use <span class="docEmphasis">S</span> to encrypt and decrypt the data. So where does <span class="docEmphasis">K</span><sub>A</sub> come in, and how would the government, knowing <span class="docEmphasis">K</span><sub>A</sub>, be able to decrypt the conversation? Also, how does the government know the unique ID of Alice's chip in order to obtain (with court order) <span class="docEmphasis">K</span><sub>A</sub>? It would be an administrative nightmare for the U.S. government to try to keep track of who owns each Clipper chip.</p>
<p class="docText">The information the government needs is in a field known as the <b><a class="docLink" href="app02.html#gloss01_120">LEAF</a></b>, for <b><a class="docLink" href="app02.html#gloss01_120">Law Enforcement Access Field</a></b>, that Alice's and Bob's Clipper chips transmit along with the encrypted data. Although Bob's chip does not utilize any of the information in the LEAF it receives from Alice's chip, Bob's chip refuses to communicate unless it receives a valid-looking LEAF. The central challenge in the design of Clipper is preventing someone from building a device that uses a Clipper chip for secure communication but substitutes garbage for the LEAF before transmitting the data.</p>
<p class="docText">The Clipper design is very clever. The LEAF that Alice transmits to Bob contains ID<sub>A</sub>, <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>}, and a checksum <span class="docEmphasis">C</span>. The field ID<sub>A</sub> enables the government to retrieve <span class="docEmphasis">K</span><sub>A</sub> and then decrypt the field <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>} to obtain <span class="docEmphasis">S</span>. Since the same key <span class="docEmphasis">S</span> is used in both directions, the government only needs one of the keys <span class="docEmphasis">K</span><sub>A</sub> or <span class="docEmphasis">K</span><sub>B</sub> in order to decrypt the entire conversation.</p>
<p class="docText">How does Bob's chip know whether the LEAF is valid? Bob's chip can't know whether ID<sub>A</sub> is the correct value and it can't decrypt <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>} to check if it's the correct encrypted key. Bob's chip makes its decision based on the value of the field <span class="docEmphasis">C</span>. <span class="docEmphasis">C</span> is basically some sort of message digest of the other fields in the LEAF (ID<sub>A</sub> and <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>}) and the key <span class="docEmphasis">S</span>. Bob's chip computes the message digest of the values in the received LEAF for ID<sub>A</sub> and <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>}, along with <span class="docEmphasis">S</span> (which Bob's chip knows). If the computed checksum matches the received <span class="docEmphasis">C</span>, then the entire LEAF is assumed to be valid.</p>
<p class="docText">The message digest algorithm used to compute <span class="docEmphasis">C</span> need not be secret, so what's to prevent someone from foiling the government's ability to wiretap by modifying the quantity <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>} (or ID<sub>A</sub>) and sending the matching <span class="docEmphasis">C</span>? To prevent modification of the LEAF, all Clipper chips share an 80-bit secret <span class="docEmphStrong">family key</span>, <span class="docEmphasis">F</span>. The quantity ID<sub>A</sub>|<span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>}|<span class="docEmphasis">C</span> is encrypted with <span class="docEmphasis">F</span>. Since Bob's chip knows <span class="docEmphasis">F</span>, it can decrypt the LEAF to extract ID<sub>A</sub>, <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>}, and <span class="docEmphasis">C</span>. It can't verify that either ID<sub>A</sub> or <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>} is correct, but knowing <span class="docEmphasis">S</span>, it can compute <span class="docEmphasis">C</span>. If the <span class="docEmphasis">C</span> in the LEAF doesn't match the computed <span class="docEmphasis">C</span>, the chip will refuse to decrypt the conversation.</p>
<p class="docText">With the LEAF thus guaranteed, the government can (with a valid court order) tap Alice's line, read ID<sub>A</sub> from the LEAF, and then retrieve <span class="docEmphasis">K</span><sub>A</sub>. Then it can read <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>} from the LEAF and decrypt it to obtain <span class="docEmphasis">S</span>. At this point, it can decrypt the recorded conversation.</p>
<p class="docText"><a name="iddle2008"></a>It is rather astonishing that all Clipper chips will know the value <span class="docEmphasis">F</span>, and yet the expectation is that the value will remain secret. Clipper chips are carefully manufactured so that it should not be possible, by taking one apart, to obtain <span class="docEmphasis">F</span>. The encryption algorithm (<b><a class="docLink" href="app02.html#gloss01_207">SKIPJACK</a></b>) was originally intended to be kept secret, and the same technology that prevents someone from reverse-engineering the encryption algorithm would protect <span class="docEmphasis">F</span>. But eventually the government decided to declassify SKIPJACK.</p>
<p class="docText">How much of a disaster would it be if someone discovered <span class="docEmphasis">F</span>? It would not make Clipper-protected conversations less secure. However, it would mean someone could build a device that inter-operated with Clipper devices and foiled wiretapping by generating garbage for ID<sub>A</sub>|<span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>}, computing the proper value for <span class="docEmphasis">C</span> based on the garbage and the session key <span class="docEmphasis">S</span>, and encrypting it all with <span class="docEmphasis">F</span>.</p>
<p class="docText">It has been pointed out that people could, with less effort, build a device that encrypted the data before transmitting it to the Clipper chip. Provided the receiver had a compatible device (Clipper plus the extra encryption device), the output stream would look like normal Clipper output, until someone, under court order, decrypted the conversation and realized they were obtaining ciphertext.</p>
<p class="docText">If you had a device capable of encrypting conversations, why would you bother going through the extra step of sending the encrypted stream through a Clipper chip? Perhaps you don't have complete faith in your cryptographic algorithm. Another reason surfaces if it becomes illegal or suspicious to use non-Clipper encryption. If you send your encrypted stream through a Clipper chip, the government would not know that you were using your own encryption, until after it obtained the court order and decrypted your conversation. One wonders what penalties could be associated with using non-Clipper encryption that would deter the sorts of people who are worried about being wiretapped.</p>
<table cellspacing="0" cols="3" width="95%" border="0" cellpadding="5"><colgroup><col width="10%"></col><col width="2%"></col><col width="88%"></col></colgroup><tr><td valign="top"><span class="docEmphBold">Prosecutor:</span></td><td></td><td><p class="docText"><span class="docEmphasis">Did you murder your wife?</span></p></td></tr><tr><td valign="top"><span class="docEmphBold">Defendant:</span></td><td></td><td><p class="docText"><span class="docEmphasis">No.</span></p></td></tr><tr><td valign="top"><span class="docEmphBold">Prosecutor:</span></td><td></td><td><p class="docText"><span class="docEmphasis">Do you know the penalty for perjury?</span></p></td></tr><tr><td valign="top"><span class="docEmphBold">Defendant:</span></td><td></td><td><p class="docText"><span class="docEmphasis">No, but I bet it's less than the penalty for murder!</span></p></td></tr></table>
<p class="docText">Âclassic joke</p>
<p class="docText">If someone discovered <span class="docEmphasis">F</span> and built a Clipper-compatible device, then Alice, with that device, could foil wiretapping while talking to Bob, who had an ordinary Clipper device. If the government had Alice under suspicion, and therefore had obtained her Clipper key, it would still need to get a court order for Bob's Clipper key before it could decrypt the Alice-Bob conversation. If both Alice and Bob had one of these Clipper-compatible devices, then the government would discover, only after court order, that Alice and Bob were not using real Clipper devices, just as it would discover if Alice and Bob were using an extra encryption step before the Clipper chip.</p>
<p class="docText"><a name="iddle1123"></a><a name="iddle1535"></a>Matt Blaze [<a class="docLink" href="biblio01.html#biblio01_019">BLAZ94</a>] discovered an interesting property of the Clipper design that makes it possible for Alice, with a lot of effort, to forge a LEAF in a way that Bob will accept, but will prevent government wiretaps. The problem is that the quantity <span class="docEmphasis">C</span> is only 16 bits long. Remember that Bob's chip cannot verify that either of the quantities ID<sub>A</sub> or <span class="docEmphasis">K</span><sub>A</sub>{<span class="docEmphasis">S</span>} is correct. All the chip can do is verify that <span class="docEmphasis">C</span> is based on those quantities and the proper key <span class="docEmphasis">S</span>.</p>
<p class="docText">The LEAF is 128 bits long, consisting of 32 bits of ID, 80 bits of encrypted key, and 16 bits of checksum. Bob's chip will accept any sequence of bits for the ID and the encrypted key as long as those fields, plus the Alice-Bob session key, produce the correct 16-bit checksum. The implication of this is that if Alice were to send a 128-bit random number, it would have 1 chance in 2<sup>16</sup> of having the correct checksum, when decrypted with the family key <span class="docEmphasis">F</span>.</p>
<p class="docText">Now we get to Matt Blaze's attack. Alice can use any Clipper chip as a tester. She tells it she wants to converse using the key she's agreed upon with Bob. Then she feeds it random 128-bit LEAF values. On average she'll only have to try 2<sup>15</sup> random numbers before one will wind up with the correct checksum.</p>
<p class="docText">Now that she knows a LEAF value that will be accepted by Bob's chip for the key she's sharing with Bob, she needs a special piece of hardware that takes the output stream from her Clipper device, removes the LEAF values it transmits, and substitutes the one she found. Bob's device won't know there's a problem, and the problem will only be detected when the government attempts to wiretap.</p>
<p class="docText">Matt Blaze's attack is not important in practice, since it would either take a lot of parallel hardware or cause an unacceptable delay in conversation startup, but the discovery was useful in embarrassing the designers for having missed such an &quot;obvious&quot; flaw.</p>
<a name="ch24lev2sec24"></a>
<h4 id="title-IDA5JXQH" class="docSection2Title">24.9.1. Key Escrow</h4>
<p class="docText">The Clipper chip has become synonymous with key escrow in the public debate, and has given key escrow a bad name. But there are good reasons other than keeping Big Brother employed for wanting to back up keys.</p>
<p class="docText">It's certainly important to keep secret the key with which you encrypt your data. It's possible to be really careful about that. It could be that the only copy of your key is on your smart card, and the smart card is carefully engineered so that it is impossible to obtain the key from the smart card. Then one day your three-year-old finds it and flushes it down the toilet. Is it OK with you to accept that all your work is irretrievably gone? Maybe not.</p>
<p class="docText">A similar problem occurs with house keys. When you arrive home during a blizzard, and discover you've lost your key, you really don't want to sit outside until some other member of your family gets home. Typically you've hidden a key under the WELCOME mat (which is equivalent to having a key hung from a chain from the doorknob), or you've given a copy of the key to a neighbor, who hopefully won't break in but will be home when you need the key.</p>
<p class="docText">What can you do with your cryptographic key to ensure you can retrieve the key if you forget or lose the key? You could write it on a piece of paper and stick it in an obscure drawer at home, or you could lock it in your safe deposit box.</p>
<p class="docText">There are various mechanized approaches that don't involve obsolete technology like paper and safe deposit boxes. One possibility is to store your key on some sort of server. If you're paranoid someone will break into that server you could break your key into pieces, like the Clipper proposal does, where all the pieces need to be <img src="U2295.GIF" border="0" />'d in order to recover the key. Then you could store each piece on an independent server.</p>
<p class="docText">Contacting all the servers to give them their pieces of your key might be some trouble. An elegant solution is to take each piece, encrypt it with the public key of the server to which you'd like to give that piece, and store it on your own machine. Then if you lose the key you can give the corresponding quantities to the corresponding servers and recover it.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch24lev1sec8.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch24lev1sec10.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>