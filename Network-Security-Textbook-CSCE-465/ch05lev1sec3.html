<html><head><title>5.3. MD2</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch05lev1sec3"></a>
<h3 id="title-IDAEFUUH" class="docSection1Title">5.3. MD2</h3>
<p class="docText">MD2 takes a message equal to an arbitrary number of octets and produces a 128-bit message digest. It cannot handle a message that is not an integral number of octets, though it would be simple to <a name="iddle1176"></a><a name="iddle1612"></a><a name="iddle1613"></a><a name="iddle1759"></a><a name="iddle1760"></a>modify MD2 (see <a class="docLink" href="ch04lev1sec5.html#ch04qa1q5">Homework Problem 5</a>), or to have a convention for bit-padding a message before feeding it to MD2.</p>
<p class="docText">The basic idea behind MD2 is as follows:</p>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">The input to MD2 is a message whose length is an arbitrary number of octets.</p></div></li><li><div style="font-weight:normal"><p class="docList">The message is padded, according to specified conventions, to be a multiple of 16 octets.</p></div></li><li><div style="font-weight:normal"><p class="docList">A 16-octet quantity, which MD2 calls a <span class="docEmphStrong">checksum</span>, is appended to the end. This checksum is a strange function of the padded message defined specifically for MD2.</p></div></li><li><div style="font-weight:normal"><p class="docList">Final passÂThe message is processed, 16 octets at a time, each time producing an intermediate result for the message digest. Each intermediate value of the message digest depends on the previous intermediate value and the value of the 16 octets of the message being processed.</p></div></li></ol></div>
<p class="docText">Note that we describe the algorithm as if the message is processed three times, first to pad it, next to compute the checksum, and then to compute the actual message digest. However, it is possible to digest a message in a single pass. This is important for machines with limited memory.</p>
<a name="ch05lev2sec5"></a>
<h4 id="title-IDA1HUUH" class="docSection2Title">5.3.1. MD2 Padding</h4>
<p class="docText">The padding function (see <a class="docLink" href="#ch05fig03">Figure 5-3</a>) is very simple. There must always be padding, even if the message starts out being a multiple of 16 octets. If the message starts out being a multiple of 16 octets, 16 octets of padding are added. Otherwise, the number of octets (1Â15) necessary to make the message a multiple of 16 octets is added. Each pad octet specifies the number of octets of padding that was added.</p>
<a name="ch05fig03"></a><p><center>
<h5 class="docFigureTitle">Figure 5-3. MD2 Padded Message</h5>
</center></p><p class="docText">
<img border="0" alt="" width="350" height="74" src="05fig03.jpg" /></p>
<br />
<a name="ch05lev2sec6"></a>
<h4 id="title-IDAJJUUH" class="docSection2Title">5.3.2. MD2 Checksum Computation</h4>
<p class="docText">The checksum is a 16-octet quantity. It is almost like a message digest, but it is not cryptographically secure by itself. The checksum is appended to the message, and then MD2 processes the concatenated quantity to obtain the actual message digest.</p>
<p class="docText"></p><a name="ch05fig04"></a><p><center>
<h5 class="docFigureTitle">Figure 5-4. MD2 Checksum Calculation</h5>
</center></p><p class="docText">
<img border="0" alt="" width="400" height="224" src="05fig04.jpg" /></p>
<br />
<p class="docText"><a name="iddle1614"></a><a name="iddle1810"></a><a name="iddle2047"></a>The checksum starts out initialized to 0. Because of the padding mentioned in the previous section, the message is a multiple of 16 octets, say <span class="docEmphasis">k</span> x 16 octets. The checksum calculation processes the padded message an octet at a time, so the calculation requires <span class="docEmphasis">k</span> x 16 steps. Each step looks at one octet of the message and updates one octet of the checksum. After octet 15 of the checksum is updated, the next step starts again on octet 0 of the checksum. Therefore, each octet of the checksum will have been updated <span class="docEmphasis">k</span> times by the time the checksum computation terminates. At step <span class="docEmphasis">n</span>, octet (<span class="docEmphasis">n</span> mod 16) of the checksum is computed, but for simplicity we'll call it octet <span class="docEmphasis">n</span> of the checksum.</p>
<p class="docText">Octet <span class="docEmphasis">n</span> of the checksum depends on octet <span class="docEmphasis">n</span> of the message, octet <span class="docEmphasis">(n</span>-1) of the checksum, and the previous value of octet <span class="docEmphasis">n</span> of the checksum (what it was updated to be in step <span class="docEmphasis">n</span>-16). (Think of the checksum as &quot;wrapping around&quot;, so if <span class="docEmphasis">n</span> = 0, octet <span class="docEmphasis">n</span>-1 is octet 15.)</p>
<p class="docText">First, octet <span class="docEmphasis">n</span> of the message and octet (<span class="docEmphasis">n</span>-1) of the checksum are <img src="U2295.GIF" border="0" />'d together. This produces an octet having a value between 0 and 255. Then a substitution is done and the result is <img src="U2295.GIF" border="0" />'d into the previous value of octet <span class="docEmphasis">n</span> of the checksum.</p>
<p class="docText">The substitution is specified in <a class="docLink" href="#ch05fig05">Figure 5-5</a>. The first entry is 41, indicating that the value 0 is mapped to 41. The next is 46, indicating that the value 1 is mapped to 46.</p>
<a name="ch05fig05"></a><p><center>
<h5 class="docFigureTitle">Figure 5-5. MD2 &#960; Substitution Table</h5>
</center></p><p class="docText">
<img border="0" alt="" width="350" height="227" src="05fig05.jpg" /></p>
<br />
<p class="docText">The designers of MD2, anxious to display that they had designed no sneaky trapdoors into MD2 by having carefully chosen a particular mapping function, specified that they chose the mapping based on the digits of &#960;. One way that they could base a substitution on the digits of &#960; was to look at the binary representation of &#960; an octet at a time, using the value of that octet as the next substitution value, unless it was already used, in which case they skipped it and went on to the next octet. We checked, and that isn't how they did it. We're willing to just take their word for it that somehow the numbers are based on the digits of &#960;. We wonder whether anyone has ever bothered to verify their claim. We certainly hope none of you waste as much time as we did trying to figure out how the digits of &#960; relate to the substitution. We could have asked the designers, but that seemed like cheating.</p>
<a name="ch05lev2sec7"></a>
<h4 id="title-IDAYNUUH" class="docSection2Title">5.3.3. MD2 Final Pass</h4>
<p class="docText">The final pass of the message digest computation is somewhat similar to the checksum computation. The message with padding and checksum appended is processed in chunks of 16 octets. Each time a new 16-octet chunk of the message is taken, a 48-octet quantity is constructed consisting of the (16-octet) current value of the message digest, the chunk of the message, and the <img src="U2295.GIF" border="0" /> of those two 16-octet quantities. The 48-octet quantity is massaged octet by octet. After 18 passes over the 48-octet quantity, the first 16 octets of the 48-octet quantity are used as the next value of the message digest.</p>
<p class="docText">The message digest is initialized to 16 octets of 0.</p>
<p class="docText">At each stage, the next 16 octets of the message are taken to be processed. A 48-octet quantity is formed by appending the message octets to the current message digest, then appending the <img src="U2295.GIF" border="0" /> of these two 16-octet quantities.</p>
<p class="docText"></p><a name="ch05fig06"></a><p><center>
<h5 class="docFigureTitle">Figure 5-6. MD2 Final Pass</h5>
</center></p><p class="docText">
<img border="0" alt="" width="500" height="372" src="05fig06.jpg" /></p>
<br />
<p class="docText">18 passes are made over the 48-octet quantity, and during a pass each step processes one octet, which means that 18x48 steps are made. It is necessary to know which pass is being made, since the pass number is used in the computation. Both passes and steps are numbered starting at zero. A phantom octet -1 appears before the first octet (octet 0) of the 48-octet quantity.</p>
<p class="docText">At the beginning of pass 0, octet -1 is set to 0. In step <span class="docEmphasis">n</span> of each pass we take octet <span class="docEmphasis">n</span>-1 and run it through the same substitution used for the checksum, then <img src="U2295.GIF" border="0" /> the result into octet <span class="docEmphasis">n</span>. After step 47 of each pass, there is a step 48 which sets octet -1 to the mod 256 sum of octet 47 and the pass number. When we have completed pass 17, the first 16 octets of the 48-octet quantity are used as the value of the message digest for the next stage, and the next 16 octets of the message are processed. (So in pass 17, steps 16 through 48 are useless.)</p>
<p class="docText">After the entire message is processed, the 16 octets that come out of the last stage is the message digest value. The calculation requires only 16 octets (for the checksum) plus 48 octets of volatile memory plus a few indices and makes a single pass over the data. This is ideal for computation in a <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_208">smart card</a></span> (see &sect;<a class="docLink" href="ch10lev1sec8.html#ch10lev1sec8">10.8</a> <span class="docEmphasis">Authentication Tokens</span>).</p>
<a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>