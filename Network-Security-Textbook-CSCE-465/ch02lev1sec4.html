<html><head><title>2.4. Secret Key Cryptography</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="15051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch02lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch02lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch02lev1sec4"></a>
<h3 id="643999-907" class="docSection1Title">2.4. Secret Key Cryptography</h3>
<p class="docText">Secret key cryptography involves the use of a single key. Given a message (called plaintext) and the key, encryption produces unintelligible data (called an <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_109">IRS</a></span> PublicationÂno! no! that was just a finger slip, we meant to say &quot;ciphertext&quot;), which is about the same length as the plaintext was. Decryption is the reverse of encryption, and uses the same key as encryption.</p>
<a name="f047fig01"></a>
<p class="docText">
<img border="0" alt="" id="118095013052" width="250" height="99" src="047equ01.jpg" /></p>
<p class="docText">Secret key cryptography is sometimes referred to as <span class="docEmphStrong">conventional cryptography</span> or <b><a class="docLink" href="app02.html#gloss01_219">symmetric cryptography</a></b>. The Captain Midnight code and the monoalphabetic cipher are both examples of secret key algorithms, though both are easy to break. In this chapter we describe the functionality of cryptographic algorithms, but not the details of particular algorithms. In <a class="docLink" href="ch03.html#ch03">Chapter 3</a> <span class="docEmphasis">Secret Key Cryptography</span> we describe the details of some popular secret key cryptographic algorithms.</p>
<a name="ch02lev2sec7"></a>
<h4 id="title-IDASE1HM" class="docSection2Title">2.4.1. Security Uses of Secret Key Cryptography</h4>
<p class="docText">The next few sections describe the types of things one might do with secret key cryptography.</p>
<a name="ch02lev2sec8"></a>
<h4 id="title-IDABF1HM" class="docSection2Title">2.4.2. Transmitting Over an Insecure Channel</h4>
<p class="docText"><a name="iddle1075"></a><a name="iddle1096"></a><a name="iddle1169"></a><a name="iddle1910"></a><a name="iddle2039"></a>It is often impossible to prevent eavesdropping when transmitting information. For instance, a telephone conversation can be tapped, a letter can be intercepted, and a message transmitted on a LAN can be received by unauthorized stations.</p>
<p class="docText">If you and I agree on a shared secret (a key), then by using secret key cryptography we can send messages to one another on a medium that can be tapped, without worrying about eavesdroppers. All we need to do is have the sender encrypt the messages and the receiver decrypt them using the shared secret. An eavesdropper will only see unintelligible data.</p>
<p class="docText">This is the classic use of cryptography.</p>
<a name="ch02lev2sec9"></a>
<h4 id="title-IDASG1HM" class="docSection2Title">2.4.3. Secure Storage on Insecure Media</h4>
<p class="docText">If I have information I want to preserve but which I want to ensure no one else can look at, I have to be able to store the media where I am sure no one can get it. Between clever thieves and court orders, there are very few places that are truly secure, and none of these is convenient. If I invent a key and encrypt the information using the key, I can store it anywhere and it is safe so long as I can remember the key. Of course, forgetting the key makes the data irrevocably lost, so this must be used with great care.</p>
<a name="ch02lev2sec10"></a>
<h4 id="title-IDA4G1HM" class="docSection2Title">2.4.4. Authentication</h4>
<p class="docText">In spy movies, when two agents who don't know each other must rendezvous, they are each given a password or pass phrase that they can use to recognize one another. This has the problem that anyone overhearing their conversation or initiating one falsely can gain information useful for <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_184">replaying</a></span> later and impersonating the person to whom they are talking.</p>
<p class="docText">The term <b><a class="docLink" href="app02.html#gloss01_216">strong authentication</a></b> means that someone can prove knowledge of a secret without revealing it. Strong authentication is possible with cryptography. Strong authentication is particularly useful when two computers are trying to communicate over an insecure network (since few people can execute cryptographic algorithms in their heads). Suppose Alice and Bob share a key <span class="docEmphasis">K</span><sub>AB</sub> and they want to verify they are speaking to each other. They each pick a random number, which is known as a <b><a class="docLink" href="app02.html#gloss01_038">challenge</a></b>. Alice picks <span class="docEmphasis">r</span><sub>A</sub>. Bob picks <span class="docEmphasis">r</span><sub>B</sub>. The value <span class="docEmphasis">x</span> encrypted with the key <span class="docEmphasis">K</span><sub>AB</sub> is known as the <span class="docEmphStrong">response</span> to the challenge <span class="docEmphasis">x</span>. How Alice and Bob use challenges and responses to authenticate each other is shown in <a class="docLink" href="#ch02fig01">Figure 2-1</a>.</p>
<a name="ch02fig01"></a><p><center>
<h5 class="docFigureTitle">Figure 2-1. ChallengeÂresponse authentication with shared secret</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095013052" width="450" height="101" src="02fig01.jpg" /></p>
<br />
<p class="docText">If someone, say Fred, were impersonating Alice, he could get Bob to encrypt a value for him (though Fred wouldn't be able to tell if the person he was talking to was <span class="docEmphasis">really</span> Bob), but this information would not be useful later in impersonating Bob to the real Alice because the real Alice <a name="iddle1648"></a>would pick a different challenge. If Alice and Bob complete this exchange, they have each proven to the other that they know <span class="docEmphasis">K</span><sub>AB</sub> without revealing it to an impostor or an eavesdropper. Note that in this particular protocol, there is the opportunity for Fred to obtain some &lt;chosen plaintext, ciphertext&gt; pairs, since he can claim to be Bob and ask Alice to encrypt a challenge for him. For this reason, it is essential that challenges be chosen from a large enough space, say 2<sup>64</sup> values, so that there is no significant chance of using the same one twice.</p>
<p class="docText">That is the general idea of a cryptographic authentication algorithm, though this particular algorithm has a subtle problem that would prevent it from being useful in most computer-to-computer cases. (We would have preferred not bringing that up, but felt we needed to say that so as not to alarm people who already know this stuff and who would realize the protocol was not secure. Protocol flaws such as this, and methods of fixing them, are discussed in <a class="docLink" href="ch11.html#ch11">Chapter 11</a> <span class="docEmphasis">Security Handshake Pitfalls</span>.)</p>
<a name="ch02lev2sec11"></a>
<h4 id="title-IDA3K1HM" class="docSection2Title">2.4.5. Integrity Check</h4>
<p class="docText">A secret key scheme can be used to generate a fixed-length <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_060">cryptographic checksum</a></span> associated with a message. This is a rather nonintuitive use of secret key technology.</p>
<p class="docText">What is a checksum? An ordinary (noncryptographic) checksum protects against accidental corruption of a message. The original derivation of the term <i><a class="docLink" href="app02.html#gloss01_040">checksum</a></i> comes from the operation of breaking a message into fixed-length blocks (for instance, 32-bit words) and adding them up. The sum is sent along with the message. The receiver similarly breaks up the message, repeats the addition, and <i><a class="docLink" href="app02.html#gloss01_040">checks the sum</a></i>. If the message had been garbled en route, the sum will not match the sum sent and the message is rejected, unless, of course, there were two or more errors in the transmission that canceled one another. It turns out this is not terribly unlikely, given that if flaky hardware turns a bit off somewhere, it is likely to turn a corresponding bit on somewhere else. To protect against such &quot;regular&quot; flaws in hardware, more complex checksums called CRCs were devised. But these still only protect against faulty hardware and not an intelligent attacker. Since <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_055">CRC</a></span> algorithms are published, an attacker who wanted to change a message could do so, compute the CRC on the new message, and send that along.</p>
<p class="docText"><a name="iddle1872"></a>To provide protection against malicious changes to a message, a <span class="docEmphasis">secret</span> checksum algorithm is required, such that an attacker not knowing the algorithm can't compute the right checksum for the message to be accepted as authentic. As with encryption algorithms, it's better to have a common (known) algorithm and a secret key. This is what a cryptographic checksum does. Given a key and a message, the algorithm produces a fixed-length <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_129">message authentication code (MAC)</a></span> that can be sent with the message. A MAC is often called a MIC (message integrity code). We prefer the term MIC, and MIC is used in standards such as PEM (see <a class="docLink" href="ch21.html#ch21">Chapter 21</a> <span class="docEmphasis">PEM &amp; S/MIME</span>), but the term MAC seems to have become more popular.</p>
<p class="docText">If anyone were to modify the message, and they didn't know the key, they would have to guess a MAC and the chance of getting it right depends on the length. A typical MAC is at least 48 bits long, so the chance of getting away with a forged message is only one in 280 trillion (or about the chance of going to Las Vegas with a dime and letting it ride on red at the roulette table until you have enough to pay off the U.S. national debt).</p>
<p class="docText">Such message integrity codes have been in use to protect the integrity of large interbank electronic funds transfers for quite some time. The messages are not kept secret from an eavesdropper, but their integrity is ensured.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="15051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch02lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch02lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>