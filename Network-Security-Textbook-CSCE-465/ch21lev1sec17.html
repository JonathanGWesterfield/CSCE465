<html><head><title>21.17. Differences in S/MIME</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch21lev1sec16.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch21lev1sec18.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch21lev1sec17"></a>
<h3 id="title-IDAGHG2H" class="docSection1Title">21.17. Differences in S/MIME</h3>
<p class="docText">MIME specifies how to encode non-text data and type labels into what will look like a text message to intermediate mailers. Like PEM, it had to deal with overly helpful mail transfer agents and defined its own 6-bits-per-byte encoding, so S/MIME doesn't have to. S/MIME says that its encrypted blobs are binary data and MIME takes care of encoding them. But S/MIME still has some encoding issues to deal with. As with PEM, signed messages can be in one of two forms: clear-signed and encoded. Clear signed messages can be read by mail readers that don't understand S/MIME (they notice the signature as a part of the message they don't know how to process and they ignore it). MIME itself was designed so that mailers that don't understand MIME will display text messages so that users will be able to find the message amid a substantial amount of cybercrud. That makes it possible for a user with an old mailer to make sense of an S/MIME signed message if they are sufficiently determined.</p>
<a name="ch21list05"></a><h5 id="title-IDAXHG2H" class="docExampleTitle"></h5><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>



90
<pre><span class="docEmphStrong">From: Alice</span>
<span class="docEmphStrong">To: Bob</span>
<span class="docEmphStrong">Subject: Keep this proposition private!</span>
<span class="docEmphStrong">MIME-Version: 1.0</span>
<span class="docEmphStrong">Date: Sun, 20 Jan 2002 15:38:21 -0500</span>
<span class="docEmphStrong">Content-Type: multipart/signed;</span>
 <span class="docEmphStrong">protocol="application/pkcs7-signature";</span>
 <span class="docEmphStrong">micalg=sha1;</span>
 <span class="docEmphStrong">boundary=-------boundarymarker</span>

<span class="docEmphStrong">---------boundarymarker</span>
<span class="docEmphStrong">Content-Type: text/plain; charset="US-ASCII"</span>

<span class="docEmphStrong">Care to meet me at my apartment tonight?</span>

<span class="docEmphStrong">---------boundarymarker</span>
<span class="docEmphStrong">Content-Type: application/pkcs7-signature; name="smime.p7s"</span>
<span class="docEmphStrong">Content-Transfer-Encoding: base64</span>
<span class="docEmphStrong">Content-Disposition: attachment; filename="smime.p7s"</span>
<span class="docEmphStrong">Content-Description: S/MIME Cryptographic Signature</span>

<span class="docEmphStrong">MIAGCSqGSIb3DQEHAqCAMIIIlgIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBoIIG7jCCAX4w</span>
<span class="docEmphStrong">ggEooAMCAQICBDY+EqcwDQYJKoZIhvcNAQEEBQAwRjELMAkGA1UEBhMCVVMxDTALBgNVBAgTBE1B</span>
<span class="docEmphStrong">U1MxDTALBgNVBAoTBElyaXMxGTAXBgNVBAMTEElyaXMgSW50ZXJuZXQgQ0EwHhcNOTgxMTAyMDgx</span>
<span class="docEmphStrong">NDAwWhcNMDgxMDMwMDgxNDAwWjBGMQswCQYDVQQGEwJVUzENMAsGA1UECBMETUFTUzENMAsGA1UE</span>
<span class="docEmphStrong">ChMESXJpczEZMBcGA1UEAxMQSXJpcyBJbnRlcm5ldCBDQTBcMA0GCSqGSIb3DQEBAQUAA0sAMEgC</span>
     <span class="docEmphStrong">-----30 more lines like this deleted from this example-----</span>
<span class="docEmphStrong">AQkFMQ8XDTAyMDEyMDIwMzgyMVowIwYJKoZIhvcNAQkEMRYEFMfSZKBY4a55CM7L1rg+sk3TRlM2</span>
<span class="docEmphStrong">MEMGCSqGSIb3DQEJDzE2MDQwBwYFKw4DAh0wDgYIKoZIhvcNAwICAgCAMAoGCCqGSIb3DQMHMA0G</span>
<span class="docEmphStrong">CCqGSIb3DQMCAgEoMA0GCSqGSIb3DQEBAQUABE8DVCKj7dYs0Uho2cY/o4VFDe6wUBdBC3R1bhK5</span>
<span class="docEmphStrong">FnUKIrJLUC3QnBQgm70tWQvL5vK9IGyqvZfovPnDUI/2zd0nS9JHnyjqo2pEVvE0uzb0AAAAAA==</span>
<span class="docEmphStrong">---------boundarymarker</span></pre><br />
</td></tr></table></p>
<p class="docText">MIME includes text canonicalization rules that increase the chances that the message will arrive unmodified, but it is still somewhat safer to send messages in an encoded format. The encoded format has an additional advantage. If the recipient has a mailer that does not understand S/MIME, the encoded format will appear to it as an empty message with a file attachment with the name smime.p7m. If the mailer is configured to process file attachments with external utilities based on the file name suffix, it can be set up to hand off the smime.p7m file to an S/MIME program without any special configuration in the mailer.</p>
<p class="docText">S/MIME defines two new data formats for MIME to encode: application/pkcs7-signature, and application/pkcs7-mime. Type application/pkcs7-signature holds &quot;detached&quot; signatures within a multipart/signed structure. The format application/pkcs7-mime is used for both encrypted messages and encoded signed messages. Because MIME includes recursive encapsulation of messages as a natural thing to do, S/MIME does not have a concept of a message that is signed and encrypted as a single operation. Instead, S/MIME will sign a message yielding a signed message, and then encrypt the result. A minor security advantage gained with this approach is that the identity of the signer, and even the fact that the message is signed, is invisible to anyone who does not have a key to decrypt the message. This does make life difficult for mailers that would like to display message status (encrypted?, signed?, already read?, sender, ...) in a summary screen before opening individual messages. The S/MIME specification explicitly allows a sender to encrypt a message and then sign the result, or even sign the message, encrypt the result, and then sign the encrypted version again. Each variation has subtly different security properties, but none are actually used.</p>
<p class="docText">S/MIME defines a large set of header fields for both encrypted and signed messages. Since more years have passed since the time of the PEM design, ever larger numbers of options have been specified. Examples include being able to indicate in the header of a signed message what cryptographic algorithms the sender of the message supports, and which public key (possibly of many) she would like the recipient to use when responding. This evolved from the fact that such information is not encoded in certificates, and the common certificate distribution technique of sending out signed messages in order that the recipient can reply with an encrypted one.</p>
<p class="docText">Unlike PEM, which encoded its header fields individually with human readable text labels, S/MIME encodes its header information and data using ASN.1. Thus in the box on page 562, the signature field contains sender certificates and other such information, but it's not readily apparent. The encoding is specified in RFC2630: Cryptographic Message Syntax.</p>
<p class="docText">Issues around mailing list exploders for S/MIME messages are the same as those for PEM messages, except that examples are harder to look at. A remailer can simply forward signed messages. To forward encrypted messages, it would have to decrypt the message header and then reen-crypt it for each recipient. The layering of encryption over signatures makes it even more straightforward to do this without invalidating the signature.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch21lev1sec16.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch21lev1sec18.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>