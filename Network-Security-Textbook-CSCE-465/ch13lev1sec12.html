<html><head><title>13.12. Message Formats</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch13lev1sec11.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch13lev1sec13.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch13lev1sec12"></a>
<h3 id="title-IDATIEFL" class="docSection1Title">13.12. Message Formats</h3>
<p class="docText"><a name="iddle1068"></a><a name="iddle1237"></a><a name="iddle1273"></a><a name="iddle1460"></a><a name="iddle1563"></a><a name="iddle1890"></a><a name="iddle1896"></a><a name="iddle2081"></a>In this section we'll go through the Kerberos V4 message formats. In all of the messages, we assume that Alice wants to talk to Bob. In Kerberos documentation Alice is sometimes referred to as the <i><a class="docLink" href="app02.html#gloss01_045">client</a></i> and Bob as the <i><a class="docLink" href="app02.html#gloss01_202">server</a></i>. We find that terminology confusing since both Alice and Bob are clients of the Kerberos system, and principals like file servers can indeed act in the role of client in terms of a Kerberos authentication. Therefore we will not use that terminology and will instead use <span class="docEmphasis">Alice</span> for the initiator of an authentication and <span class="docEmphasis">Bob</span> for the entity with which Alice would like to communicate, and the pronouns <span class="docEmphasis">she</span> for <span class="docEmphasis">Alice</span> and <span class="docEmphasis">he</span> for <span class="docEmphasis">Bob</span>.</p>
<p class="docText">Fields that appear in packets:</p>
<ul><li><p class="docList"><span class="docEmphSmaller">NAME/INSTANCE/REALM</span> of Alice or BobÂvariable-length null-terminated character strings.</p></li><li><p class="docList"><span class="docEmphSmaller">TIMESTAMP</span>Âa four-octet value representing the number of seconds since 00:00:00 GMT, 1 January, 1970. This is a common representation of time in UNIX-based systems. If treated as a signed integer, it can represent times between 1902 and 2038. If treated as an unsigned integer, it can represent times between 1970 and 2106. In Kerberos, some of the messages in which timestamps appear use the most significant bit as the D <span class="docEmphSmaller">BIT</span> (see below); in other messages, the most significant bit is set to zero. Therefore, Kerberos V4 effectively expires in 2038. (It's hoped that most people will have converted to V5 by thenÂor is that V19?). Kerberos V5 will not expire until December 31, 9999 (at least the timestamps will last till then).</p></li><li><p class="docList">D <span class="docEmphSmaller">BIT, DIRECTION BIT</span>ÂThe purpose of this flag is to prevent an intruder from mirroring a message back to the sender (called a reflection attack) and having the sender accept it as a response. An asymmetry is created between the two ends of a conversation based on IP address. When the packet is traveling from the higher IP address to the lower IP address, the D <span class="docEmphSmaller">BIT</span> is set to 1. When the packet is traveling between two processes in a single node (so that both ends of the conversation have the same IP address), the TCP port number is used as a tie-breaker. By checking the D <span class="docEmphSmaller">BIT</span>, the receiver of a message can be assured that the message was generated by the other end of the connection. In the actual layout of the data, the D <span class="docEmphSmaller">BIT</span> is stolen from the high-order bit of the <span class="docEmphSmaller">TIMESTAMP</span>. Note that this is a dependency on IP, though one that could be adapted to most communication protocols.</p></li><li><p class="docList"><span class="docEmphSmaller">LIFETIME</span>Âa one octet field, specified in units of 5 minutes. Therefore the maximum lifetime that can be expressed is a little over 21 hours. This limit has been seen as a major shortcoming of Kerberos V4, since it prevents giving tickets to long-running batch jobs.</p></li><li><p class="docList">5-<span class="docEmphSmaller">MILLISECOND TIMESTAMP</span>ÂThis field extends the <span class="docEmphSmaller">TIMESTAMP</span> field to give time granularity down to 5 milliseconds instead of 1 second. Its purpose is to allow more than one authenticator to the same service to be generated in a single second without having it rejected as a duplicate. <a name="iddle1112"></a><a name="iddle1119"></a><a name="iddle1131"></a><a name="iddle1547"></a><a name="iddle1565"></a><a name="iddle1688"></a><a name="iddle1762"></a><a name="iddle1984"></a>Actual time accuracy at that granularity is never needed. An acceptable implementation of this field would be a sequence number within the second.</p></li><li><p class="docList"><span class="docEmphSmaller">PADDING</span>Âa field containing between zero and seven octets added to the end of any message that will be encrypted to ensure that the value to be encrypted is a multiple of eight octets.</p></li><li><p class="docList"><span class="docEmphSmaller">NETWORK LAYER ADDRESS</span>Âa four-octet quantity which is an IPv4 address.</p></li><li><p class="docList"><span class="docEmphSmaller">SESSION KEY</span>Âan eight-octet quantity which is used as a DES key.</p></li><li><p class="docList"><span class="docEmphSmaller">KEY VERSION NUMBER</span>Âa one-octet quantity (see &sect;<a class="docLink" href="ch13lev1sec8.html#ch13lev1sec8">13.8</a> <span class="docEmphasis">Key Version Numbers</span>).</p></li><li><p class="docList"><span class="docEmphSmaller">KERBEROS VERSION NUMBER</span>Âa one-octet quantity equal to the constant <span class="docEmphRomanAlt">4</span>.</p></li><li><p class="docList"><span class="docEmphSmaller">MESSAGE TYPE</span>Âa one-octet quantity, with the low-order bit stolen for the B <span class="docEmphSmaller">BIT</span> (see next item). The high-order seven bits indicate one of the following message types:</p><ul><li><p class="docList"><span class="docEmphRomanAlt">AS_REQ</span>ÂUsed when asking for the initial TGT.</p></li><li><p class="docList"><span class="docEmphRomanAlt">AS_REPLY</span> (also <span class="docEmphRomanAlt">TGS_REP</span>)ÂUsed to return a ticket, either a TGT or a ticket to some other principal.</p></li><li><p class="docList"><span class="docEmphRomanAlt">AP_REQ</span> (also <span class="docEmphRomanAlt">TGS_REQ</span>)ÂUsed to talk to another principal (or the TGS) using a ticket (or a TGT).</p></li><li><p class="docList"><span class="docEmphRomanAlt">AP_REQ_MUTUAL</span>ÂThis was intended to be used to talk to another principal and request mutual authentication. In fact, it is never used; instead, applications know whether mutual authentication is expected.</p></li><li><p class="docList"><span class="docEmphRomanAlt">AS_ERR</span>ÂUsed for the KDC to report why it can't return a ticket or TGT in response to <span class="docEmphRomanAlt">AS_REQ</span> or <span class="docEmphRomanAlt">TGS_REQ</span>.</p></li><li><p class="docList"><span class="docEmphRomanAlt">PRIV</span>ÂThis is a message that carries encrypted integrity-protected application data.</p></li><li><p class="docList"><span class="docEmphRomanAlt">SAFE</span>ÂThis is a message that carries integrity-protected application data.</p></li><li><p class="docList"><span class="docEmphRomanAlt">AP_ERR</span>ÂUsed by an application to report why authentication failed.</p></li></ul></li></ul>
<p class="docText">Note: the names of the message types above do not match the names used in either the Kerberos V4 documentation or code. Because there was no consistent pattern, we used the names for the equivalent functions from Kerberos V5.</p>
<ul><li><p class="docList">B <span class="docEmphSmaller">BIT, BYTE-ORDER FLAG</span>ÂThis bit indicates whether fields holding four-octet integers have them in <b><a class="docLink" href="app02.html#gloss01_019">big-endian</a></b> (most significant octet first) or <b><a class="docLink" href="app02.html#gloss01_121">little-endian</a></b> (least significant octet first) order. Different machines have different native internal formats. Most protocols define a <span class="docEmphStrong">network byte order</span> and force machines with a different native format to <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_025">byte-swap</a></span> whenever they send or receive integers. By use of this flag, Kerberos allows either order in transmitted packets, so in the common case where the native formats on the communicating machines are <a name="iddle2074"></a>the same, no byte-swapping is necessary. This approach trades complexity for performance. If B <span class="docEmphSmaller">BIT</span> = <span class="docEmphRomanAlt">1</span>, it means the least significant octet is in the lowest address in a multi-octet field. This is convenient for little-endian machines; big-endian machines like to put the most significant octet in the lowest address and are most happy with B <span class="docEmphSmaller">BIT</span> = <span class="docEmphRomanAlt">0</span>.</p></li></ul>
<p class="docText">The following three data structures are never actually free-standing messages, but are instead pieces of information included in other messages. They are tickets, authenticators, and credentials.</p>
<a name="ch13lev2sec3"></a>
<h4 id="title-IDAXVEFL" class="docSection2Title">13.12.1. Tickets</h4>
<p class="docText">A ticket for Bob is an encrypted piece of information that is given to principal Alice by the KDC and stored by Alice. It is encrypted by the KDC with Bob's master key. Alice cannot read what is inside, but she sends it to Bob who can decrypt it and thereby authenticate her.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="100"></col><col width="300"></col><col width="50"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText">#octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="left" valign="top">&nbsp;</td><td class="rightBorder bottomBorder" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's Network Layer address</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">8</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">session key for Alice</span><img src="U2194.GIF" border="0" /><span class="docEmphRomanAlt">Bob</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">ticket lifetime, units of 5 minutes</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">KDC's timestamp when ticket made</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Bob's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Bob's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" /> 7</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">pad of</span> 0<span class="docEmphRomanAlt">s to make ticket length multiple of eight octets</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr></table></p><br />
<p class="docText">Now some comments about the fields which are not self-explanatory.</p>
<ul><li><p class="docList">B <span class="docEmphSmaller">BIT, BYTE-ORDER FLAG</span>ÂLSB in a one-octet field, with the other bits unused.</p></li><li><p class="docList">A<span class="docEmphSmaller">LICE'S</span> N<span class="docEmphSmaller">ETWORK</span> L<span class="docEmphSmaller">AYER ADDRESS</span>Âfour octets. Note that the field is fixed-length and four octets. Kerberos was designed to run in the network using the TCP/IP protocol suite. This fixed-length field means that this version of Kerberos cannot be used in a network with longer addresses.</p></li><li><p class="docList"><span class="docEmphSmaller">TICKET LIFETIME</span>. The units are 5 minutes, so the maximum ticket lifetime is a little over 21 hours.</p></li><li><p class="docList">T<span class="docEmphSmaller">IMESTAMP</span>Âfour octets. Time when ticket was created (the number of seconds since 00:00:00 GMT, 1 January, 1970).</p></li><li><p class="docList"><a name="iddle1109"></a>B<span class="docEmphSmaller">OB</span>'<span class="docEmphSmaller">S NAME</span> and <span class="docEmphSmaller">INSTANCE</span>. Including Bob's name and instance is of dubious value. There are two possible reasons for inclusion of this field in the ticket. One reason is that the field supports a node where several services share a key. If someone were to get a ticket to the gameplaying service on node <span class="docEmphRomanAlt">DoD</span>, and that service used the same key as the nuclear-missile-launching service on the same node (it happened in <span class="docEmphasis">War Games</span>, right?), then having the name of the service in the ticket makes it impossible to use the ticket for the wrong service. For instance, suppose only once in a while (hopefully) does anyone ever use the nuclear-missile-launching service, but people often use the gameplaying service. Good guy <span class="docEmphasis">A</span> has rights to both services, and often uses the gameplaying service. One day bad guy <span class="docEmphasis">C</span> intercepts the ticket and authenticator that <span class="docEmphasis">A</span> was attempting to use to get to the gameplaying service, and then <span class="docEmphasis">C</span> quickly (within the clock skew) impersonates <span class="docEmphasis">A</span>'s network layer address, substitutes as the destination socket number the nuclear-missile-launching service, and starts World War III. You wouldn't want <span class="docEmphasis">that</span> to happen now, would you?</p><p class="docList">The other dubious purpose for this field is so that Kerberos can tell that the ticket decrypts properly. Kerberos V4 uses PCBC (see &sect;<a class="docLink" href="ch13lev1sec9.html#ch13lev1sec9">13.9</a> <span class="docEmphasis">Encryption for Privacy and Integrity</span>), and therefore assumes that any tampering with the data would result in the final block not decrypting properly. Since the final blocks include Bob's name and instance, Bob will be able to recognize if they are correct. (This is not a strong reason for the field because, even if PCBC worked as hoped, there is no value to be gained from tampering with a ticket and turning the information inside to garbage. User data is a different matter, however, and the PCBC check is more valuable there.)</p></li></ul>
<a name="ch13lev2sec4"></a>
<h4 id="title-IDA1DFFL" class="docSection2Title">13.12.2. Authenticators</h4>
<p class="docText">The authenticator is a piece of information included in a message at the start of a communication attempt between Alice and Bob which enables Alice and Bob to prove to each other that they are who they claim to be. It is encrypted with the session key Alice requested from the KDC for conversing with Bob. We will assume in the following that Alice is sending the authenticator to Bob.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="50"></col><col width="400"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Alice's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Alice's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Alice's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">checksum</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">5-millisecond timestamp</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">timestamp</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" /> 7</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">pad of</span> 0<span class="docEmphRomanAlt">s to make authenticator multiple of eight octets</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr></table></p><br />
<ul><li><p class="docList"><a name="iddle1215"></a>A<span class="docEmphSmaller">LICE'S NAME/INSTANCE/REALM</span>. The presence of these fields avoids an extremely obscure threat. Without these fields, if two principals have the same master key, then an attacker who could intercept messages between one of them and the KDC could change the <span class="docEmphRomanAlt">AS_REQ</span> to have the other principal's name. The returned ticket would then be for the other principal, so that when this principal used the ticket to Bob, Bob would believe it to be the other principal. Now you know.</p></li><li><p class="docList">C<span class="docEmphSmaller">HECKSUM</span>Âfour octets. This field can be used in an application-specific way. None of the applications that have been <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_115">Kerberized</a></span> use this field in a way in which the name <i><a class="docLink" href="app02.html#gloss01_040">checksum</a></i> makes sense. Many applications set this field to Alice's process id. The application that copies the KDC database to KDC replicas sets this field to the size of the KDC database. The sample application provided to help implementers build a Kerberized application suggests having the user type in a value for that field.</p></li><li><p class="docList">5-<span class="docEmphSmaller">MILLISECOND TIMESTAMP</span>. This field extends the <span class="docEmphSmaller">TIMESTAMP</span> field to give time granularity down to 5 milliseconds instead of 1 second. Its purpose is to allow more than one authenticator to the same service to be generated in a single second without having it rejected as a duplicate. The simplest implementation of this field would actually be a sequence number within the second (in which case the name is misleading, since it has nothing to do with the unit of time of 5 milliseconds).</p></li><li><p class="docList"><span class="docEmphSmaller">TIMESTAMP</span>Âfour octets, time in seconds. This is really the main information in the authenticator. Bob decrypts the authenticator, verifies that the time is acceptably close to current, and, if mutual authentication is used, increments this field, encrypts the result, and sends it back to Alice. Because only Bob (or Alice) is able to encrypt the incremented value, when Alice verifies the response she knows that the authenticator arrived at Bob.</p></li></ul>
<a name="ch13lev2sec5"></a>
<h4 id="title-IDAANFFL" class="docSection2Title">13.12.3. Credentials</h4>
<p class="docText">The <span class="docEmphSmaller">CREDENTIALS</span> field in a message is encrypted. When returned in an <span class="docEmphRomanAlt">AS_REP</span> (the message that returns a ticket-granting ticket), it is encrypted in Alice's master key. When returned in a <span class="docEmphRomanAlt">TGS_REP</span> (the message which requests a ticket to another principal, from the Ticket-Granting Server), it is encrypted with Alice's session key.</p>
<p class="docText">Again, we're assuming Alice has requested to talk to Bob.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="50"></col><col width="400"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">8</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">session key for Alice</span><img src="U2194.GIF" border="0" /><span class="docEmphRomanAlt">Bob</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Bob's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Bob's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Bob's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">ticket lifetime</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">Bob's key version number</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">length of ticket</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">ticket</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">timestamp</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" /> 7</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">pad of</span> 0<span class="docEmphRomanAlt">s</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr></table></p><br />
<ul><li><p class="docList"><span class="docEmphSmaller">SESSION KEY</span>Âeight octets. In an <span class="docEmphRomanAlt">AS_REP</span>, this gives the login session key for Alice. In a <span class="docEmphRomanAlt">TGS_REP</span>, this gives the key to be used when Alice communicates with Bob.</p></li><li><p class="docList">B<span class="docEmphSmaller">OB'S NAME/INSTANCE/REALM</span>. These fields identify the ticket target. Since Alice sends the ticket request unprotected, the presence of these fields assures Alice that the ticket is for whom she thinks it is for.</p></li><li><p class="docList"><span class="docEmphSmaller">TICKET LIFETIME</span>Âone octet. Number of 5-minute intervals from the time in <span class="docEmphSmaller">TIMESTAMP</span> during which the ticket should be valid.</p></li><li><p class="docList"><span class="docEmphSmaller">KEY VERSION NUMBER</span>. This field allows Bob to change his key in a way that won't disrupt principals that are currently talking to Bob or holding tickets for Bob. Bob must keep track of his old keys for 21 hours after he reports the new key to the KDC (or somewhat longer to allow for propagation to slave KDCs). All such <span class="docEmphStrong">active</span> keys for Bob should have unique key version numbers. When a ticket arrives, Bob can use the key version number in the unencrypted header to decide which key to use to decrypt it. 21 hours after Bob reports a new key, any issued tickets encrypted under older keys will have expired and Bob can safely forget the older keys.</p></li><li><p class="docList"><span class="docEmphSmaller">TIMESTAMP</span>Âfour octets. Time when ticket generated.</p></li></ul>
<a name="ch13lev2sec6"></a>
<h4 id="title-IDAWYFFL" class="docSection2Title">13.12.4. AS_REQ</h4>
<p class="docText">This message is used to ask for a ticket (when one doesn't already have a TGT). It is almost always used to ask for a TGT, which is a ticket to the Ticket-Granting Service. Theoretically it could be used to ask for a ticket to any service, using the requester's master key.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="100"></col><col width="300"></col><col width="50"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText"></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>1<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText"></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's timestamp</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText"></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">desired ticket lifetime</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText"></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">service's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">service's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr></table></p><br />
<ul><li><p class="docList"><span class="docEmphSmaller">MESSAGE TYPE</span>. <span class="docEmphRomanAlt">AS_REQ</span> (1).</p></li><li><p class="docList">B <span class="docEmphSmaller">BIT, BYTE-ORDER FLAG</span>.</p></li><li><p class="docList">A<span class="docEmphSmaller">LICE'S TIMESTAMP</span>. This field is here in order to help Alice match up requests with replies.</p></li><li><p class="docList"><span class="docEmphSmaller">DESIRED TICKET LIFETIME</span>Âone octet. In units of 5 minutes, how long the requester would like the issued ticket to be good for. This was a mistake in the designÂthe upper bound (about 21 hours) is not long enough for some applications.</p></li><li><p class="docList"><span class="docEmphSmaller">SERVICE'S NAME</span>. For the normal case of a request for a ticket to the Ticket-Granting Service, the name will be the constant <span class="docEmphRomanAlt">krbtgt</span>.</p></li><li><p class="docList"><span class="docEmphSmaller">SERVICE'S INSTANCE</span>. For the normal case of a request for a ticket to the Ticket-Granting Service, the instance will be the realm name.</p></li></ul>
<a name="ch13lev2sec7"></a>
<h4 id="title-IDALEARG" class="docSection2Title">13.12.5. TGS_REQ</h4>
<p class="docText">The TGS_REQ is used by Alice to request a ticket to Bob from the TGS. In order to do this, Alice needs to send the TGS the TGT (so that the TGS can know the proper session key for Alice), and an authenticator. It turns out sending an authenticator in a TGS_REQ has no security value, but it is necessary in an AP_REQ, and therefore it is in the TGS_REQ to make the two protocols similar.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="100"></col><col width="300"></col><col width="50"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>3<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">KDC's key version number</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">KDC's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">length of ticket-granting ticket</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">length of authenticator</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">ticket-granting ticket (TGT)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">authenticator</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's timestamp</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">desired ticket lifetime</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Bob's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Bob's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr></table></p><br />
<ul><li><p class="docList"><span class="docEmphSmaller">MESSAGE TYPE</span>. <span class="docEmphRomanAlt">AP_REQ</span> (3).</p></li><li><p class="docList">KDC'S <span class="docEmphSmaller">KEY VERSION NUMBER</span>. Copied from B<span class="docEmphSmaller">OB'S KEY VERSION NUMBER</span> in the credentials which Alice obtained in the <span class="docEmphRomanAlt">KRB_TGS_REP</span> she received when she asked for a TGT.</p></li><li><p class="docList">KDC'S <span class="docEmphSmaller">REALM</span>. This field is here so that the KDC, in interrealm authentication, will know which key to use to decrypt the ticket. Suppose the KDC in realm <span class="docEmphasis">B</span> is registered in many different realms. The KDC in <span class="docEmphasis">B</span> will have a different key for each realm in which it is registered. For example, if realm <span class="docEmphasis">B</span> can talk to realm <span class="docEmphasis">A</span>, then <span class="docEmphasis">B</span> will have a master key stored at realm <span class="docEmphasis">A</span>'s KDC. If <span class="docEmphasis">B</span> can also talk to realm <span class="docEmphasis">C</span>, then <span class="docEmphasis">B</span> will have a different master key stored at realm <span class="docEmphasis">C</span>'s KDC. When Alice, in realm <span class="docEmphasis">A</span>, gets a ticket to the KDC in <span class="docEmphasis">B</span>, and then asks <span class="docEmphasis">B</span> for a ticket to a principal in <span class="docEmphasis">B</span>'s realm, it is necessary to inform <span class="docEmphasis">B</span> which key it should use to decrypt the ticket (in this case, the one it shares with the KDC in realm <span class="docEmphasis">A</span>).</p></li></ul>
<a name="ch13lev2sec8"></a>
<h4 id="title-IDAOKBRG" class="docSection2Title">13.12.6. AS_REP and TGS_REP</h4>
<p class="docText">This message is the reply to an <span class="docEmphRomanAlt">AS_REQ</span> or a <span class="docEmphRomanAlt">TGS_REQ</span>. It's really a single message type (2), but it can occur in response to two different sorts of request.</p>
<p class="docText">In the following fields, we'll assume the reply is in response to a request from Alice to get a ticket for Bob.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="100"></col><col width="300"></col><col width="50"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>2<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's timestamp</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">number of tickets (</span>1<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">ticket expiration time</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's key version number</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">2</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">credentials length</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">credentials</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr></table></p><br />
<ul><li><p class="docList"><span class="docEmphSmaller">MESSAGE TYPE</span>. <span class="docEmphRomanAlt">AS_REP</span> (2).</p></li><li><p class="docList">A<span class="docEmphSmaller">LICE'S NAME/INSTANCE/REALM</span>. Useful in case there are multiple principals on the same node. If a response comes back, the service might not be able to know to which principal the credentials belongs without that field there. Given that the field is not encrypted, it has no security value. It is just there to prevent nonmalicious confusion. The MIT implementation ignores these fields.</p></li><li><p class="docList">A<span class="docEmphSmaller">LICE'S TIMESTAMP</span>. As sent in request (this is to match requests and replies).</p></li><li><p class="docList"><span class="docEmphSmaller">NUMBER OF TICKETS</span>Âone octet. Ignored by Kerberos Version 4. In earlier versions of Kerberos, it was possible to request multiple tickets in a single request. Because this feature was never used and complicated the message formats, it was simplified out of V4. This field remains for backwards compatibility.</p></li><li><p class="docList"><span class="docEmphSmaller">TICKET EXPIRATION TIME</span>Âfour octets.</p></li><li><p class="docList"><span class="docEmphSmaller">ALICE'S KEY VERSION</span>Âone octet. Unused if this message is in response to a <span class="docEmphRomanAlt">TGS_REQ</span>.</p></li><li><p class="docList"><span class="docEmphSmaller">CREDENTIALS LENGTH</span>Âtwo octets.</p></li><li><p class="docList"><span class="docEmphSmaller">CREDENTIALS</span>.</p></li></ul>
<a name="ch13lev2sec9"></a>
<h4 id="title-IDAKYBRG" class="docSection2Title">13.12.7. Error Reply from KDC</h4>
<p class="docText"><a name="iddle1342"></a>This message is in response to an <span class="docEmphRomanAlt">AS_REQ</span> or a <span class="docEmphRomanAlt">TGS_REQ</span>, if the KDC fails to reply with a ticket. Again, assume this is in response to principal Alice requesting a ticket for principal Bob.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="100"></col><col width="300"></col><col width="50"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>32<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's name</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's instance</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Alice's timestamp</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">error code</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">error text / additional explanation of error</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr></table></p><br />
<p class="docText">The defined values for error code are:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="10"></col><col width="10"></col><col width="530"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Alice's database entry at the KDC expired. (Note: Kerberos allows database entries to expire. There is an expiration date on each entry.)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Bob's database entry expired.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">3</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">authenticator on the request expired.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">4</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">wrong protocol version number.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">7</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">byte order unknown. (C'monÂit's a bit! How can you not know the two values of a bit?!Âand we left out errors 5 and 6 because they were even sillier, and they also were never invoked in the code, so they are irrelevant.)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">8</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Alice or Bob not found in database.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">9</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Alice or Bob found in multiple places in the database (though it seems like it would be more sensible to generate an error when adding a duplicate rather than checking for it on every read).</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">10</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Alice or Bob found, but no key is in the database.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">20</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Generic error from KDC.</p></td></tr></table></p><br />
<a name="ch13lev2sec10"></a>
<h4 id="title-IDA3GCRG" class="docSection2Title">13.12.8. AP_REQ</h4>
<p class="docText">This message is sent from Alice to Bob early in their conversation in order to authenticate. Exactly how this message is passed within the application protocol is not defined by Kerberos. The receiving end must be able to figure out that this is a Kerberos message and pass it to its own Kerberos subroutines.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="50"></col><col width="350"></col><col width="25"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>8<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Bob's key version number</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">Bob's realm</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">length of ticket</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">length of authenticator</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="left" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">ticket</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="left" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">authenticator</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr></table></p><br />
<ul><li><p class="docList">B<span class="docEmphSmaller">OB'S REALM</span>. This is in case Bob is registered in different realms, with different keys in each one. This field enables Bob to choose the proper key to use to decrypt the ticket.</p></li></ul>
<a name="ch13lev2sec11"></a>
<h4 id="title-IDACQCRG" class="docSection2Title">13.12.9. AP_REP</h4>
<p class="docText">The Kerberos documentation does not define an explicit reply from Bob when Alice sends an <span class="docEmphRomanAlt">AP_REQ</span>. However, the library routines include subroutine <span class="docEmphRomanAlt">krb_sendauth</span>, used by Alice, and <span class="docEmphRomanAlt">krb_recvauth</span>, used by Bob, which most applications use. If all that is necessary is for Bob to authenticate Alice, then there is no necessity for a Kerberos reply from Bob. The application just starts conversing.</p>
<p class="docText">If mutual authentication is desired, then Bob needs to send information to Alice that will prove that Bob has decrypted the ticket and therefore knows the session key. The Kerberos routine <span class="docEmphRomanAlt">krb_recvauth</span> accomplishes this by having Bob extract the value of the <span class="docEmphSmaller">CHECKSUM</span> field and increment it.</p>
<p class="docText">The message format of the message sent by <span class="docEmphRomanAlt">krb_recvauth</span> is the same as <span class="docEmphRomanAlt">KRB_PRV</span> (described in following section), but the data part of the <span class="docEmphSmaller">ENCRYPTED STUFF</span> field is the four-octet incremented checksum.</p>
<a name="ch13lev2sec12"></a>
<h4 id="title-IDAYRCRG" class="docSection2Title">13.12.10. Encrypted Data (KRB_PRV)</h4>
<p class="docText"><a name="iddle1333"></a><a name="iddle1359"></a>Some applications want privacy as well as authentication, i.e., they want their data encrypted. They call a Kerberos subroutine that encrypts the application-supplied data and packages it into a message of the following form:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="50"></col><col width="400"></col><col width="25"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>6<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">length of encrypted stuff</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">encrypted stuff</span></p></td></tr></table></p><br />
<p class="docText">The <span class="docEmphSmaller">ENCRYPTED STUFF</span> is encrypted using DES in the PCBC mode using the session key. Once decrypted, its format is:</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="50"></col><col width="25"></col><col width="300"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">length of data</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">data</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">5-millisecond timestamp</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">sender's IP address</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">D</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">timestamp</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">padding</span></p></td></tr></table></p><br />
<p class="docText">By the nature of PCBC, the sender's IP address and the timestamp serve as an integrity check on the data. The timestamp serves a second function of providing some protection against replay.</p>
<p class="docText">Because encryption for privacy is an export-controlled technology, certain versions of Kerberos exclude the capacity to encrypt application-supplied data. This message type will still occur, however, in the context of a mutual authentication message.</p>
<a name="ch13lev2sec13"></a>
<h4 id="title-IDAH3CRG" class="docSection2Title">13.12.11. Integrity-Checked Data (SAFE)</h4>
<p class="docText">For some applications, privacy of the data is not a concern, but protection of the integrity of the data in transit is. Others may be willing to give up privacy in order to get better performance or in order to satisfy government regulations, but are still willing to pay a price for integrity protection.</p>
<p class="docText"><a name="iddle1172"></a><a name="iddle1511"></a><a name="iddle1985"></a>The SAFE message is basically application data to which Kerberos appends a checksum and timestamp. The format for integrity-protected data is</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="100"></col><col width="50"></col><col width="300"></col><col width="50"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="3"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">message type (</span>7<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="3"><p class="docText"><span class="docEmphRomanAlt">length of data</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">variable</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="3"><p class="docText"><span class="docEmphRomanAlt">data</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="3"><p class="docText"><span class="docEmphRomanAlt">5-millisecond timestamp</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="3"><p class="docText"><span class="docEmphRomanAlt">sender's IP address</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">D</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">timestamp</span></p></td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">16</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="3"><p class="docText"><span class="docEmphRomanAlt">(pseudo-Jueneman) checksum</span></p></td></tr></table></p><br />
<ul><li><p class="docList"><span class="docEmphSmaller">SENDER'S</span> IP <span class="docEmphSmaller">ADDRESS</span>. It does not appear that having this field in every message adds anything to security, but the Kerberos code checks that it matches the address from which the packet came.</p></li><li><p class="docList"><span class="docEmphSmaller">TIMESTAMP</span>. The purpose of this field is to prevent delayed and replayed messages. An application could save all timestamps that were used within the allowable clock skew and refuse additional messages with the same timestamp. It could also require that messages encrypted under a given key be processed in strictly ascending order by timestamp (if using a connection type that prevents reordering). All the Kerberos-V4-provided subroutine does is make sure the timestamp is within the allowable clock skew.</p></li><li><p class="docList">5-<span class="docEmphSmaller">MILLISECOND TIMESTAMP</span>. This field allows more than one message within a second. Theoretically it is in units of 5 milliseconds, but in practice can be a sequence number of messages sent within a particular value of the four-octet <span class="docEmphSmaller">TIMESTAMP</span> field. If this format survives long enough, a limit of one message every 5 milliseconds may someday be a problem.</p></li><li><p class="docList"><span class="docEmphSmaller">CHECKSUM</span>. The modified Jueneman checksum is seeded with the session key as described in &sect;<a class="docLink" href="ch13lev1sec10.html#ch13lev1sec10">13.10</a> <span class="docEmphasis">Encryption for Integrity Only</span> so that only someone with knowledge of the session key can compute a new valid checksum for a modified message.</p></li></ul>
<a name="ch13lev2sec14"></a>
<h4 id="title-IDAHIDRG" class="docSection2Title">13.12.12. AP_ERR</h4>
<p class="docText"><a name="iddle1343"></a>This is returned if the authentication failed.</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="4"><col width="50"></col><col width="300"></col><col width="25"></col><col width="100"></col></colgroup><thead></thead><tr><td class="docTableCell" align="right" valign="top"><p class="docText"># octets</p></td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">version of Kerberos (</span>4<span class="docEmphRomanAlt">)</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">1</p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">message type (</span>8<span class="docEmphRomanAlt">)</span></p></td><td class="rightBorder bottomBorder" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">B</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText">4</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">error code</span></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="rightBorder" align="right" valign="top"><p class="docText"><img src="U2264.GIF" border="0" />40</p></td><td class="rightBorder bottomBorder" align="center" valign="top" colspan="2"><p class="docText"><span class="docEmphRomanAlt">error text / additional explanation of error</span></p></td><td class="docTableCell" align="right" valign="top"><p class="docText">null-terminated</p></td></tr></table></p><br />
<p class="docText">The possible errors are</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="10"></col><col width="10"></col><col width="530"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText">31</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">can't decode authenticator.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">32</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">ticket expired.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">33</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">ticket not yet valid.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">34</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">repeated request. Receiver of message remembers receiving the same timestamp and 5-millisecond timestamp before.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">35</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">ticket isn't for us. Well, we're not sure what they intended by this error message, but it's never used anywhere. The intention was most likely for Bob to check Bob's name and instance inside the ticket, but none of the applications implemented actually check this.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">36</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">request is inconsistent. The name, instance, and realm of Bob as listed in the ticket does not match the name, instance, and realm in the authenticator.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">37</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">delta_t too big. There is too much skew in the clocks. This is determined based on comparison of the timestamp in the authenticator and the local time at Bob. This skew can be set independently at each node, but a common time is five minutes.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">38</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">incorrect net address. The address in the ticket does not match the source address in the Network Layer header of the received message.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">39</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">protocol version number mismatch.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">40</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">invalid message type.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">41</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">message stream modified. Either the checksum failed or some other piece of bad formatting was detected in an encrypted or integrity-protected message.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">42</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">message out of order. Timestamps are not in ascending order. This assumes the application is running over a reliable transport protocol (in this case, TCP), so that reordering is not due to the network.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">43</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Â</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">unauthorized request. This is an application-specific complaint, i.e., it is not generated by Kerberos. It might be used by Bob to tell Alice that Alice is not authorized to use Bob.</p></td></tr></table></p><br />
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch13lev1sec11.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch13lev1sec13.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>