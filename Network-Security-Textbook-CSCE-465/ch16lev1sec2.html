<html><head><title>16.2. Session Key Establishment</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec1.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec3.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch16lev1sec2"></a>
<h3 id="title-IDAPNMSB" class="docSection1Title">16.2. Session Key Establishment</h3>
<p class="docText">In <a class="docLink" href="ch11.html#ch11">Chapter 11</a> <span class="docEmphasis">Security Handshake Pitfalls</span> we discuss various protocols and pitfalls for doing mutual authentication. Cryptographic mutual authentication is certainly an improvement over passwords in the clear, but it is also important to cryptographically protect the conversation after the initial handshake. Obviously it is desirable to protect the data from disclosure or modification. But another vulnerability if cryptographic protection ends after the initial handshake is <b><a class="docLink" href="app02.html#gloss01_203">session hijacking</a></b>, in which someone takes over Alice's session to Bob by forging Alice's IP address as the source address on packets sent to Bob, and using TCP sequence numbers larger than what Alice would be using. Without cryptographic protection, Bob can't distinguish these packets from authentic packets from Alice. Once Bob accepts the attacker's larger TCP sequence numbers, Alice's data just gets ignored as duplicate data. It looks to Alice like the connection breaks, but the attacker is now logged in as Alice, and can do anything Alice is allowed to do. So, a session key is used after the initial mutual authentication to cryptographically protect the conversation from disclosure, modification, or hijacking.</p>
<p class="docText">A sequence number is typically used to prevent replay or reordering. A new session key should be established for each new session, and during a session, if the sequence number might be reused (i.e., wrap around).</p>
<p class="docText">The session key must be unpredictable to an attacker. (For instance, Goldberg and Wagner [<a class="docLink" href="biblio01.html#biblio01_072">GOLD96</a>] reverse engineered an implementation of the SSL protocol and discovered that the session key was based on three quantities: the time of day in units of microseconds, the process id, and the parent process id. This meant that an attacker who knew the approximate time the session was <a name="iddle1268"></a><a name="iddle1542"></a><a name="iddle1794"></a><a name="iddle1803"></a>created had a feasible search space to search for keys. Even though the key was 128 bits long, given a bit of cleverness to narrow down the potential process ids, the attacker would only have to search from an approximately 30-bit space to find the key.</p>
<p class="docText">Both communicating parties should contribute to the session key, for instance by having each side send a value to the other, encrypted with the other side's public key, and using a hash of the two values as the session key. This rule makes it less likely that the protocol will have flaws in which someone will be able to impersonate one side or the other in a replay attack. For instance, in a protocol in which Alice sends the session key to Bob, encrypted with his public key, someone impersonating Alice can simply replay all Alice's messages.</p>
<p class="docText">Another reason for having both sides contribute to the session key is that if <span class="docEmphasis">either</span> side has a good random number generator, then the session key will be sufficiently random.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec1.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec3.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>