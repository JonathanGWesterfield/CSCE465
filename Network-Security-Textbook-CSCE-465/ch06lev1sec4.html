<html><head><title>6.4. Diffie-Hellman</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch06lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch06lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch06lev1sec4"></a>
<h3 id="title-IDAC05UC" class="docSection1Title">6.4. Diffie-Hellman</h3>
<p class="docText"><a name="iddle1267"></a>The Diffie-Hellman public key cryptosystem predates RSA and is in fact the oldest public key system still in use. It is less general than RSA (it does neither encryption nor signatures), but it offers better performance for what it does. If Diffie-Hellman neither encrypts nor signs, how can it be called a cryptosystem? What does it do?</p>
<p class="docText">Diffie-Hellman allows two individuals to agree on a shared key, even though they can only exchange messages in public. In other words, assume our famous two people, Alice and Bob, want to have a secret number that they share so that they can start encrypting messages to each other. But the only way they can talk is by some means of communication that lots of people can overhear. For instance, they might be sending messages across a network, or on a telephone that might be tapped, or they might be shouting at each other across a crowded room, or they might for some reason have to resort to communication by placing ads in the personals section of the local newspaper.</p>
<p><table cellspacing="0" class="allBorders" border="1" rules="none" cellpadding="5"><colgroup align="left" span="1"><col width="500"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"></p><p class="docText"><br />Dear&nbsp;&nbsp;&nbsp;&nbsp;Bob,&nbsp;&nbsp;&nbsp;the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magic&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is<br />1890289304789234789279189028902.<br />Wish&nbsp;you&nbsp;were&nbsp;here.&nbsp;Love,&nbsp;Alice.</p></td></tr></table></p></td></tr></table><br />
<p class="docText">In its original conception, the Diffie-Hellman algorithm has limited functionality, since the only thing it really accomplishes is having a secret number that both Alice and Bob know, and nobody else can figure out based on the messages they overhear between Alice and Bob. Neither Alice nor Bob start out with any secrets, yet after the exchange of two messages that the world can overhear, Alice and Bob will know a secret number. Once they know a secret number, they can use conventional cryptography (secret key cryptography like DES, for instance) for encryption. Diffie-Hellman is actually used for key establishment (getting two things to agree on a common secret key) in some applications, for instance data link encryption on a LAN.</p>
<p class="docText">A weakness of Diffie-Hellman is that although two individuals can agree on a shared secret key, there is no authentication, which means that Alice might be establishing a secret key with a bad guy. We will talk about this more after we force you to read through how Diffie-Hellman works.</p>
<p class="docText">To start out, there are numbers <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span>, where <span class="docEmphasis">p</span> is a large prime and <span class="docEmphasis">g</span> is a number less than <span class="docEmphasis">p</span> with some restrictions that aren't too important for a basic understanding of the algorithm. <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span> are known beforehand and can be publicly known. For instance, Alice could choose a <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span> and send them (publicly) to Bob, for instance by publishing them in <span class="docEmphasis">The New York Times</span>.</p>
<p><table cellspacing="0" class="allBorders" border="1" rules="none" cellpadding="5"><colgroup align="left" span="1"><col width="220"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><a name="iddle1041"></a><a name="iddle1054"></a><a name="iddle1129"></a><a name="iddle1277"></a><a name="iddle1395"></a><a name="iddle1568"></a><a name="iddle1598"></a>Dear Bob, I'd like our prime</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">to be 128903289023 and our</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">g</span> to be 23489. Love, Alice.</p></td></tr></table></p><br />
<p class="docText">Once Alice and Bob agree on a <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span>, each chooses a 512-bit number at random and keeps it secret. Let's call Alice's secret number <span class="docEmphasis">S</span><sub>A</sub> and Bob's secret number <span class="docEmphasis">S</span><sub>B</sub>. Each raises <span class="docEmphasis">g</span> to their secret number, mod <span class="docEmphasis">p</span>. The result is that Alice computes some number <span class="docEmphasis">T</span><sub>A</sub> and Bob computes some number <span class="docEmphasis">T</span><sub>B</sub>. They exchange their <span class="docEmphasis">T</span>s. Finally, each raises the received <span class="docEmphasis">T</span> to their secret number.</p>
<p><table cellspacing="0" class="allBorders" border="1" rules="none" cellpadding="5"><colgroup align="center" span="1"><col width="550"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Alice picks <span class="docEmphasis">S</span><sub>A</sub> at random. Bob picks <span class="docEmphasis">S</span><sub>B</sub> at random.</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Alice computes <span class="docEmphasis">T</span><sub>A</sub> = <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>A</sub></sup> mod <span class="docEmphasis">p</span>. Bob computes <span class="docEmphasis">T</span><sub>B</sub> = <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>B</sub></sup> mod <span class="docEmphasis">p</span>.</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">They exchange <span class="docEmphasis">T</span>s (in either order or simultaneously): <span class="docEmphasis">T</span><sub>A</sub> <img src="U2194.GIF" border="0" /> <span class="docEmphasis">T</span><sub>B</sub></p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Now each raises the number they receive to their private secret number:</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Alice computes <span class="docEmphasis">T</span><sub>B</sub><sup><span class="docEmphasis">S</span><sub>A</sub></sup> mod <span class="docEmphasis">p</span>. Bob computes <span class="docEmphasis">T</span><sub>A</sub><span class="docEmphasis"><sup>S</sup></span> B mod <span class="docEmphasis">p</span>.</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">They will both come up with the same number. That is because</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">T</span><sub>B</sub><sup><span class="docEmphasis">S</span><sub>A</sub></sup> = (<span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>B</sub></sup>)<sup><span class="docEmphasis">S</span><sub>A</sub></sup> = <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>B</sub><span class="docEmphasis">S</span><sub>A</sub></sup> = <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>A</sub><span class="docEmphasis">S</span><sub>B</sub></sup> = (<span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>A</sub></sup>)<sup><span class="docEmphasis">S</span><sub>B</sub></sup> = <span class="docEmphasis">T</span><sub>A</sub><sup><span class="docEmphasis">S</span><sub>B</sub></sup> mod <span class="docEmphasis">p</span>.</p></td></tr></table></p><br />
<p class="docText">Nobody else can calculate <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>A</sub><span class="docEmphasis">S</span><sub>B</sub></sup> in a reasonable amount of time even though they know <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>A</sub></sup> and <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>B</sub></sup>. If they could compute <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_073">discrete logarithms</a></span>, i.e. figure out <span class="docEmphasis">S</span><sub>A</sub> based on seeing <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>A</sub></sup>, then they could figure out the Alice/Bob shared key. But we assume they can't compute discrete logarithms, because of the Fundamental Tenet of Cryptography (mathematicians haven't figured out how to do that easily in spite of considerable effort, or at least they haven't told us they have).</p>
<a name="ch06lev2sec10"></a>
<h4 id="title-IDA34AVC" class="docSection2Title">6.4.1. The Bucket Brigade/Man-in-the-Middle Attack</h4>
<p class="docText">If Alice receives <span class="docEmphasis">T</span><sub>B</sub> indirectly, there is no way for her to know for sure whether the number came from Bob. She will establish a secret key with whoever transmitted <span class="docEmphasis">T</span><sub>B</sub>, but it certainly might not be Bob. Let's assume Alice is talking to X, who may or may not be Bob. Once Alice and X establish a secret key, they can encrypt all their messages so that only Alice and X can read them. Let's say the first thing Alice and X exchange in their encrypted communication is a password that Alice and Bob have previously agreed upon, one password that Bob is to say to Alice, perhaps <span class="docEmphRomanAlt">The fish are green</span>, and one that Alice is to say to Bob, for instance <span class="docEmphRomanAlt">The moon sets at midnight</span>. If Alice receives the expected password from X, can she assume she is talking to Bob? (Think about this a <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_021">bit</a></span> before reading the next paragraphÂit's fun. Hint: Obviously, there must be some subtle attack or we wouldn't claim it was an interesting question.)</p>
<p class="docText">Assume <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span> are publicly known (if not, Alice can put them into her message). Alice places the ad <span class="docEmphRomanAlt">Dear Bob. I'd like to talk to you. 8389. Love, Alice.</span> Suppose there's a bad guy, Mr. X, who works for the newspaper. He makes one copy of the newspaper with Alice's ad printed as Alice wished, and bribes the newspaper deliverer to give that copy to Alice. Meanwhile, Mr. X picks his own <span class="docEmphasis">S</span><sub>X</sub> and computes <span class="docEmphasis">g</span><sup><span class="docEmphasis">S</span><sub>X</sub></sup> mod <span class="docEmphasis">p</span>. He edits the ad slightly by substituting this number instead of 8389, and has that version printed in the rest of the newspapers. Later, Bob replies, by ordering the ad <span class="docEmphRomanAlt">So pleased to talk to you. My magic number is 9267. Love, Bob.</span> Mr. X makes one copy of the newspaper with Bob's ad printed as Bob wished, and arranges for Bob to receive that copy. Mr. X edits Bob's ad slightly to substitute his own number for Bob's, and arranges for the newspaper with that version of the ad to get to Alice. Mr. X computes <span class="docEmphasis">K</span><sub>AX</sub> = 8389<sup><span class="docEmphasis">S</span><sub>X</sub></sup> and uses that for talking to Alice, and computes <span class="docEmphasis">K</span><sub>BX</sub> = 9267<sup><span class="docEmphasis">S</span><sub>X</sub></sup> and uses that for talking to Bob.</p>
<a name="ch06fig04"></a><p><center>
<h5 class="docFigureTitle">Figure 6-4. Bucket Brigade/Man-in-the-Middle Attack</h5>
</center></p><p class="docText">
<img border="0" alt="" width="500" height="190" src="06fig04.jpg" /></p>
<br />
<p class="docText">Now suppose Alice sends an encrypted message (to Mr. X) which includes the password <span class="docEmphRomanAlt">The fish are green.</span> Mr. X can decrypt the message because it is encrypted using the key he shares with Alice. Mr. X reencrypts and transmits Alice's password to Bob, which reassures Bob that he is indeed talking to Alice, and Bob then transmits (encrypted, to Mr. X) <span class="docEmphRomanAlt">The moon sets at midnight.</span> Mr. X decrypts Bob's message, extracts the password, and reencrypts and transmits the password to Alice. Now both Alice and Bob think they are talking to each other.</p>
<p class="docText">To guard against this threat, perhaps Alice and Bob should transmit the actual secret number they think they are using, over the encrypted channel they have established? That won't work either. Alice sends the message <span class="docEmphRomanAlt">I think we are using <span class="docEmphasis">K</span><sub>AX</sub>;</span> however, Mr. X decrypts the message and edits it to be <span class="docEmphRomanAlt">I think we are using <span class="docEmphasis">K</span><sub>BX</sub></span> before encrypting and forwarding it on to Bob.</p>
<p class="docText">Suppose instead Alice and Bob attempt to reassure themselves that they are indeed talking to each other by asking each other personal questions. If Bob asks <span class="docEmphRomanAlt">What movie did we see the first night we met in Paris?,</span> Mr. X merely decrypts the message with <span class="docEmphasis">K</span><sub>BX</sub>, encrypts it with <span class="docEmphasis">K</span><sub>AX</sub>, and forwards the message on to Alice. When Alice replies, Mr. X merely forwards the message on to <a name="iddle1073"></a>Bob. (We're assuming Alices's memory of past evenings makes it worthwhile for Mr. X to actually wait for her answer rather than making one up himself.)</p>
<p class="docText">The name <b><a class="docLink" href="app02.html#gloss01_023">bucket brigade attack</a></b> comes from the way firefighters of old formed a line of people between a water source and a fire and passed full buckets toward the fire and empty buckets back. But the less politically correct term <b><a class="docLink" href="app02.html#gloss01_125">man-in-the-middle</a></b> has become more common. After establishing the shared keys, Mr. X passes messages back and forth and can examine them and/or modify them as they go. Using Diffie-Hellman alone, there's really nothing Alice and Bob can do to detect the intruder through whom they are communicating. As a result, this form of Diffie-Hellman is only secure against passive attack where the intruder just watches the messages.</p>
<a name="ch06lev2sec11"></a>
<h4 id="title-IDAGEBVC" class="docSection2Title">6.4.2. Defenses Against Man-in-the-Middle Attack</h4>
<a name="ch06lev3sec10"></a>
<h5 id="title-IDAPEBVC" class="docSection3Title">6.4.2.1. Published Diffie-Hellman Numbers</h5>
<p class="docText">One technique by which Diffie-Hellman can be secure against active attacks is for each person to have a somewhat permanent public and secret number instead of inventing one for each exchange. For this to work, everyone (in the communicating set) has to agree on a common <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span>. The public numbers are then all published by some means that is assumed reliable (for instance, through a PKI, see <a class="docLink" href="ch15.html#ch15">Chapter 15</a> <span class="docEmphasis">PKI (Public Key Infrastructure)</span>).</p>
<p class="docText">To the extent an intruder can't get in and modify the published public numbers, this makes Diffie-Hellman immune to active attacks. It has the additional advantage of eliminating the first two messages of the protocol. Knowing my own secret and looking up the public number of the person with whom I want to communicate, I can compute a key that the two of us will share for all messages we send to one another.</p>
<a name="ch06lev3sec11"></a>
<h5 id="title-IDALFBVC" class="docSection3Title">6.4.2.2. Authenticated Diffie-Hellman</h5>
<p class="docText">If Alice and Bob know some sort of secret with which they can authenticate each other, either a shared secret key or knowledge of each other's public keys (and their own private keys), then they can use this secret to prove that it was they who generated their Diffie-Hellman values. We call such an exchange an <span class="docEmphStrong">authenticated Diffie-Hellman exchange</span>. The proof can be done simultaneously with sending the Diffie-Hellman value, or after the Diffie-Hellman exchange. Examples are:</p>
<ul><li><p class="docList">Encrypt the Diffie-Hellman exchange with the pre-shared secret.</p></li><li><p class="docList">Encrypt the Diffie-Hellman value with the other side's public key (see <a class="docLink" href="ch06lev1sec9.html#ch06qa1q2">Homework Problem 2</a>).</p></li><li><p class="docList"><span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_204">Sign</a></span> the Diffie-Hellman value with your private key.</p></li><li><p class="docList"><a name="iddle1322"></a><a name="iddle1997"></a>Following the Diffie-Hellman exchange, transmit a hash of the agreed-upon shared Diffie-Hellman value, your name, and the pre-shared secret.</p></li><li><p class="docList">Following the Diffie-Hellman exchange, transmit a hash of the pre-shared secret and the Diffie-Hellman value you transmitted.</p></li></ul>
<a name="ch06lev2sec12"></a>
<h4 id="title-IDAPHBVC" class="docSection2Title">6.4.3. Encryption with Diffie-Hellman</h4>
<p class="docText">We've described the lack of authentication with Diffie-Hellman. There's another disadvantage with classic Diffie-Hellman: in order for two individuals to communicate, they have to first have an active exchange. This is easy to remedy. Suppose Alice is working late and wants to send an encrypted message to Bob that Bob will be able to read when he shows up at work the next morning at 7 AM (and Alice has no intention of being around at 7 AM).</p>
<p class="docText">First everyone computes a public key, which consists of the three numbers &lt;<span class="docEmphasis">p</span>, <span class="docEmphasis">g</span>, <span class="docEmphasis">T</span>&gt;, where <span class="docEmphasis">T</span> = <span class="docEmphasis">g<sup>S</sup></span> mod <span class="docEmphasis">p</span>, for the private key <span class="docEmphasis">S</span>. These public keys are displayed in a reliable and public place (like being published in <span class="docEmphasis">The New York Times</span>).</p>
<p class="docText">So Bob has published a &lt;<span class="docEmphasis">p</span><sub>B</sub>, <span class="docEmphasis">g</span><sub>B</sub>, <span class="docEmphasis">T</span><sub>B</sub>&gt;.</p>
<p class="docText">If Alice wants to send Bob an encrypted message, she picks a random number <span class="docEmphasis">S</span><sub>A</sub>, computes <span class="docEmphasis">g</span><sub>B</sub><sup><span class="docEmphasis">S</span><sub>A</sub></sup> mod <span class="docEmphasis">p</span><sub>B</sub> and computes <span class="docEmphasis">K</span><sub>AB</sub> = <span class="docEmphasis">T</span><sub>B</sub><sup><span class="docEmphasis">S</span><sub>A</sub></sup> mod <span class="docEmphasis">p</span><sub>B</sub>, and uses that as the encryption key to share with Bob. She uses <span class="docEmphasis">K</span><sub>AB</sub> to encrypt the message according to any secret key cryptographic technique, and sends the encrypted message, along with <span class="docEmphasis">g</span><sub>B</sub><sup><span class="docEmphasis">S</span><sub>A</sub></sup> mod <span class="docEmphasis">p</span><sub>B</sub> to Bob. Bob raises <span class="docEmphasis">g</span><sub>B</sub><sup><span class="docEmphasis">S</span><sub>A</sub></sup> mod <span class="docEmphasis">p</span><sub>B</sub> to his own secret <span class="docEmphasis">S</span><sub>B</sub>, and thereby calculates <span class="docEmphasis">K</span><sub>AB</sub> which enables him to decrypt the message.</p>
<a name="ch06lev2sec13"></a>
<h4 id="title-IDAVKBVC" class="docSection2Title">6.4.4. ElGamal Signatures</h4>
<p class="docText">Using the same sort of keys as Diffie-Hellman, ElGamal came up with a signature scheme [<a class="docLink" href="biblio01.html#biblio01_055">ELGA85</a>]. It is much harder to understand than signing with RSA. While it's important to know that it's possible and to understand the political and performance implications, the mathematics is tedious and unintuitive. We reluctantly recommend that all but true die-hards skip this section.</p>
<p class="docText">ElGamal signatures require each individual to have a long-term public/private key pair (the public key being &lt;<span class="docEmphasis">g</span>, <span class="docEmphasis">p</span>, <span class="docEmphasis">T</span>&gt; and the secret key being <span class="docEmphasis">S</span>, where <span class="docEmphasis">g<sup>S</sup></span> mod <span class="docEmphasis">p</span> = <span class="docEmphasis">T</span>, as described for Diffie-Hellman), and (surprisingly) require an individual to generate a new and different public/private key pair for each item that needs to be signed. Luckily the per-message public/private key pair is easy to compute. For a particular message <span class="docEmphasis">m</span>, choose a random number <span class="docEmphasis">S<sub>m</sub></span> and (using the same <span class="docEmphasis">g</span> and <span class="docEmphasis">p</span> as in the long-term key) compute <span class="docEmphasis">g<sup>S<sub>m</sub></sup></span> mod <span class="docEmphasis">p</span> = <span class="docEmphasis">T<sub>m</sub></span>. To use ElGamal, there has to be a message digest function that is well-known. Given a message <span class="docEmphasis">m</span>, to compute a signature, you first compute the message digest of <span class="docEmphasis">m</span>|<span class="docEmphasis">T<sub>m</sub></span>. Call that message digest <span class="docEmphasis">d<sub>m</sub></span>. Then you calculate <span class="docEmphasis">S<sub>m</sub></span> + <span class="docEmphasis">d<sub>m</sub>S</span> mod (<span class="docEmphasis">p</span>-1), <a name="iddle1278"></a><a name="iddle1569"></a><a name="iddle1842"></a><a name="iddle1843"></a><a name="iddle1944"></a><a name="iddle2016"></a>which is the signature. Let's call that <span class="docEmphasis">X</span> (since we've already used <span class="docEmphasis">S</span> for the Secret number, and some people sign documents with an <span class="docEmphasis">X</span>).</p>
<p class="docText"><span class="docEmphasis">m</span> is transmitted, along with <span class="docEmphasis">X</span> and <span class="docEmphasis">T<sub>m</sub></span>. To verify this signature, you compute <span class="docEmphasis">d<sub>m</sub></span> and check that <span class="docEmphasis">g<sup>X</sup></span> = <span class="docEmphasis">T<sub>m</sub>T<sup>d</sup>m</span> mod <span class="docEmphasis">p</span>. This will be true, assuming the signature is valid, because</p>
<p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><colgroup align="center" span="1"><col width="500"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphasis">g<sup>X</sup></span> = <span class="docEmphasis">g</span><sup><span class="docEmphasis">S<sub>m</sub></span>+<span class="docEmphasis">d<sub>m</sub>S</span></sup> = <span class="docEmphasis">g<sup>S<sub>m</sub></sup>g<sup>d<sub>m</sub>S</sup></span> = <span class="docEmphasis">T<sub>m</sub>T<sup>d<sub>m</sub></sup></span> mod <span class="docEmphasis">p</span>.</p></td></tr></table></p><br />
<p class="docText">This is not terrifically intuitive. The important things to try to convince oneself of are:</p>
<ul><li><p class="docList">If the signature is done correctly, the verification will succeed.</p></li><li><p class="docList">If the message is modified after being signed, the inputs to the signature function will have changed and with overwhelming probability the signature will not match the modified message.</p></li><li><p class="docList">Knowledge of the signature will not help divulge the signer's private key, <span class="docEmphasis">S</span>.</p></li><li><p class="docList">Someone without knowledge of <span class="docEmphasis">S</span> will not be able to produce a valid signature.</p></li></ul>
<a name="ch06lev2sec14"></a>
<h4 id="title-IDASSBVC" class="docSection2Title">6.4.5. Diffie-Hellman DetailsÂSafe Primes</h4>
<p class="docText">While Diffie-Hellman works with any prime <span class="docEmphasis">p</span> and any number <span class="docEmphasis">g</span>, it is less secure if <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span> don't have additional mathematical properties.</p>
<p class="docText">It turns out that for obscure mathematical reasons it is particularly nice if (<span class="docEmphasis">p</span>-1)/2 is also prime. A prime <span class="docEmphasis">p</span> that satisfies this additional constraint is called a <b><a class="docLink" href="app02.html#gloss01_194">safe prime</a></b>, or a Sophie Germain prime. It is also particularly nice if <span class="docEmphasis">g<sup>x</sup></span> <img src="U2260.GIF" border="0" /> 1 mod <span class="docEmphasis">p</span> unless <span class="docEmphasis">x</span> = 0 mod <span class="docEmphasis">p</span>-1. If <span class="docEmphasis">p</span> is a safe prime, this is satisfied by any <span class="docEmphasis">g</span> <img src="U2260.GIF" border="0" /> -1 mod <span class="docEmphasis">p</span> for which <span class="docEmphasis">g</span><sup>(<span class="docEmphasis">p</span>-1)/2</sup> = -1 mod <span class="docEmphasis">p</span>, which is true for almost half of all mod <span class="docEmphasis">p</span> numbers.</p>
<p class="docText">It is computationally expensive to choose <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span>. Theoretically, one only needs to do it once. You could keep using the same <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span>. It could even be a standard, and everyone could use the same <span class="docEmphasis">p</span> and <span class="docEmphasis">g</span>. However, that is not advisable. It turns out to be possible, though incredibly space-and computation-intensive, to calculate a large table based on a single <span class="docEmphasis">p</span>, which would allow you to compute discrete logarithms <span class="docEmphasis">for that p</span>. A similar scheme would allow you to break RSA, in the sense of being able to calculate someone's private key based on their public key, but there is not that much incentive to do so because that would only allow you to break one person's key. If the <span class="docEmphasis">p</span> for Diffie-Hellman were broken, then every key exchange based on Diffie-Hellman could be broken. Simply changing <span class="docEmphasis">p</span> occasionally will eliminate this threat.</p>
<a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></div></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch06lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch06lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table><!--IP User 2--></td></body></head></html>