<html><head><title>16.7. Live Partner Reassurance</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec6.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec8.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch16lev1sec7"></a>
<h3 id="643999-894" class="docSection1Title">16.7. Live Partner Reassurance</h3>
<p class="docText">If Trudy can replay messages from previous conversation negotiations, she might be able to get Bob to waste space on a connection, or worse yet, she might be able to replay the subsequent data messages and, even if she can't decrypt the conversation, she might be able to cause Bob to repeat actions. For instance, when Bob (an ATM machine) talked to Alice, she might have requested Bob to put $100 into the money tray, as in <a class="docLink" href="#ch16fig05">Protocol 16-5</a>.</p>
<a name="ch16fig05"></a><p><center>
<h5 class="docFigureTitle">Protocol 16-5. A protocol vulnerable to replay if Bob reuses <span class="docEmphasis">b</span></h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095009249" width="400" height="169" src="16fig05.jpg" /></p>
<br />
<p class="docText">An hour later, if Trudy replays Alice's messages, it is important that Bob realize that this is not a conversation with the live Alice. If Bob chose a different <span class="docEmphasis">b</span> in each Diffie-Hellman exchange, then there wouldn't be a problem, but it is computation intensive to compute <span class="docEmphasis">g<sup>b</sup></span>, so it might be nice to be able to reuse <span class="docEmphasis">b</span>.</p>
<p class="docText">A way to allow Bob to reuse <span class="docEmphasis">b</span> and avoid replay attacks is for Bob to choose a nonce for each connection attempt, and have the session key be a function of the nonce as well as the Diffie-Hellman key. So the protocol might be modified to look like <a class="docLink" href="#ch16fig06">Protocol 16-6</a>.</p>
<a name="ch16fig06"></a><p><center>
<h5 class="docFigureTitle">Protocol 16-6. Using a nonce so Bob knows it's not replayed messages from Alice</h5>
</center></p><p class="docText"><div class="v1"><a target="_blank" href="16fig06_alt.jpg">[View full size image]</a></div><img border="0" alt="" id="118095009249" width="500" height="163" src="16fig06.jpg" /></p>
<br />
<p class="docText">Here the session key is a function of the nonce <span class="docEmphasis">N</span> as well as the Diffie-Hellman value. This seems similar to a cookie, but it is desirable for a cookie to be stateless, so that Bob does not have to keep state until he's at least sure the other end can listen at the IP address it claims to be sending from. With the most straightforward implementation of a stateless cookie, the cookie will be reused, so wouldn't work as a nonce. It is possible to design a protocol that will allow something to work both as a nonce and as a stateless cookie (see <a class="docLink" href="ch16lev1sec14.html#ch16qa2q10">Homework Problem 10</a>).</p>
<p class="docText">Note that we've only ensured that Bob knows it's the live Alice (and not replayed messages). How would Alice know it's the real Bob? If Alice chooses a different <span class="docEmphasis">a</span> each time, and if Alice receives proof from the other side that it knows <span class="docEmphasis">K</span> (for instance, by acting on her request, which was encrypted with <span class="docEmphasis">K</span>), then she knows it's the real Bob. But suppose Alice, like Bob, would like to reuse <span class="docEmphasis">a</span> to save herself from computing <span class="docEmphasis">g<sup>a</sup></span> mod <span class="docEmphasis">p</span> (see <a class="docLink" href="ch16lev1sec14.html#ch16qa2q11">Homework Problem 11</a>).</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec6.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec8.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>