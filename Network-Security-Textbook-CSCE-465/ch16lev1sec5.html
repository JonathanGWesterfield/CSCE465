<html><head><title>16.5. Denial-of-Service/Clogging Protection</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec4.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec6.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch16lev1sec5"></a>
<h3 id="title-IDA245PH" class="docSection1Title">16.5. Denial-of-Service/Clogging Protection</h3>
<p class="docText"><a name="iddle1194"></a><a name="iddle1207"></a><a name="iddle1252"></a><a name="iddle1807"></a>Even if Trudy can't impersonate Alice without knowing her secret, in many protocols she can lock out legitimate users by forcing Bob to use up all his state or computation resources with authentication attempts. This sort of attack happens on the Internet, and the impostor often launches the attack packets with forged IP addresses. Using forged IP source addresses makes it difficult to catch the attacker, and it makes it difficult to allow firewalls to easily recognize and discard traffic from the impostor. It is easy to put any address into the source address field of an IP packet, but it is more difficult to be able to receive packets sent to a randomly chosen IP address.</p>
<a name="ch16lev2sec1"></a>
<h4 id="title-IDADQKYR" class="docSection2Title">16.5.1. Cookies</h4>
<p class="docText">The designers of <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_162">Photuris</a></span> (an early key management protocol for IPsec which will be more fully described in &sect;<a class="docLink" href="ch18lev1sec1.html#ch18lev1sec1">18.1</a> <span class="docEmphasis">Photuris</span>) provided for denial-of-service protection by adding a feature which the designers called <span class="docEmphasis">cookies</span>. Despite the name, this feature has nothing to do with web browser cookies [see &sect;<a class="docLink" href="ch25lev1sec5.html#ch25lev1sec5">25.5</a> <span class="docEmphasis">Cookies</span>].</p>
<p class="docText">The Photuris cookie is a number chosen by Bob, and unpredictable to the side initiating communication with Bob. When Bob receives a connection initiation from IP source address <span class="docEmphasis">S</span>, Bob sends this number, in the clear, to the IP address <span class="docEmphasis">S</span>. Bob does no significant computation until he receives the same cookie back from that IP address. This assures that the initiator can receive packets sent to the IP address from which it claims to be transmitting.</p>
<p class="docText">This feature makes it somewhat harder to mount a certain narrow set of attacks. It doesn't hurt, other than making the protocol slightly more complex, and adding a round-trip delay (in the case of Photuris). In theory, cookies could be used only when a node is getting swamped, saving the round-trip delay in the usual case (see <a class="docLink" href="ch16lev1sec14.html#ch16qa2q2">Homework Problem 2</a>).</p>
<p class="docText">A server has a limited amount of memory for keeping track of connections. If an attacker were sending zillions of connect requests, and Bob had to remember what cookie he sent for each request, then even if the attacker couldn't return the correct cookie, he could still swamp Bob's memory so that Bob couldn't accept connections from legitimate users. This is similar to the attack known as the TCP SYN attack (&quot;SYN&quot; is the first packet that Alice sends to Bob to initiate a TCP connection to Bob), where TCP requires Bob to keep state after receiving the first connection request, and an attacker can fill up Bob's table.</p>
<p class="docText">So we'd like Bob not to have to remember which cookies he sent to which connection initiators. The Photuris protocol provided for <span class="docEmphStrong">stateless cookies</span>. The idea is to have the cookie be a function of the IP address and a secret known to Bob, so that Bob can calculate what cookie he would have sent to a particular IP address. One possibility is hash(IP address, secret). So the cookie protocol might look like <a class="docLink" href="ch16lev1sec3.html#ch16fig02">Protocol 16-2</a>.</p>
<p class="docText"></p><a name="ch16fig03"></a><p><center>
<h5 class="docFigureTitle">Protocol 16-3. Stateless cookie protocol</h5>
</center></p><p class="docText">
<img border="0" alt="" width="450" height="215" src="16fig03.jpg" /></p>
<br />
<a name="ch16lev2sec2"></a>
<h4 id="title-IDAITKYR" class="docSection2Title">16.5.2. Puzzles</h4>
<p class="docText">Juels and Brainard [<a class="docLink" href="biblio01.html#biblio01_085">JUEL99</a>] came up with a clever alternative scheme for some amount of protection from a denial-of-service attack of this sort, where there are more initiators than Bob has computation or storage to handle. The idea is that if Bob is getting swamped, then Bob can require initiators to do more computation in order to connect. Bob can require each one to solve a puzzle, for instance making them compute a number whose message digest is a particular value. Bob can require arbitrary amounts of computation from an initiator by varying the size of the unknown number (&quot;what 27-bit number has an MD of <span class="docEmphasis">x</span>?&quot;). He can also make it stateless, in a similar way to stateless cookies (<a class="docLink" href="ch16lev1sec14.html#ch16qa2q3">Homework Problem 3</a>). This would not help very much if there are a lot more attackers than legitimate connection initiators, but it will slow down a single attacker making a lot of connection attempts.</p>
<p class="docText">Verifying a puzzle answer is fast, since it merely involves doing a message digest. However solving the problem is exponential in the number of the bits Bob chooses for the size of the puzzle.</p>
<p class="docText">The idea would be that non-hostile connection initiators might not mind having to do a few seconds worth of computation in order to connect, but it would slow down attackers, since any single attacker would not be able to get to the point of requiring storage and significant computation from Bob more than once every few seconds.</p>
<p class="docText">Some issues are:</p>
<ul><li><p class="docList">There are orders of magnitude of difference in the computational power of machines, and the amount of computation necessary to slow down a powerful machine would make it prohibitive to connect from a wimpy, ancient (e.g., two-year-old) machine.</p></li><li><p class="docList"><a name="iddle1049"></a><a name="iddle1286"></a><a name="iddle1339"></a>Many attackers could cooperate, or an attacker could create a virus that would attack from many sites simultaneously (this is known as a <span class="docEmphStrong">distributed denial-of-service attack</span>).</p></li></ul>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec4.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec6.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>