<html><head><title>16.12. Negotiating Crypto Parameters</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec11.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec13.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch16lev1sec12"></a>
<h3 id="title-IDAH014H" class="docSection1Title">16.12. Negotiating Crypto Parameters</h3>
<p class="docText">It's fashionable today for security protocols to negotiate cryptographic algorithms, rather than simply having the algorithms be part of the specification of the protocol. It certainly makes the protocols more complex. Examples of things to negotiate are an algorithm for encryption, including key size, or an algorithm for compression, or the prime to use in a Diffie-Hellman exchange.</p>
<p class="docText">One reason for allowing choice of cryptographic algorithms is so that over time systems can migrate to stronger but slower crypto as attackers' and defenders' machines get faster. Also, it allows migration from a cryptographic algorithm that gets broken. The cynic might observe that it also avoids the necessity for the committee to make a decision, and it allows them to pass the responsibility for a decision to a different committee (or worse yet, the user).</p>
<p class="docText">One potential security flaw, if the negotiation isn't done right, is that an active attacker Trudy might be able to trick Alice and Bob into using weaker cryptography by removing from Alice's suggestions the ones that Trudy can't break. Alice and Bob would like to agree on the strongest possible cryptography that they both support. If Alice is willing, if necessary, to use weak crypto, and a weak algorithm is among the choices, and Bob is willing, if necessary, to use weak crypto, removing the strong choices from Alice's list may cause them to agree on weak crypto, if the protocol is not carefully designed.</p>
<p class="docText">The reason this is a common vulnerability is that while Alice and Bob are negotiating about cryptographic algorithms, they probably do not yet have a shared secret with which to do integrity protection of the packets. The solution is to wait until they have established a shared secret, and then detect the tampering by having Alice reiterate (in a cryptographically protected way) what proposals she had made.</p>
<p class="docText">IKE (&sect;<a class="docLink" href="ch18lev1sec5.html#ch18lev2sec5">18.5.5</a> <span class="docEmphasis">Negotiating Cryptographic Parameters</span>) separately negotiates algorithms for encryption, integrity, authentication, etc. One way of doing this would be to say &quot;I can use any of these algorithms for encryption, any of these for integrity,&quot; and so forth. But the IKE designers were concerned that not every set of choices would interoperate. For instance, DSA is supposed to only use SHA-1 as the hash. So the choice for IKE was to separately specify each combination Alice was willing to support. This could lead to an exponential explosion of choices.</p>
<p class="docText">SSL/TLS's negotiation is much simpler. The specification predefines suites, with each suite specifying each of the algorithms. This is less flexible, unless every possible combination of cryptographic algorithms was a predefined suite. But in reality, there is no reason to support more than a few suites.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec11.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec13.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>