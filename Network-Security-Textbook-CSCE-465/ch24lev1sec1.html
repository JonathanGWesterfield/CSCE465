<html><head><title>24.1. NetWare V3</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch24.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch24lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch24lev1sec1"></a>
<h3 id="title-IDA5CUZK" class="docSection1Title">24.1. NetWare V3</h3>
<p class="docText">Novell's networking package is known as NetWare. This section describes the cryptographic security in Version 3. Version 4 security was enhanced to use public key cryptography. We describe Version 4 security in &sect;<a class="docLink" href="ch24lev1sec2.html#ch24lev1sec2">24.2</a> <span class="docEmphasis">NetWare V4</span>.</p>
<p class="docText">Each server has a database consisting of information about each authorized client. The information includes the user's name, the salt, and the hash of the user's password with the salt. The salt is not actually a random number, but instead is a 32-bit user ID assigned by the server when the user is installed in the server database. The salt serves two purposes. It makes the hash of Alice's password server-dependent, so that if Alice uses the same password on multiple servers, the database at each server will, with high probability, store a different hash of her password. It also makes the hash of Ted's password different from the hash of Alice's password even if they have the same password. We'll use <span class="docEmphasis">X</span> to designate the hash of the password stored at the server.</p>
<a name="ch24tab01"></a><p><table cellspacing="0" class="allBorders" border="1" rules="rows" cellpadding="4"><caption><h5 class="docTableTitle">Figure 24-1. Server Password Database</h5></caption><colgroup align="left" span="1"><col width="300"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">username<sub>1</sub></span></p>
<p class="docText"><span class="docEmphRomanAlt">userID<sub>1</sub>=salt<sub>1</sub></span></p>
<p class="docText"><span class="docEmphRomanAlt">hash(salt<sub>1</sub>,password<sub>1</sub>)=<span class="docEmphasis">X</span><sub>1</sub></span></p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphRomanAlt">username<sub>2</sub></span></p>
<p class="docText"><span class="docEmphRomanAlt">userID<sub>2</sub>=salt<sub>2</sub></span></p>
<p class="docText"><span class="docEmphRomanAlt">hash(salt<sub>2</sub>,password<sub>2</sub>)=<span class="docEmphasis">X</span><sub>2</sub></span></p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">.</span></p>
<p class="docText"><span class="docEmphRomanAlt">.</span></p>
<p class="docText"><span class="docEmphRomanAlt">.</span></p></td></tr></table></p><br />
<p class="docText">Alice tells her workstation her name, password, and the name of the server to which she'd like to log in. The workstation sends Alice's name to the server. The server sends the salt value and a random challenge <span class="docEmphasis">R</span> to the workstation. The workstation performs the hash of the password Alice typed with the salt, and now both the workstation and the server know the same secret value <span class="docEmphasis">X</span> (assuming Alice typed her password correctly).</p>
<p class="docText">Now the workstation and the server each computes hash(<span class="docEmphasis">X</span>,<span class="docEmphasis">R</span>) to get a value we'll call <span class="docEmphasis">Y</span>. The workstation transmits <span class="docEmphasis">Y</span> to the server, and if it matches hash(<span class="docEmphasis">X</span>,<span class="docEmphasis">R</span>), then the server considers Alice authenticated. At this point the workstation and the server each compute <span class="docEmphasis">Z</span>=hash(<span class="docEmphasis">X</span>,<span class="docEmphasis">R</span>,constant string). <span class="docEmphasis">Z</span> is what they'll use as a secret session key.</p>
<a name="ch24fig01"></a><p><center>
<h5 class="docFigureTitle">Figure 24-2. NetWare V3 Authentication</h5>
</center></p><p class="docText"><div class="v1"><a target="_blank" href="24fig02_alt.jpg">[View full size image]</a></div><img border="0" alt="" width="500" height="166" src="24fig02.jpg" /></p>
<br />
<p class="docText">After the authentication exchange each packet is integrity-protected by performing a hash of the <a name="iddle1061"></a><a name="iddle1174"></a><a name="iddle1310"></a><a name="iddle1425"></a><a name="iddle1630"></a><a name="iddle1683"></a><a name="iddle1728"></a>packet and <span class="docEmphasis">Z</span>. Once the workstation receives an integrity-protected packet from the server, mutual authentication has occurred, because the server has proven it knows <span class="docEmphasis">Z</span>.</p>
<p class="docText">Actually, for performance reasons, only the first 52 bytes of the packet are cryptographically checksummed. Checksumming the first 52 bytes of the packet is sufficient to answer the threats of eavesdroppers gaining information from the authentication exchange and intruders hijacking a session after the initial authentication exchange. It does not prevent an attacker from removing a packet in transit and substituting one with modified data after the first 52 bytes, but this is a far less realistic threat, particularly if the two communicating parties are on the same LAN.</p>
<p class="docText">Why did Novell choose 52 bytes rather than some nice power of 2? Because 52 bytes is long enough to protect all the information necessary to prevent hijacking, and there's additional information appended to those 52 bytes to form a single 64-byte message digest block. The extra information is the 4-byte packet length and the 8-byte secret.</p>
<p class="docText">Why does the server store the secret value <span class="docEmphasis">X</span> rather than simply the user's password? A workstation that knew the value <span class="docEmphasis">X</span> would be able to impersonate Alice without knowing Alice's password. But in terms of real-world threats, it is a lot more secure to store <span class="docEmphasis">X</span> than Alice's password. If Trudy were to steal the server's database and acquire <span class="docEmphasis">X</span>, she'd only be able to exploit <span class="docEmphasis">X</span> if she were able to acquire the client authentication code and modify it to use <span class="docEmphasis">X</span> rather than compute it from what the user types. In contrast, if the server stored the user's password directly, then if Trudy stole the server's database, she'd be able to impersonate Alice directly by typing her password at unmodified client code.</p>
<p class="docText">Storing <span class="docEmphasis">X</span> rather than the password will not prevent Trudy from doing an off-line password-guessing attack, but if Alice chose her password wisely, then an off-line password-guessing attack is unlikely to succeed.</p>
<p class="docText">Another reason it is more secure to store <span class="docEmphasis">X</span> than the user's password is because of the salt. Let's assume Trudy can modify the client code, and can therefore use <span class="docEmphasis">X</span> to impersonate Alice directly, and therefore <span class="docEmphasis">X</span> is as security-sensitive as Alice's actual password. Since <span class="docEmphasis">X</span> is very likely to be different at each server, even if Alice's password is the same, then Trudy will only be able to impersonate Alice at the server from which Trudy acquired the database.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch24.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch24lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>