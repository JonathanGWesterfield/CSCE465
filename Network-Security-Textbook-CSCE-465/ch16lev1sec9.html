<html><head><title>16.9. Session Resumption</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec8.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec10.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch16lev1sec9"></a>
<h3 id="title-IDACZEVK" class="docSection1Title">16.9. Session Resumption</h3>
<p class="docText"><a name="iddle1827"></a><a name="iddle1988"></a>Another trick is the ability to bypass the initial expensive public key authentication if the server has recently authenticated the client and established a shared secret session key.</p>
<p class="docText">In Lotus Notes, Bob (the server) has a secret <span class="docEmphasis">S</span> that he shares with nobody, and changes periodically (once a month). After Bob authenticates Alice, he sends her a secret, <span class="docEmphasis">S</span><sub>Alice-Bob</sub>, which is a hash of her name and <span class="docEmphasis">S</span>, encrypted with her public key. Until Bob changes <span class="docEmphasis">S</span>, he'll give Alice the same <span class="docEmphasis">S</span><sub>Alice-Bob</sub> each time she is successfully authenticated. The actual session key (used for encryption and integrity protection) is a function of <span class="docEmphasis">S</span><sub>Alice-Bob</sub> and nonces sent by each side. If Alice shows knowledge of the <span class="docEmphasis">S</span><sub>Alice-Bob</sub> that would result from hashing <span class="docEmphasis">S</span> and her name, then Bob assumes he's authenticated her in the recent past, and they skip the expensive public key operations. If Bob has switched <span class="docEmphasis">S</span>s, then Alice's attempt to bypass the expensive authentication step will fail, and Alice and Bob will start from the beginning exchanging certificates, signing things, etc.</p>
<p class="docText">The Lotus Notes scheme is especially nice because it does not require Bob to keep state. Other protocols, such as SSL, allow session resumption, but require Bob to remember the Alice-Bob session secret.</p>
<p class="docText">Digital's DASS scheme (RFC 1507) had a different interesting method of bypassing the public key cryptography. During the handshake, Alice sends Bob the session key <span class="docEmphasis">S</span>, encrypted with Bob's public key and signed with Alice's private key. Call that quantity (the encrypted, signed <span class="docEmphasis">S</span>) <span class="docEmphasis">X</span><sub>Alice-Bob</sub>. If Bob remembers <span class="docEmphasis">X</span><sub>Alice-Bob</sub> from a recent Alice-Bob session, then he merely compares the received value from Alice with the stored <span class="docEmphasis">X</span><sub>Alice-Bob</sub>. If they match, he doesn't have to bother decrypting it to extract <span class="docEmphasis">S</span>. But if he doesn't remember it, or it's different from the stored one (perhaps because Alice doesn't remember the previous session, or wants to change keys), then he verifies Alice's signature and decrypts with his private key to obtain the new <span class="docEmphasis">S</span>. If Bob doesn't remember the previous session, but Alice does, then Alice still saves time. If they both remember the previous session, then they both save time. What's interesting about this protocol is that the protocol messages look the same whether state has been kept or not.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch16lev1sec8.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch16lev1sec10.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>