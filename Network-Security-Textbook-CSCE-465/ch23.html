<html><head><title>23. Firewalls</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="part05.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch23lev1sec1.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch23"></a>
<h2 id="title-IDA0FKAN" class="docChapterTitle">23. Firewalls</h2>
<p class="docText"><a name="iddle1384"></a>A <span class="docEmphStrong">firewall</span> (see <a class="docLink" href="#ch23fig01">Figure 23-1</a>) is a computer that sits between your internal network and the rest of the network and attempts to prevent bad things from happening (such as internal users sending company secrets outside, or outside people breaking into systems inside) without preventing good things from happening (such as employees accessing information available externally). It is sometimes called other things, like a security gateway, or various more colorful names thought up by frustrated network users when it prevents them from doing what they want to do.</p>
<a name="ch23fig01"></a><p><center>
<h5 class="docFigureTitle">Figure 23-1. Firewall</h5>
</center></p><p class="docText">
<img border="0" alt="" width="400" height="118" src="23fig01.jpg" /></p>
<br />
<p class="docText">Why is a firewall needed? It isn't if the systems on your internal network are properly secured, meaning that every system in the network has sophisticated authentication, the ability to do integrity-protected and encrypted communication whenever talking across the network, and is well-managed (when users rely on passwords, they choose good passwords; system accounts are not left with no password or a default password; all the latest security patches are installed; ...). Unfortunately many applications exist that were designed (and we use the term loosely) for an environment without bad guys, and most users view security (such as being forced to use long passwords) as an annoyance. Most corporate networks are not designed for security, and have survived because they have not been attacked. But now users want connectivity to the Internet. You want to be able to exchange mail with anyone. You want to occasionally share files. You want to communicate with publicly available services, and make some of your own services available to customers located outside your corporate network. But the Internet is a scary place. There are spies from unfriendly countries, users from competing companies, playful undergraduates, press people eager for a juicy scoop, criminals anxious to steal information for profit, disgruntled ex-employees, and vandals who attempt to compensate for their lack of a social life by annoying others.</p>
<p class="docText"><a name="iddle1377"></a><a name="iddle1391"></a><a name="iddle1880"></a><a name="iddle1922"></a><a name="iddle2053"></a>One of the reasons systems are hard to secure is that they provide so many services, many by default. You might think that a user workstation would only initiate requests to servers on the user's behalf, but most user workstations provide services like remote access to their file systems and configuration databases. This makes workstations easier to centrally manage and makes it easier to share files, but every service is a point of attack. Even if the services are properly configured to only serve authorized users, they could be missing bounds checks in their input parsers so that a clever attacker can send an ill-formed request and sometimes get access to things the service was not designed to provide. It's common for a user who wants to share a file with another user to make his entire file system remotely mountable (because that's easier than limiting access to a single user and a single file). Often, he intends that things only be opened for a short time, but he forgets and leaves his system exposed indefinitely.</p>
<p class="docText">Firewalls centrally manage access to services in ways that individual systems should but don't. They can enforce policies such as <span class="docEmphasis">systems outside the firewall can't access file services on any systems inside the firewall</span>. With such a restriction, even if the internal systems are more open than they should be or have bugs, they can't be attacked directly from systems outside the firewall.</p>
<p class="docText">Also, there are many ways to communicate with a system, since people keep coming up with mechanisms intended for debugging or convenience, and worse yet, many different ways of accomplishing the same purpose. In the university environment, in which a lot of these utilities were developed, it might have been reasonable to trust any message received. But each of these mechanisms is a potential new door into the system. Firewalls attempt to protect systems inside from attack from outside. But in order to do this, the firewall administrator needs to understand all the mechanisms and come up with some way of disallowing the dangerous ones without disabling the necessary ones.</p>
<p class="docText">Some example mechanisms include:</p>
<ul><li><p class="docList"><span class="docEmphasis">finger</span> (port 79), which gives information such as who is logged in, or when a specific user last logged in.</p></li><li><p class="docList"><span class="docEmphasis">telnet</span> (port 23), which allows someone to log into the system from across a network.</p></li><li><p class="docList"><span class="docEmphasis">rlogin</span> (port 513), similar to <span class="docEmphasis">telnet</span>, but UNIX-specific. Also, whereas <span class="docEmphasis">telnet</span> requires explicit user authentication, <span class="docEmphasis">rlogin</span> (along with a few other UNIX utilities known as <span class="docEmphBoldItalic">r</span> <span class="docEmphStrong">utilities</span>, such as <i><a class="docLink" href="app02.html#gloss01_193">rsh</a></i>) avoids the inconvenience of explicit user authentication by trusting that the source address in the IP header is correct, and if that address is known to be the address of a host trusted by this system, then anything that the message asserts about the identity of the user is believed.</p></li><li><p class="docList"><span class="docEmphasis">ftp</span> (port 21), which allows sharing of files. This protocol is tricky for firewalls because there are two connections madeÂone for control information and one for data. Although a host inside might initiate the transfer (in which case the firewall administrator would like to allow the transfer), the data connection is created by the other end. There is a modified version of <a name="iddle1443"></a><a name="iddle1467"></a><a name="iddle1812"></a><a name="iddle1894"></a><a name="iddle2136"></a>the ftp protocol (called <span class="docEmphStrong">passive ftp</span>) in which both connections originate at the requester in order to make firewall logic easier; but until it is deployed everywhere, firewalls will need to deal with the original ftp.</p></li><li><p class="docList"><span class="docEmphasis">X Windows</span> (port 177), which (like <span class="docEmphasis">telnet</span> and <span class="docEmphasis">rlogin</span>) allows you to interact with a remote machine, but the display assumes a real monitor that can handle colors and fonts, rather than a &quot;dumb terminal&quot;.</p></li><li><p class="docList">ICMP (Internet Control Message Protocol, RFC 792), is a protocol for sending messages to a node informing it of various conditions. There is no authentication of an ICMP message. ICMP packets can be recognized because the PROTOCOL field in the IP header is equal to 1. The other mechanisms run on top of TCP or UDP, and therefore can be distinguished based on the PORT field in the layer 4 header. Examples of ICMP messages a system Alice might receive include:</p><ul><li><p class="docList">notification that some packet Alice had previously sent can't be delivered because the destination address, or an entire range of addresses including the destination's, is unreachable.</p></li><li><p class="docList">a <span class="docEmphasis">redirect</span>, telling Alice to use a particular router for forwarding to a particular address, presumably because the router Alice chose on a previous packet was not the best path to the destination.</p></li><li><p class="docList">a <span class="docEmphasis">ping</span>, which is supposed to be echoed back by the system that receives it. Ping is useful for seeing if a system is alive and reachable.</p></li></ul></li></ul>
<p class="docText">Notice that there are many ways of doing the same thing. To be logged into a remote machine, one might use <span class="docEmphasis">telnet</span>, <span class="docEmphasis">rlogin</span>, or the <span class="docEmphasis">X Windows</span> utility. None of these utilities were designed to be secure. <span class="docEmphasis">rlogin</span> is a particularly egregious example. Its primary &quot;advantage&quot; over <span class="docEmphasis">telnet</span> is that you often won't have to type your username or password. There is a file on a UNIX machine (called /etc/hosts.equiv) that lists IP addresses or host names (from which the IP address will be looked up in DNS). The hosts listed in that file are trusted to assert any user identity, and no password is required. The only authentication of the machine is that the IP header contains the trusted machine's IP address. Also, each user can have in his home directory a file named .rhosts which lists IP addresses or host names that are trusted to assert that user's identity without a password. This allows any user to open up access to his own account without administrative supervision. It also gives this right to any program the user runs.</p>
<p class="docText">If one machine is compromised inside your network, the firewall cannot help, since so many other machines, otherwise well-managed, will trust anything coming from the compromised machine.</p>
<p class="docText">A lot of the above utilities are dangerous. For instance, ICMP <span class="docEmphasis">ping</span> can be exploited to find machines to break into. Sending an ICMP message to Alice saying that some range of addresses is <a name="iddle1015"></a><a name="iddle1055"></a><a name="iddle1599"></a><a name="iddle1757"></a>unreachable will cause Alice to hang up its connections to machines in the range specified by that ICMP message. Redirects can be used to cause a host to send traffic in a different direction, perhaps towards a compromised machine, making man-in-the-middle attacks easier. Finger can be used to find accounts to start attacking (searching the password space), or more ominously, to find personal information about users.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="part05.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch23lev1sec1.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>