<html><head><title>10.3. Off-Line Password Guessing</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch10lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch10lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch10lev1sec3"></a>
<h3 id="title-IDAZXJZL" class="docSection1Title">10.3. Off-Line Password Guessing</h3>
<p class="docText">In the previous section, we discussed on-line password guessing, where guessing can be slowed down and audited. Passwords do not have to be very strong if the only threat is on-line password guessing. But sometimes it is possible for an attacker, through either eavesdropping or reading a database, to obtain a cryptographic hash of the password or a quantity encrypted with the password. In such a case, even though the attacker cannot reverse the hash of the password, the attacker can guess a password, perform the same hash, and compare it with the stolen quantity. Once the attacker has obtained the hash of the password, the attacker can perform password guessing without anyone knowing it, and at a speed limited only by procurable compute power.</p>
<p class="docText">We've talked a lot about how users should protect their passwords. Remember that passwords must be stored in two placesÂusers must know their own, and systems must be able to verify passwords. If the system simply directly stores passwords, the password list on a system must be protected at least as well as anything else on the system. Even that is not sufficient. Most systems keep backup tapes for use in the case where a disk fails or a user accidentally destroys a file. If those tapes contain password lists, they must be protected as carefully as the system; anyone who can read them will subsequently be able to impersonate all users.</p>
<p class="docText">Several techniques can lessen this threat. Some operating systems, for instance UNIX and VMS, do not store actual user passwords. They take passwords as typed, run them through a <a name="iddle1774"></a>one-way algorithm such as a cryptographic hash, and store the results. With such a system, the password file needs to be carefully protected from modification, but disclosure of the file is not immediately of use to an attacker. Standard UNIX systems, in fact, place such confidence in this technique that they make the password file publicly readable. This turns out to be a bad idea. Even though it is impossible to compute the password from the hash, it is possible to guess a password and verify whether you got it right by hashing it and comparing it to the stored value. This gives attackers an unaudited and fairly high-performance way of guessing passwords. Many systems have now been modified to prevent unprivileged programs from reading the password file. Another interesting downside of this technique is that if a user forgets a password, the system administrator can't look it up. Instead, the user must choose a new password and the system administrator must install it. The only time this is a problem is when an attacker has changed the user's password but the user isn't sure whether it was changed nefariously or merely forgotten. Being able to read the old value might make it easier to tell the difference.</p>
<a name="ch10sb01"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">Password Hash Quirk</h2>
<p class="docText">There was an operating system (which we'll allow to remain nameless) that stored hashes of passwords, and the password hash used by that operating system had an interesting property. We are purposely not giving the exact details, but the general idea is that there was a magic character sequence <span class="docEmphasis">X</span> such that the hash of any string <span class="docEmphasis">S</span> was the same as the hash of <span class="docEmphasis">X</span> concatenated with <span class="docEmphasis">S</span>. This is not exactly a security flaw, but instead is a wonderfully user-friendly feature. How can this odd feature be useful?</p>
<p class="docText">Suppose the system administrator made the common policy decision that user passwords had to be some minimum length. This particular operating system enforced the policy only when you set your password (as opposed to when you logged in). Now suppose you wanted a password you could type quickly, like <span class="docEmphRomanAlt">FOO</span>. The operating system would not let you set your password to <span class="docEmphRomanAlt">FOO</span> because it's not long enough. But it would let you set it to <span class="docEmphasis">X</span> concatenated with <span class="docEmphRomanAlt">FOO</span>. Let's say the magic string was <span class="docEmphRomanAlt">%#v27dR678riwueyru3ir3</span>. You'd set your password to <span class="docEmphRomanAlt">%#v27dR678riwueyru3ir3FOO</span>. That would be the last time you'd have to type <span class="docEmphRomanAlt">%#v27dR678riwueyru3ir3FOO</span>. From then on, <span class="docEmphRomanAlt">FOO</span> would work just fine, since the hash of <span class="docEmphRomanAlt">FOO</span> is the same as the hash of <span class="docEmphRomanAlt">%#v27dR678riwueyru3ir3FOO</span>.</p>
</td></tr></table></p><br />
<p class="docText">When disclosure of whole files full of hashed passwords is a concern, another useful technique is to apply <span class="docEmphasis">salt</span>. Rather than guessing passwords against a single user account, an attacker with a file full of hashed passwords might hash all the words in a dictionary and check to see whether any of the passwords match any of the stored hashed values. This would be a much more efficient means of attack, particularly when the attacker just wanted any account on the system or, <a name="iddle1771"></a><a name="iddle1777"></a><a name="iddle1946"></a>more likely, as many accounts as possible on the system. Tests at universities have shown 30% hit rates with fairly small dictionaries. A way to slow down such an attacker is as follows:</p>
<p class="docText">When a user chooses a password, the system chooses a random number (the <b><a class="docLink" href="app02.html#gloss01_195">salt</a></b>). It then stores both the salt and a hash of the combination of the salt and the password. When the user supplies a password during authentication, the system computes the hash of the combination of the stored salt and the supplied password, and checks the computed hash against the stored hash. The presence of the salt does not make it any harder to guess any one user's password, but it makes it impossible to perform a single cryptographic hash operation and see whether a password is valid for any of a group of users.</p>
<p><table cellspacing="0" class="allBorders" border="1" rules="none" cellpadding="5"><colgroup align="left" span="3"><col width="100"></col><col width="150"></col><col width="200"></col></colgroup><thead></thead><tr><td class="docTableCell" align="center" valign="top"><p class="docText">user ID</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">salt value</p></td><td class="docTableCell" align="center" valign="top"><p class="docText">password hash</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Mary</p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">2758</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">hash(<span class="docEmphRomanAlt">2758</span>|password<sub>Mary</sub>)</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">John</p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">886d</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">hash(<span class="docEmphRomanAlt">886d</span>|password<sub>John</sub>)</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Ed</p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">5182</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">hash(<span class="docEmphRomanAlt">5182</span>|password<sub>Ed</sub>)</p></td></tr><tr><td class="docTableCell" align="center" valign="top"><p class="docText">Jane</p></td><td class="docTableCell" align="center" valign="top"><p class="docText"><span class="docEmphRomanAlt">1763</span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">hash(<span class="docEmphRomanAlt">1763</span>|password<sub>Jane</sub>)</p></td></tr></table></p><br />
<p class="docText">Another technique is to encrypt the password file. This doesn't eliminate the problem of keeping passwords secret; it just reduces it to the problem of protecting the key that decrypts the password file. This might be done by having the key held in operating system memory, not backed up to disk or tape, and having it either stored in special nonvolatile memory in the machine or reentered by the operator on boot-up.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch10lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch10lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>