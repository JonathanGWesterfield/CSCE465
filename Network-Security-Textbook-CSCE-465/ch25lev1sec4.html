<html><head><title>25.4. HTTP Digest Authentication</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch25lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch25lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch25lev1sec4"></a>
<h3 id="title-IDAYF4FV" class="docSection1Title">25.4. HTTP Digest Authentication</h3>
<p class="docText">One could certainly use SSL in order to protect the client/server communication, but SSL is expensive, and doesn't in general provide authentication of the user. So HTTP has a &quot;low budget&quot; method of authenticating the user, which we describe in this section. The HTTP authentication can be used in combination with SSL, so for instance, if the authentication method involves sending the user-name and password in the clear, using that method in combination with SSL certainly improves security.</p>
<p class="docText">Because sending the username and password in the clear on every request to the server is not a particularly secure thing to do, methods of using cryptography, both for authenticating the user and for integrity protecting the data, were added. There are some challenges faced when designing cryptographic protection for HTTP:</p>
<ul><li><p class="docList">HTTP is stateless.</p></li><li><p class="docList">What needs to be authenticated is the user, who might be connecting from a machine that has no user-specific configuration information, such as a cryptographic key for the user. So the exchange is based on passwords.</p></li><li><p class="docList">A lot of requests might be made to the same server, and it would be nice to allow most of them to work without an extra round trip in order to receive a challenge.</p></li><li><p class="docList">It would be nice to design it so that someone who steals the server database cannot use the information to impersonate the user on that server.</p></li><li><p class="docList">It would be nice to design it so that theft of one server's database would not allow someone to impersonate the user on a different server, even if she used the same password on that other server.</p></li></ul>
<p class="docText">Assume a client Alice is going to make a request of a server Bob. Assume the user Alice is on a machine that currently has no state about her. She requests a resource on Bob that requires authentication. Her browser has no way of knowing this, so the request does not contain any authentication information (i.e., has no HTTP <span class="docEmphSmaller">AUTHORIZATION</span> field). Bob returns a response with a status code (401) indicating that the request failed because it was &quot;unauthorized&quot;, and includes the WWW-<span class="docEmphSmaller">AUTHENTICATE</span> field that specifies what authentication method the server wants, such as <span class="docEmphRomanAlt">WWW-Authenticate: Digest</span></p>
<p class="docText">The response also has to contain additional information, such as a nonce to be folded into the hash. The browser now prompts the user for her name and password (for that server), uses it to form a new request, this time containing the <span class="docEmphSmaller">AUTHORIZATION</span> field containing the proper cryptographic combination of the user's password, the nonce, the URL, and other information, and caches the user's name and password for future interactions with that server. The next time a request is made to the same server, since the browser would have the user's name and password and other necessary information cached, the browser constructs information for the <span class="docEmphSmaller">AUTHORIZATION</span> field without bothering the user.</p>
<p class="docText">In order to prevent an eavesdropper from simply stealing the information from one request and including it with another request, the protocol could require the browser to obtain a new nonce for each request. But that would require an extra round trip. So instead, the browser reuses the nonce, but increments a counter known as the nonce count. If the server wants to protect against replays of requests, the server stores successfully used (nonce, nonce count) values and rejects a request with a previously used nonce count value. It can cut corners, though, without too much loss of security (see <a class="docLink" href="ch25lev1sec7.html#ch25qa1qe3">Homework Problem 3</a> through <a class="docLink" href="ch25lev1sec7.html#ch25qa1qe6">Homework Problem 6</a>).</p>
<p class="docText">HTTP digest authentication is designed so that the server does not store the actual user password, but instead a hash of the user's password and the server name (or perhaps realm name, if there are a bunch of equivalent servers that can be grouped together for security purposes.) This way the server stores a password-equivalent for that server, but it would only work on that server (or in that realm). Therefore theft of the server database would allow someone to impersonate someone in that realm, but not in a different realm, even if the user used the same password.</p>
<p class="docText">The browser stores, for each server that requires authentication, the server name, the user's name and password, the nonce received from the server, the authentication method desired, and the nonce count. When a request goes to that server, the browser constructs the data for the <span class="docEmphSmaller">AUTHORIZATION</span> field, incrementing the nonce count.</p>
<p class="docText">One extra wrinkle is the ability not only to authenticate the user, but to integrity protect the data. In addition to sending a nonce, the server can specify whether it would like integrity protection, by including a field <span class="docEmphRomanAlt">QOP=&quot;auth&quot;</span>, or <span class="docEmphRomanAlt">QOP=&quot;auth-int&quot;</span>, or <span class="docEmphRomanAlt">QOP=&quot;auth,auth-int&quot;</span>. <span class="docEmphRomanAlt">QOP</span> <a name="iddle1209"></a>means <span class="docEmphasis">quality of protection</span>, and <span class="docEmphRomanAlt">auth</span> means <i><a class="docLink" href="app02.html#gloss01_014">authentication</a></i> <span class="docEmphasis">only</span>, <span class="docEmphRomanAlt">auth-int</span> means <span class="docEmphasis">authentication and integrity</span>, and <span class="docEmphRomanAlt">auth,auth-int</span> means <span class="docEmphasis">do integrity if you can, but authentication only would be acceptable</span>. These names are misleading. <span class="docEmphRomanAlt">auth</span> sounds like it's only doing authentication, but in fact at least part of the URL is also protected, and in a GET request, <span class="docEmphRomanAlt">auth-int</span> wouldn't protect any more than that. And <span class="docEmphRomanAlt">auth-int</span> sounds like it's protecting everything, when in fact the only extra thing protected is the body of the message. Left out of the integrity protection are cookies and fields such as <span class="docEmphSmaller">REFERER</span>.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch25lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch25lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>