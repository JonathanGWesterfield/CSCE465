<html><head><title>19.10. Negotiating Cipher Suites</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch19lev1sec9.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch19lev1sec11.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch19lev1sec10"></a>
<h3 id="643999-818" class="docSection1Title">19.10. Negotiating Cipher Suites</h3>
<p class="docText">A cipher suite is a complete package (encryption algorithm, key length, integrity checksum algorithmÂwhatever needs to be defined in order to completely specify all the crypto SSL/TLS will need). Cipher suites are predefined and each is assigned a numeric value. In SSLv2 the value is 3 octets long, but in SSLv3 and TLS, it's 2 octets. This mercifully limits the number of suites that could potentially be defined in SSLv3/TLS to about 65000.</p>
<p class="docText">There are about 30 defined cipher suites, and there are 256 values reserved for private use (the ones with the most significant octet = ff<sub>16</sub>. Private use values that have no way of coordinating their use are dangerous. You can define your own suite and choose any number out of the 256 reserved numbers for describing it. But there's no guarantee someone else won't define their own private suite and choose the same number. If two such systems attempt to talk, they'll think they are agreeing on the same suite, but in fact they will not interoperate.</p>
<p class="docText">In v2, each cipher suite had a 3-octet value. In v3, each is 2 octets. The way to specify a v3 cipher suite in the 3-octet v2 field is to set the most significant octet to 0, and have the v3 cipher suite value in the remaining 2 octets. Luckily, no v2 cipher suites had been defined with the most significant octet=0, so there was a convenient block of 2<sup>16</sup> unused cipher suite values.</p>
<a name="ch19lev2sec1"></a>
<h4 id="title-IDATYU5D" class="docSection2Title">19.10.1. Who Makes the Decision?</h4>
<p class="docText">In SSLv2, Bob returns the subset of Alice's suggested cipher suites that he is willing to support, but lets Alice make the final choice and announce it in message 3. (This is kind of silly, since Alice already said she'd support everything in her list. Bob should just pick one. Indeed one of the enhancements in SSLv3 is that Bob does make the choice, from the list Alice sent. If there's more than one that both he and Alice find acceptable, he makes the decision. And he could in theory make the decision in v2 by only returning one cipher suite rather than many.)</p>
<p class="docText">Not all supportable crypto suites are equal. The side choosing the suite will choose the most desirable (perhaps the strongest, or the fastest) one it can from the set of crypto suites that both sides support. An exportable suite is chosen only as a last resort (since the exportable suites are purposely weak).</p>
<a name="ch19lev2sec2"></a>
<h4 id="title-IDABZU5D" class="docSection2Title">19.10.2. Cipher Suite Names</h4>
<p class="docText">Although cipher suites have 2-octet (or 3-octet in SSLv2) identifiers, they are referred to in the spec by names such as <span class="docEmphRomanAlt">SSL_RSA_EXPORT_WITH_DES40_CBC_SHA</span>:</p>
<ul><li><p class="docList"><span class="docEmphRomanAlt">SSL</span> means SSLv3, (the SSLv2 cipher suites have names starting with SSL2, e.g., SSL2_RC4_128_WITH_MD5),</p></li><li><p class="docList"><span class="docEmphRomanAlt">RSA</span> means RSA,</p></li><li><p class="docList"><span class="docEmphRomanAlt">EXPORT</span> means it's exportable (i.e., weak crypto, exportable before the rules were relaxed),</p></li><li><p class="docList"><span class="docEmphRomanAlt">WITH</span> means the names weren't long enough,</p></li><li><p class="docList"><a name="iddle1051"></a><a name="iddle1070"></a><a name="iddle1297"></a><a name="iddle2097"></a><span class="docEmphRomanAlt">DES40</span> means DES with 40 bit keys,</p></li><li><p class="docList"><span class="docEmphRomanAlt">CBC</span> means CBC-mode encryption, and</p></li><li><p class="docList"><span class="docEmphRomanAlt">SHA</span> means HMAC-SHA is used for the MAC.</p></li></ul>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch19lev1sec9.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch19lev1sec11.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>