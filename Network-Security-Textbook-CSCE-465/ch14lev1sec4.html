<html><head><title>14.4. Ticket Lifetimes</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch14lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch14lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch14lev1sec4"></a>
<h3 id="643999-981" class="docSection1Title">14.4. Ticket Lifetimes</h3>
<p class="docText"><a name="iddle1906"></a><a name="iddle2077"></a>In V4, the maximum lifetime of a ticket was about 21 hours, since the time in a ticket was encoded as a four-octet start time and a one-octet lifetime (in units of 5 minutes). This was too short for some applications. In Kerberos V5, tickets can be issued with virtually unlimited lifetimes (the farthest in the future that can be specified with a V5 timestamp is Dec 31, 9999). The timestamp format is an ASN.1-defined quantity that is 17 octets long. Although it has a virtually unlimited lifetime (unlike the V4 timestamp), it is only in seconds, and Kerberos V5, in some cases, would have preferred time expressed down to microseconds. As a result, much of the time when Kerberos V5 passes around a timestamp it also passes around a microsecond time, which is an ASN.1 integer whose representation requires sufficiently many octets to express the value (in this case one to three octets, since 999999 is the biggest value), plus a type and length.</p>
<p class="docText">Long-lived tickets pose serious security risks, because once created they cannot be revoked (except perhaps by invalidating the master key of the service to which the ticket was granted). So V5 has a number of mechanisms for implementing revocable long-lived tickets.</p>
<p class="docText">These mechanisms involve use of several timestamp fields in tickets (and TGTs). Each timestamp is encoded, using glorious ASN.1 format, in 17 octets of information. First we'll give the names of the timestamps, and then we'll explain how they're used:</p>
<ul><li><p class="docList"><span class="docEmphSmaller">START-TIME</span>Âtime the ticket becomes valid.</p></li><li><p class="docList"><span class="docEmphSmaller">END-TIME</span>Âtime the ticket expires.</p></li><li><p class="docList"><span class="docEmphSmaller">AUTHTIME</span>Âtime at which Alice first logged in, i.e., when she was granted an initial TGT (one based on her password). <span class="docEmphSmaller">AUTHTIME</span> is copied from her initial TGT into each ticket she requests based on that TGT.</p></li><li><p class="docList"><span class="docEmphSmaller">RENEW-TILL</span>Âlatest legal end-time (relevant for renewable tickets, see below).</p></li></ul>
<a name="ch14lev2sec1"></a>
<h4 id="title-IDAPXJCE" class="docSection2Title">14.4.1. Renewable Tickets</h4>
<p class="docText">Rather than creating a ticket valid for say, 100 years, the KDC can give Alice a ticket that will be valid for 100 years, but only if she keeps renewing it, say once a day. Renewing a ticket involves giving the ticket to the KDC and having the KDC reissue it. If there is some reason to want to revoke Alice's privileges, this can be done by telling the KDC not to renew any of Alice's tickets.</p>
<p class="docText">The KDC is configured with a maximum validity time for a ticket, say a day. If there is a reason for Alice's ticket to be valid for longer than that time, then when Alice requests the ticket, the KDC sets the <span class="docEmphSmaller">RENEWABLE</span> flag inside the ticket. The <span class="docEmphSmaller">RENEW-TILL</span> time specifies the time beyond which the ticket cannot be renewed.</p>
<p class="docText"><a name="iddle1834"></a>In order to keep using the ticket, Alice will have to keep renewing it before it expires. If she is ever late renewing it, the KDC will refuse to renew it. Why did Kerberos choose to do it that way? It seems somewhat inconvenient. Node Alice has to keep a demon running checking for tickets that will expire soon, and renew them. If Kerberos allowed renewal of expired tickets, then Alice could wait until she attempts to use a ticket and gets an error message indicating the ticket expired, and then renew it. This would be more convenient. The reasoning in Kerberos is that if Alice could present a ticket a long time after it expired, then if the KDC has been told to revoke the ticket it would have to remember the revoked ticket until that ticket's <span class="docEmphSmaller">RENEW-TILL</span> time. As it is, it just has to remember the revoked ticket for a maximum validity time.</p>
<p class="docText">The <span class="docEmphSmaller">END-TIME</span> specifies the time at which the ticket will expire (unless renewed). When Alice gives the KDC a renewable ticket and requests that it be renewed, the KDC does this by changing <span class="docEmphSmaller">END-TIME</span> to be the maximum ticket lifetime as configured into the user's entry in the KDC database, added to the current time (but not greater than <span class="docEmphSmaller">RENEW-TILL</span>).</p>
<a name="ch14lev2sec2"></a>
<h4 id="title-IDAGZJCE" class="docSection2Title">14.4.2. Postdated Tickets</h4>
<p class="docText">Postdated tickets are used to run a batch job at some time in the future. Suppose you want to issue a ticket starting a week from now and good for two hours. One possible method is to issue a ticket with an expiration time of one week plus two hours from the present time, but that would mean the ticket would be valid from the time it was issued until it expired. Kerberos instead allows a ticket to become valid at some point in the future. Kerberos does this by using the <span class="docEmphSmaller">START-TIME</span> timestamp, indicating when the ticket should first become valid. Such a ticket is known as a <span class="docEmphStrong">postdated ticket</span>.</p>
<p class="docText">In order to allow revocation of the postdated ticket between the time it was issued and the time it becomes valid, there's an <span class="docEmphSmaller">INVALID</span> flag inside the ticket that Kerberos sets in the initially issued postdated ticket. When the time specified in <span class="docEmphSmaller">START-TIME</span> occurs, Alice can present the ticket to the KDC and the KDC will clear the <span class="docEmphSmaller">INVALID</span> flag. This additional step gives the opportunity to revoke the postdated ticket by warning the KDC. If the KDC is configured to revoke the postdated ticket, the validation request will fail.</p>
<p class="docText">There's an additional flag inside the ticket, the <span class="docEmphSmaller">POSTDATED</span> flag, which indicates that the ticket was originally issued as a postdated ticket. An application could in theory refuse to accept such a ticket, but none currently do and we can't imagine why any applications would care.</p>
<p class="docText">A flag, <span class="docEmphSmaller">MAY-POSTDATE</span>, which appears in a TGT, indicates whether the KDC is allowed to issue postdated tickets using this TGT.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch14lev1sec3.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch14lev1sec5.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>