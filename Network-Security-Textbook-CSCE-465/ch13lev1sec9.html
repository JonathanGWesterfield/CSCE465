<html><head><title>13.9. Encryption for Privacy and Integrity</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch13lev1sec8.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch13lev1sec10.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch13lev1sec9"></a>
<h3 id="title-IDAKKQ3D" class="docSection1Title">13.9. Encryption for Privacy and Integrity</h3>
<p class="docText">Many of the data structures that Kerberos encrypts need to be protected from both disclosure and modification. In a ticket, for example, the <span class="docEmphSmaller">KEY</span> field needs to be protected from both disclosure and modification, and the <span class="docEmphSmaller">NAME</span> and <span class="docEmphSmaller">EXPIRATION</span> fields need to be protected from modification.</p>
<p class="docText">Unfortunately, there is no standard mechanism for protecting both the confidentiality and integrity of a message with a single cryptographic pass. Generally the most useful way to protect the confidentiality of a message is to encrypt it in CBC mode (see &sect;<a class="docLink" href="ch04lev1sec2.html#ch04lev2sec2">4.2.2</a> <span class="docEmphasis">Cipher Block Chaining (CBC)</span>). The most standard way to protect its integrity is with a CBC residue. But securely applying both of these techniques would require double the encryption effort and two separate keys (see &sect;<a class="docLink" href="ch04lev1sec3.html#ch04lev2sec6">4.3.1</a> <span class="docEmphasis">Ensuring Privacy and Integrity Together</span>).</p>
<p class="docText">Intuitively, it seems like it should be possible to make do with a single cryptographic pass by including some redundant information in the message to be encrypted and then to have the integrity of the message protected by having the recipient check that the redundancy is correctly done. A number of schemes have been proposed for doing this. Many have been found to have cryptographic weaknesses. None has gained general acceptance. The designers of Kerberos came up with their own variation on this theme, and subsequently cryptographic flaws were found with it. The <a name="iddle1787"></a><a name="iddle1826"></a>flaws were not so egregious as to justify recalling Kerberos V4; however, a different approach is followed in Kerberos V5.</p>
<p class="docText">One method for using DES on a long message is CBC. CBC does a good job on privacy. An intruder will not gain any information from analysis of the encrypted blocks. However, there is no integrity check that Kerberos can do to assure an application that the data was not tampered with. If an intruder were to modify block c<span class="docEmphasis"><sub>n</sub></span>, then <span class="docEmphasis">m<sub>n</sub></span> would be garbage, as would <span class="docEmphasis">m</span><sub><span class="docEmphasis">n</span>+1</sub>, but starting from <span class="docEmphasis">m</span><sub><span class="docEmphasis">n</span>+2</sub> everything would decrypt properly. Kerberos would not be able to detect that <span class="docEmphasis">m<sub>n</sub></span> and <span class="docEmphasis">m</span><sub><span class="docEmphasis">n</span>+1</sub> had been garbled. Some applications might be able to tell, but Kerberos would like to provide the integrity assurance without depending on the application.</p>
<p class="docText">Therefore, Kerberos did a modified version of CBC which they called <span class="docEmphStrong">Plaintext Cipher Block Chaining</span> (<span class="docEmphStrong">PCBC</span>). It is similar to CBC except that in addition to <img src="U2295.GIF" border="0" />ing <span class="docEmphasis">c<sub>n</sub></span> with <span class="docEmphasis">m</span><sub><span class="docEmphasis">n</span>+1</sub>, <span class="docEmphasis">m<sub>n</sub></span> is also <img src="U2295.GIF" border="0" />'d. In other words, in CBC, <span class="docEmphasis">m</span><sub><span class="docEmphasis">n</span>+1</sub> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">c<sub>n</sub></span> is encrypted to yield <span class="docEmphasis">c</span><sub><span class="docEmphasis">n</span>+1</sub>. In PCBC, <span class="docEmphasis">m</span><sub><span class="docEmphasis">n</span>+1</sub> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">c<sub>n</sub></span> <img src="U2295.GIF" border="0" /> <span class="docEmphasis">m<sub>n</sub></span> is encrypted to yield <span class="docEmphasis">c</span><sub><span class="docEmphasis">n</span>+1</sub>.</p>
<a name="ch13fig05"></a><p><center>
<h5 class="docFigureTitle">Figure 13-5. Plaintext Cipher Block Chaining (PCBC)</h5>
</center></p><p class="docText">
<img border="0" alt="" id="118095009249" width="500" height="140" src="13fig05.jpg" /></p>
<br />
<p class="docText">PCBC has the property that modifying any <span class="docEmphasis">c<sub>i</sub></span> will result in garbling of all decrypted plaintext blocks starting with <span class="docEmphasis">m<sub>i</sub></span> all the way to the end. Kerberos puts some recognizable data at the end of a message that it will encrypt so that it can recognize whether the final block decrypts properly. It makes the assumption that if the final block decrypts properly, then the data has not been tampered with between the time it was transmitted by the source and received by the destination.</p>
<p class="docText">However, using PCBC and checking the contents of the final decrypted block does not guarantee that Kerberos will be able to detect message corruption. For instance, if an intruder were to swap two adjacent blocks, PCBC will &quot;get back in sync&quot; after those two blocks, and the final block will decrypt properly (see <a class="docLink" href="ch13lev1sec13.html#ch13lev1sec13">Homework Problem 5</a>).</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch13lev1sec8.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch13lev1sec10.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>