<html><head><title>15.7. X.509 and PKIX Certificates</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch15lev1sec6.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch15lev1sec8.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch15lev1sec7"></a>
<h3 id="title-IDAWLFUJ" class="docSection1Title">15.7. X.509 and PKIX Certificates</h3>
<p class="docText">An X.509 certificate contains the following information:</p>
<ul><li><p class="docList"><span class="docEmphSmaller">VERSION</span>. There are currently three versions defined, version 1 for which the code is <span class="docEmphRomanAlt">0</span>, version 2 for which the code is <span class="docEmphRomanAlt">1</span>, and version 3 for which the code is <span class="docEmphRomanAlt">2</span>.</p></li><li><p class="docList"><span class="docEmphSmaller">SERIAL</span>N<span class="docEmphSmaller">UMBER</span>. An integer that, together with the issuing CA's name, uniquely identifies this certificate. (Note it's illegal according to the spec to issue two certificates with the same serial number, but that doesn't mean someone can't misuse the CA's key and do just that, in which case it would not, of course, uniquely identify the certificate.)</p></li><li><p class="docList"><span class="docEmphSmaller">SIGNATURE</span>. Deceptively named, this specifies the algorithm used to compute the signature on this certificate. It consists of a subfield identifying the algorithm followed by optional parameters for the algorithm.</p></li><li><p class="docList"><span class="docEmphSmaller">ISSUER</span>. The X.500 name of the issuing CA.</p></li><li><p class="docList"><span class="docEmphSmaller">VALIDITY</span>. This contains two subfields, the time the certificate becomes valid, and the last time for which it is valid.</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>. The X.500 name of the entity whose key is being certified. This field is mandatory in X.509 but PKIX manages to make it optional, while still being conformant with X.509, by saying that it is allowed to be an empty sequence, which is kind of like a null string but in ASN.1 it takes two octets to specify. In PKIX it is permitted to utilize the optional <span class="docEmphSmaller">SUBJECT</span>A<span class="docEmphSmaller">LT</span>N<span class="docEmphSmaller">AME</span> extension to name things according to the way that Internet applications would want to name things (such as using a DNS name).</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>P<span class="docEmphSmaller">UBLIC</span>K<span class="docEmphSmaller">EY</span>I<span class="docEmphSmaller">NFO</span>. This contains two subfields, an algorithm identifer (itself containing two subfields, one identifying the algorithm and the other providing optional parameters for it), and the subject's public key.</p></li><li><p class="docList"><span class="docEmphSmaller">ISSUER</span>U<span class="docEmphSmaller">NIQUE</span>I<span class="docEmphSmaller">DENTIFIER</span>. Optional (permitted only in version 2 and version 3, but deprecated (i.e., recommended against being used) in PKIX). Uniquely identifies the issuer of this certificate.</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>U<span class="docEmphSmaller">NIQUE</span>I<span class="docEmphSmaller">DENTIFIER</span>. Optional (permitted only in version 2 and version 3, but deprecated (i.e., recommended against being used) in PKIX). Uniquely identifies the subject of this certificate.</p></li></ul>
<p class="docText">The purpose of the optional <span class="docEmphSmaller">UNIQUE</span>I<span class="docEmphSmaller">DENTIFIER</span> fields is to eliminate the possibility of confusion when a name is reused. For example, John Smith might leave an organization and then the organization might hire another John Smith, assigning the new John Smith the same X.500 name.</p>
<blockquote>
<p class="docText"><span class="docEmphasis">The author of that poem is either Homer or, if not Homer, somebody else of the same name.</span></p>
<p class="docText">ÂAldous Huxley</p></blockquote>
<ul><li><p class="docList"><span class="docEmphSmaller">ALGORITHM</span>I<span class="docEmphSmaller">DENTIFIER</span>. This repeats the <span class="docEmphSmaller">SIGNATURE</span> field. This field is completely and utterly redundant and didn't need to be there. PKIX renamed this field <span class="docEmphSmaller">SIGNATURE</span>A<span class="docEmphSmaller">LGORITHM</span> rather than removing it.</p></li><li><p class="docList"><span class="docEmphSmaller">ENCRYPTED</span>. Perhaps it would have been better to call this field <i><a class="docLink" href="app02.html#gloss01_205">signature</a></i>. But that name was already taken. Anyway, this field contains the signature on all but the last of the above fields. PKIX boldly renamed it to <span class="docEmphSmaller">SIGNATURE</span>V<span class="docEmphSmaller">ALUE</span>.</p></li><li><p class="docList"><a name="iddle1337"></a><span class="docEmphSmaller">EXTENSIONS</span>. These are only in X.509 version 3. X.509 allows arbitrary extensions, since they are defined by OID. PKIX recommends the following. Remember, these are extensions agreed upon by a large committee of people before products seriously used any of these features, so most likely a lot of them will prove not to be terribly useful:</p><ul><li><p class="docList"><span class="docEmphSmaller">AUTHORITY</span>K<span class="docEmphSmaller">EY</span>I<span class="docEmphSmaller">DENTIFIER</span>. This identifies the key of the CA that signed this certificate. PKIX specifies that it should be a number that, together with the CA's name, uniquely identifies the key.</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>K<span class="docEmphSmaller">EY</span>I<span class="docEmphSmaller">DENTIFIER</span>. This is typically a hash of the subject's public key, but it can be anything that, together with the subject's name, uniquely identifies the key. So even a sequence number is OK. The purpose of this field is to match against the identifier that the subject will use in the <span class="docEmphSmaller">AUTHORITY</span>K<span class="docEmphSmaller">EY</span>I<span class="docEmphSmaller">DENTIFIER</span> field if the subject signs a certificate with this key.</p></li><li><p class="docList"><span class="docEmphSmaller">KEY</span>U<span class="docEmphSmaller">SAGE</span>. A bit string in which each bit specifies something for which the subject is allowed to use the key. There are nine defined, for uses such as signatures, key <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_083">encipherment</a></span> (the usual case of encryption with a public key, where you use the key to encrypt a secret key), data encipherment (if the data were short enough that you'd want to directly encrypt with the public key), signing X.509 certificates (which gives the subject permission to be a CA), and CRL signing (which is used to indicate the key is used for signing CRLs). CRLs are signed with the same issuer name as the CA, but usually with a different key. So the CA typically signs a certificate with its own name (and different key) as subject, without permission to sign certificates but with permission to sign CRLs.</p></li><li><p class="docList"><span class="docEmphSmaller">PRIVATE</span>K<span class="docEmphSmaller">EY</span>U<span class="docEmphSmaller">SAGE</span>P<span class="docEmphSmaller">ERIOD</span>. This contains two timestamps (which are the four-digit-year variety since there was no backward compatibility issue). Note that the <span class="docEmphSmaller">VALIDITY</span> field already specifies when the key is supposed to be valid for. Apparently someone thought it would be useful to specify the interval when the subject is allowed to be using the key separately from the interval when the subject's certificate is valid. The conceivable use of thisÂand it's a stretchÂis that the subject is allowed to use the key for a shorter time than verifiers might want to be able to verify the signature.</p></li><li><p class="docList"><span class="docEmphSmaller">CERTIFICATE</span>P<span class="docEmphSmaller">OLICIES</span>. This is a sequence of OIDs, and, optionally, qualifier fields. Each OID represents a policy, and the optional qualifier for a policy OID might be something like a text string explaining that policy. The idea the committee had in mind was that a policy in an <span class="docEmphasis">end entity</span> certificate (an <span class="docEmphStrong">end entity</span> is something other than a CA) would be something like how carefully identity was checked before the certificate was issued, and a policy in a CA-to-CA certificate would be which policies the issuing CA trusts the subject CA to assert.</p></li><li><p class="docList"><span class="docEmphSmaller">POLICY</span>M<span class="docEmphSmaller">APPINGS</span>. This is a sequence of pairs of OIDs, mapping from a policy in the issuer's domain to a policy in the subject's domain, assuming that the policies are similar but just defined by different OIDs.</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>A<span class="docEmphSmaller">LT</span>N<span class="docEmphSmaller">AME</span>. This is a sequence of names. This is the way to actually use the names that Internet applications might use, such as DNS names.</p></li><li><p class="docList"><span class="docEmphSmaller">ISSUER</span>A<span class="docEmphSmaller">LT</span>N<span class="docEmphSmaller">AME</span>. This is encoded like <span class="docEmphSmaller">SUBJECT</span>A<span class="docEmphSmaller">LT</span>N<span class="docEmphSmaller">AME</span>.</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>D<span class="docEmphSmaller">IRECTORY</span>A<span class="docEmphSmaller">TTRIBUTES</span>. This allows specifying attributes, such as date of birth or security clearance, of the subject.</p></li><li><p class="docList"><span class="docEmphSmaller">BASIC</span>C<span class="docEmphSmaller">ONSTRAINTS</span>. This gives permission to the subject to issue more certificates. There are two constraints listed. One is a flag indicating whether the subject is allowed to be a CA (duplicating the <span class="docEmphSmaller">KEY</span>U<span class="docEmphSmaller">SAGE</span> flag that indicates the same thing), and the other indicates the length of chain allowed following the subject (where 0 means one more certificate is allowed in the chain).</p></li><li><p class="docList"><span class="docEmphSmaller">NAME</span>C<span class="docEmphSmaller">ONSTRAINTS</span>. This indicates the names for which the subject is trusted to issue certificates. Permitted as well as excluded subtrees can be specified.</p></li><li><p class="docList"><span class="docEmphSmaller">POLICY</span>C<span class="docEmphSmaller">ONSTRAINTS</span>. This extension allows the issuer to specify that, after <span class="docEmphasis">n</span> more certificates in the chain, policy mapping is no longer permitted. It also allows the issuer to specify that policy OIDs must appear in subsequent certificates, even if the application verifying the chain doesn't care. One defined policy is <span class="docEmphasis">any policy</span>, which means the CA doesn't care about policies. But if a previous CA wants all subsequent CAs to not only put in policies, but to not weasel out of it by using the special <span class="docEmphasis">any policy</span>, then it can use the <span class="docEmphSmaller">INHIBIT</span>A<span class="docEmphSmaller">NY</span>P<span class="docEmphSmaller">OLICY</span> extension (see below).</p></li><li><p class="docList"><span class="docEmphSmaller">EXTENDED</span>K<span class="docEmphSmaller">EY</span>U<span class="docEmphSmaller">SAGE</span>. These are additional key usages, defined by an OID, to make it easy to define new key usages. A few are defined in PKIX, with usages that are consistent with some of the usages in the regular <span class="docEmphSmaller">KEY</span>U<span class="docEmphSmaller">SAGE</span> field. For instance, one of the defined extended key usages is for timestamping, which PKIX says is consistent with <span class="docEmphSmaller">KEY</span>U<span class="docEmphSmaller">SAGE</span> of <span class="docEmphasis">digital signature</span> and/or <span class="docEmphasis">nonrepudiation</span>.</p></li><li><p class="docList"><span class="docEmphSmaller">C</span>RLD<span class="docEmphSmaller">ISTRIBUTION</span>P<span class="docEmphSmaller">OINTS</span>. This describes how to find the CRL, and if the CRL issuer is not the CA, who the CRL issuer is.</p></li><li><p class="docList"><span class="docEmphSmaller">INHIBIT</span>A<span class="docEmphSmaller">NY</span>P<span class="docEmphSmaller">OLICY</span>. This specifies that the subject (or a CA at a specified distance down the chain) is not allowed to use <span class="docEmphasis">any policy</span> in its <span class="docEmphSmaller">POLICY</span>C<span class="docEmphSmaller">ONSTRAINT field.</span></p></li><li><p class="docList"><span class="docEmphSmaller">FRESHEST</span>CRL. Describes how to obtain delta CRLs.</p></li><li><p class="docList"><span class="docEmphSmaller">AUTHORITY</span>I<span class="docEmphSmaller">NFO</span>A<span class="docEmphSmaller">CCESS</span>. Describes how to find information about the issuer of this certificate.</p></li><li><p class="docList"><span class="docEmphSmaller">SUBJECT</span>I<span class="docEmphSmaller">NFO</span>A<span class="docEmphSmaller">CCESS</span>. Describes how to find information about the subject of this certificate. For instance, if the subject is a CA, it might specify how to find the certificates issued by that CA.</p></li></ul></li></ul>
<a name="ch15lev2sec20"></a>
<h4 id="title-IDAV3FUJ" class="docSection2Title">15.7.1. X.509 and PKIX CRLs</h4>
<p class="docText">An X.509/PKIX CRL contains the following information:</p>
<ul><li><p class="docList"><span class="docEmphSmaller">SIGNATURE</span>. Identical to the <span class="docEmphSmaller">SIGNATURE</span> field in certificates, this specifies the algorithm used to compute the signature on this CRL.</p></li><li><p class="docList"><span class="docEmphSmaller">ISSUER</span>. Identical to the <span class="docEmphSmaller">ISSUER</span> field in certificates, this is the X.500 name of the issuing CA.</p></li><li><p class="docList"><span class="docEmphSmaller">THIS</span>U<span class="docEmphSmaller">PDATE</span>. This contains the time the CRL was issued.</p></li><li><p class="docList"><span class="docEmphSmaller">NEXT</span>U<span class="docEmphSmaller">PDATE</span>. Optional. This contains the time the next CRL is expected to be issued. A reasonable policy is to treat as suspect any certificate issued by a CA whose current CRL has a <span class="docEmphSmaller">NEXT</span>U<span class="docEmphSmaller">PDATE</span> time in the past.</p></li></ul>
<p class="docText">The following three fields repeat together, once for each revoked certificate:</p>
<ul><li><p class="docList"><span class="docEmphSmaller">USER</span>C<span class="docEmphSmaller">ERTIFICATE</span>. This contains the serial number of the revoked certificate.</p></li><li><p class="docList"><span class="docEmphSmaller">REVOCATION</span>D<span class="docEmphSmaller">ATE</span>. This contains the time the certificate was revoked.</p></li><li><p class="docList"><span class="docEmphSmaller">CRL</span>E<span class="docEmphSmaller">NTRY</span>E<span class="docEmphSmaller">XTENSIONS</span>. This contains various optional information such as a reason code for why the certificate was revoked.</p></li><li><p class="docList"><span class="docEmphSmaller">CRL</span>E<span class="docEmphSmaller">XTENSIONS</span>. This contains various optional information such as authority key identifier, issuer alternative name, the CRL number, the delta CRL indicator (used in delta CRLs to specify the base CRL number), and a flag indicating that the CRL only contains CA certificates or only contains end entity certificates.</p></li><li><p class="docList"><span class="docEmphSmaller">ALGORITHM</span>I<span class="docEmphSmaller">DENTIFIER</span>. As for certificates, this repeats the <span class="docEmphSmaller">SIGNATURE</span> field.</p></li><li><p class="docList"><span class="docEmphSmaller">ENCRYPTED</span>. This field contains the signature on all but the last of the above fields.</p></li></ul>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch15lev1sec6.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch15lev1sec8.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>