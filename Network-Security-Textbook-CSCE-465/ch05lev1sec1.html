<html><head><title>5.1. Introduction</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a>Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch05lev1sec1"></a>
<h3 id="title-IDASN5UC" class="docSection1Title">5.1. Introduction</h3>
<blockquote>
<p class="docText"><a name="iddle1414"></a><a name="iddle1608"></a><a name="iddle1616"></a><a name="iddle1620"></a><a name="iddle1629"></a><a name="iddle1742"></a><a name="iddle1882"></a><a name="iddle1962"></a><a name="iddle1990"></a><span class="docEmphasis">Random numbers should not be generated with a method chosen at random.</span></p>
<p class="docText">ÂDonald Knuth</p></blockquote>
<p class="docText"><span class="docEmphStrong">A hash</span> (also known as a <span class="docEmphStrong">message digest</span>) is a <span class="docEmphStrong">one-way function</span>. It is considered a <span class="docEmphStrong">function</span> because it takes an input message and produces an output. It is considered <span class="docEmphStrong">one-way</span> because it's not practical to figure out what input corresponds to a given output. For a message digest function to be considered cryptographically secure, it must be computationally infeasible to find a message that has a given prespecified message digest, and it similarly should be impossible to find two messages that have the same message digest. Also (which follows from the previous properties), given a message it should be impossible to find a different message with the same message digest.</p>
<p class="docText">We will use the terms <span class="docEmphasis">hash</span> and <span class="docEmphasis">message digest</span> interchangeably. The NIST message digest function is called <span class="docEmphStrong">SHA-1</span>, which stands for <span class="docEmphStrong">secure hash algorithm</span>, whereas the <span class="docEmphasis">MD</span> in the MD2, MD4, and MD5 algorithms stands for <span class="docEmphasis">message digest</span>. All of the digest/hash algorithms do basically the same thing, which is to take an arbitrary-length message and wind up with a fixed-length quantity.</p>
<p class="docText">There's an intuitive notion of <span class="docEmphStrong">randomness</span> that is important to the understanding of message digest functions. We are not trying to create a math book, so our description will be mathematically imprecise. We are merely trying to capture the intuition. We explained before that with secret key cryptography, it is desirable for the mapping from input to output to appear randomly chosen. In other words, it should look (to someone who does not know the secret key) like someone flipped coins to determine, for each possible input, what the output should be. Examples of what this means are:</p>
<ul><li><p class="docList">If 1000 inputs are selected at random, any particular bit in the 1000 resulting outputs should be on about half the time.</p></li><li><p class="docList"><a name="iddle1378"></a>Each output should have, with high probability, about half the bits on.</p></li><li><p class="docList">Any two outputs should be completely uncorrelated, no matter how similar the inputs are. So for instance, two inputs that differ by only one bit should have outputs that look like completely independently chosen random numbers. About half the bits in the two outputs should differ.</p></li></ul>
<p class="docText">This sort of randomness is important for message digests as well. It is true that someone who knows the message and the digest function can calculate the output, and therefore the output is certainly provably not generated by flipping coins. But ignoring that, the output should look random. It should not be possible, other than by computing the message digest, to predict any portion of the output. And in particular it should be true that, for any subset of bits in the message digest, the only way of obtaining two messages with the same value in those bits would be to try messages at random and compute the message digest of each until two happened to have the same value. Given this property, a secure message digest function with <span class="docEmphasis">n</span> bits should be derivable from a message digest function with more than <span class="docEmphasis">n</span> bits merely by taking any particular subset of <span class="docEmphasis">n</span> bits from the larger message digest.</p>
<p class="docText">There certainly will be many messages that yield the same message digest, because a message can be of arbitrary length and the message digest will be some fixed length, for instance 128 bits. For instance, for 1000-bit messages and a 128-bit message digest, there are on the average 2<sup>872</sup> messages that map to any one particular message digest. So certainly, by trying lots of messages, one would eventually find two that mapped to the same message digest. The problem is that &quot;lots&quot; is so many that it is essentially impossible. Assuming a good 128-bit message digest function, it would take trying approximately 2<sup>128</sup> possible messages before one would find a message that mapped to a particular message digest, or approximately 2<sup>64</sup> messages before finding two that had the same digest (see <span class="docEmphasis">The Birthday Problem</span>, below).</p>
<p class="docText">An example use of a message digest is to <span class="docEmphStrong">fingerprint</span> a program or document to detect modification of it. If you know the message digest of the program (and store the message digest securely so that it can't be modified, and compute the message digest of the program before running it, and check to make sure that it matches the stored value), then nobody will be able to modify the program without being detected, because they will not be able to find a different program with the same message digest.</p>
<p class="docText">How many bits does the output of a message digest function have to be in order to prevent someone from being able to find two messages with the same message digest? Well, if the message digest has <span class="docEmphasis">m</span> bits, then it would take only about 2<sup><span class="docEmphasis">m</span>/2</sup> messages, chosen at random, before one would find two with the same value. So if there were a 64-bit message digest function, it would only take searching 2<sup>32</sup> messages before one could find two with the same value, and it is feasible to search 2<sup>32</sup> messages. That is why message digest functions have outputs of at least 128 bits, because it is not considered feasible to search 2<sup>64</sup> messages given the current state of the art.</p>
<p class="docText"></p><a name="ch05sb01"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">The Birthday Problem</h2>
<p class="docText"><a name="iddle1122"></a>If there are 23 or more people in a room, the odds are better than 50% that two of them will have the same birthday. Analyzing this parlor trick can give us some insight into cryptography. We'll assume that a birthday is basically an unpredictable function taking a human to one of 365 values (yeah yeah, 366 for you nerds).</p>
<p class="docText">Let's do this in a slightly more general way. Let's assume <span class="docEmphasis">n</span> inputs (which would be humans in the birthday example) and <span class="docEmphasis">k</span> possible outputs, and an unpredictable mapping from input to output. With <span class="docEmphasis">n</span> inputs, there are <span class="docEmphasis">n</span>(<span class="docEmphasis">n</span>-1)/2 pairs of inputs. For each pair there's a probability of 1/<span class="docEmphasis">k</span> of both inputs producing the same output value, so you'll need about <span class="docEmphasis">k</span>/2 pairs in order for the probability to be about 50% that you'll find a matching pair. That means that if <span class="docEmphasis">n</span> is greater than 

<img border="0" alt="" width="15" height="13" src="119equ01.jpg" />


, there's a good chance of finding a matching pair.</p>
</td></tr></table></p><br />
<p class="docText">If cryptographers were happy with message digest functions that merely made it infeasible to find a message with a particular prespecified digest (rather than being worried about being able to find any pair with the same digest), then a 64-bit digest would suffice.</p>
<p class="docText">Why are we worried about someone being able to find any two messages with the same message digest, instead of only worrying about finding a message with a particular prespecified message digest? In most applications, to subvert a system an attacker has to find a misleading message whose message digest matches that of a pre-existing message. However, there are cases where being able to find two messages with the same message digest is a threat to the security of the system.</p>
<p class="docText">Suppose Alice wants to fire Fred, and asks her diabolical secretary, Bob, who happens to be Fred's friend, to compose a letter explaining that Fred should be fired, and why. After Bob writes the letter, Alice will read it, compute a message digest, and cryptographically sign the message digest using her private key. Bob would like to instead write a letter saying that Fred is wonderful and his salary ought to be doubled. However, Bob cannot generate a message digest signed with Alice's key. If he can find two messages with the same message digest, one that Alice will look at and agree to sign because it captures what she'd like it to say, and one that says what Bob would like it to say, then Bob can substitute his own message after Alice generates the signed message digest.</p>
<p class="docText">Suppose the message digest function has only 64 bits, and is a good message digest function in the sense of its output looking random. Then the only way to find two messages with the same message digest would be by trying enough messages so that by the birthday problem two would have the same digest.</p>
<p class="docText">If Bob started by writing a letter that Alice would approve of, found the message digest of that, and then attempted to find a different message with that message digest, he'd have to try 2<sup>64</sup> <a name="iddle1835"></a>different messages. However, suppose he had a way of generating lots of messages of each type (type 1Âthose that Alice would be willing to sign; type 2Âthose that Bob would like to send). Then by the birthday problem he'd only have to try about 2<sup>32</sup> messages of each type before he found two that matched. (See <a class="docLink" href="ch04lev1sec5.html#ch04qa1q3">Homework Problem 3</a>.)</p>
<p class="docText">How can Bob possibly generate that many letters, especially since they'd all have to make sense to a human? Well, suppose there are 2 choices of wording in each of 32 places in the letter. Then there are 2<sup>32</sup> possible messages he can generate. For example:</p>
<p class="docText">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Type&nbsp;1&nbsp;message<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="docEmphasis">I&nbsp;am&nbsp;writing</span>&nbsp;{<span class="docEmphasis">this&nbsp;memo</span>|}&nbsp;<span class="docEmphasis">to</span>&nbsp;{<span class="docEmphasis">demand</span>&nbsp;|&nbsp;<span class="docEmphasis">request</span>&nbsp;|&nbsp;<span class="docEmphasis">inform&nbsp;you</span>}&nbsp;<span class="docEmphasis">that</span>&nbsp;{<span class="docEmphasis">Fred</span>&nbsp;|&nbsp;<span class="docEmphasis">Mr.&nbsp;Fred&nbsp;Jones</span>}<br />{<span class="docEmphasis">must</span>&nbsp;|}&nbsp;<span class="docEmphasis">be</span>&nbsp;{<span class="docEmphasis">fired</span>&nbsp;|&nbsp;<span class="docEmphasis">terminated</span>}{<span class="docEmphasis">at&nbsp;once</span>&nbsp;|&nbsp;<span class="docEmphasis">immediately</span>}<span class="docEmphasis">.&nbsp;As&nbsp;the</span>&nbsp;{<span class="docEmphasis">July&nbsp;11</span>&nbsp;|&nbsp;<span class="docEmphasis">11&nbsp;July</span>}&nbsp;{<span class="docEmphasis">memo</span>&nbsp;|&nbsp;<span class="docEmphasis">memorandum</span>}<br />{<span class="docEmphasis">from</span>&nbsp;|&nbsp;<span class="docEmphasis">issued&nbsp;by</span>}&nbsp;{<span class="docEmphasis">personnel</span>&nbsp;|&nbsp;<span class="docEmphasis">human&nbsp;resources</span>}&nbsp;<span class="docEmphasis">states,&nbsp;to&nbsp;meet</span>&nbsp;{<span class="docEmphasis">our</span>&nbsp;|&nbsp;<span class="docEmphasis">the&nbsp;corporate</span>}<br />{<span class="docEmphasis">quarterly</span>&nbsp;|&nbsp;<span class="docEmphasis">third&nbsp;quarter</span>}&nbsp;<span class="docEmphasis">budget</span>&nbsp;{<span class="docEmphasis">targets</span>&nbsp;|&nbsp;<span class="docEmphasis">goals</span>},&nbsp;{<span class="docEmphasis">we&nbsp;must&nbsp;eliminate&nbsp;all&nbsp;discretionary&nbsp;spending</span>&nbsp;|<br /><span class="docEmphasis">all&nbsp;discretionary&nbsp;spending&nbsp;must&nbsp;be&nbsp;eliminated</span>}.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="docEmphasis">Despite</span>&nbsp;|&nbsp;<span class="docEmphasis">Ignoring</span>}&nbsp;<span class="docEmphasis">that</span>&nbsp;{<span class="docEmphasis">memo</span>&nbsp;|&nbsp;<span class="docEmphasis">memorandum</span>&nbsp;|&nbsp;<span class="docEmphasis">order</span>}<span class="docEmphasis">,&nbsp;Fred</span>&nbsp;{<span class="docEmphasis">ordered</span>&nbsp;|&nbsp;<span class="docEmphasis">purchased</span>}&nbsp;{<span class="docEmphasis">PostIts</span><br />|&nbsp;<span class="docEmphasis">nonessential&nbsp;supplies</span>}&nbsp;<span class="docEmphasis">in&nbsp;a&nbsp;flagrant&nbsp;disregard&nbsp;for&nbsp;the&nbsp;company's</span>&nbsp;{<span class="docEmphasis">budgetary&nbsp;crisis</span>&nbsp;|&nbsp;<span class="docEmphasis">current</span><br /><span class="docEmphasis">financial&nbsp;difficulties</span>}.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Type&nbsp;2&nbsp;message<br /><span class="docEmphasis">I&nbsp;am&nbsp;writing</span>&nbsp;{<span class="docEmphasis">this&nbsp;letter</span>&nbsp;|&nbsp;<span class="docEmphasis">this&nbsp;memo</span>&nbsp;|&nbsp;<span class="docEmphasis">this&nbsp;memorandum</span>&nbsp;|&nbsp;}&nbsp;<span class="docEmphasis">to</span>&nbsp;{<span class="docEmphasis">officially</span>&nbsp;|&nbsp;}&nbsp;<span class="docEmphasis">commend&nbsp;Fred</span><br />{<span class="docEmphasis">Jones</span>&nbsp;|&nbsp;}&nbsp;<span class="docEmphasis">for&nbsp;his</span>&nbsp;{<span class="docEmphasis">courage&nbsp;and&nbsp;independent&nbsp;thinking</span>&nbsp;|&nbsp;<span class="docEmphasis">independent&nbsp;thinking&nbsp;and&nbsp;courage</span>}.&nbsp;{<span class="docEmphasis">He</span>&nbsp;|<br /><span class="docEmphasis">Fred</span>}&nbsp;{<span class="docEmphasis">clearly</span>&nbsp;|&nbsp;}&nbsp;<span class="docEmphasis">understands</span>&nbsp;{<span class="docEmphasis">the&nbsp;need</span>&nbsp;|&nbsp;<span class="docEmphasis">how</span>}&nbsp;<span class="docEmphasis">to&nbsp;get</span>&nbsp;{<span class="docEmphasis">the</span>&nbsp;|&nbsp;<span class="docEmphasis">his</span>}&nbsp;<span class="docEmphasis">job</span>&nbsp;{<span class="docEmphasis">done</span>&nbsp;|&nbsp;<span class="docEmphasis">accomplished</span>}&nbsp;{<span class="docEmphasis">at&nbsp;all</span><br /><span class="docEmphasis">costs&nbsp;|&nbsp;by&nbsp;whatever&nbsp;means&nbsp;necessary</span>}<span class="docEmphasis">,&nbsp;and</span>&nbsp;{<span class="docEmphasis">knows</span>&nbsp;|&nbsp;<span class="docEmphasis">can&nbsp;see</span>}&nbsp;<span class="docEmphasis">when&nbsp;to&nbsp;ignore&nbsp;bureaucratic</span>&nbsp;{<span class="docEmphasis">nonsense</span><br />|&nbsp;<span class="docEmphasis">impediments</span>}<span class="docEmphasis">.&nbsp;I</span>&nbsp;{<span class="docEmphasis">am&nbsp;hereby&nbsp;recommending</span>&nbsp;|&nbsp;<span class="docEmphasis">hereby&nbsp;recommend</span>}&nbsp;{<span class="docEmphasis">him</span>&nbsp;|&nbsp;<span class="docEmphasis">Fred</span>}&nbsp;<span class="docEmphasis">for</span>&nbsp;{<span class="docEmphasis">promotion</span><br />|&nbsp;<span class="docEmphasis">immediate&nbsp;advancement</span>}&nbsp;<span class="docEmphasis">and</span>&nbsp;{<span class="docEmphasis">further</span>&nbsp;|&nbsp;}&nbsp;<span class="docEmphasis">recommend&nbsp;a</span>&nbsp;{<span class="docEmphasis">hefty</span>&nbsp;|&nbsp;<span class="docEmphasis">large</span>}&nbsp;{<span class="docEmphasis">salary</span>&nbsp;|<br /><span class="docEmphasis">compensation</span>}&nbsp;<span class="docEmphasis">increase.</span></p>
<p class="docText">There are enough computer-generatable variants of the two letters that Bob can compute message digests on the various variants until he finds a match. It is within computational feasibility to generate and test on the order of 2<sup>32</sup> messages, whereas it would not be feasible to deal with 2<sup>64</sup> messages.</p>
<p class="docText">As we will see in <a class="docLink" href="ch06.html#ch06">Chapter 6</a> <span class="docEmphasis">Public Key Algorithms</span>, the math behind RSA and other public key cryptographic algorithms is quite understandable. In contrast, message digest functions are like alchemy. It's a bunch of steps that each mangle the message more and more. The functions sound like a bunch of people got together and each person had some idea for mangling the message further. &quot;And now let's swap every bit with the complement of the bit 11 bits to the right!&quot; &quot;How about let's multiply every set of 12 adjacent bits by the constant 384729?&quot; &quot;How about we throw in <span class="docEmphasis">I</span>(<span class="docEmphasis">newt</span>)?&quot; And every suggestion is adopted by the group. It is possible to follow all the steps, but the incomprehensible part is why this particular shuffling of the message is done, and why it couldn't be simpler and yet just as secure.</p>
<p class="docText">A plausible way of constructing a message digest function is to combine lots of perverse operations into a potential message digest function, and then play with it. If any patterns are detected in the output the function is rejected, or perhaps more perverse operations are folded into it.</p>
<p class="docText">Ideally, the message digest function should be easy to compute. One wonders what the &quot;minimal&quot; secure message digest function might be. It is safer for a function to be overkill, in the sense of shuffling beyond what it necessary, but then it is harder to compute than necessary. The designers would rather waste computation than discover later that the function was not secure. Just as with secret key algorithms, the digest algorithms tend to be computed in rounds. It is likely that the designers find the smallest number of rounds necessary before the output passes various randomness tests, and then do a few more just to be safe.</p>
<p class="docText">There is an interesting bit of folklore in the choice of constants in cryptographic algorithms. Often a &quot;random number&quot; is needed. If the designer of the algorithm chooses a specific number without explanation as to where that number came from, people are suspicious that there might be some hidden flaw that the designer of the algorithm wishes to exploit, and will be able to because the designer knows some hidden properties of that choice of number. Therefore, often the algorithm designers specify how they chose a particular random number. It is often done based on the digits of &#960; or some other irrational number. There was also a book published in the 1930s of random numbers generated from a mechanically random source. People have used some of the numbers in that as well on the theory that cryptography was not well understood then so it is inconceivable that someone could have planted special numbers.</p>
<p class="docText">At the end of this chapter we'll describe the major hash functions which have been proposed as standards. Ron Rivest designed MD2, MD4, and MD5. These are all documented in RFCs (1319, 1320, and 1321). In MD2 all operations are done with octets (the microprocessors at the time operated on octets), whereas the other standards operate on 32-bit words (today's microprocessors efficiently compute with 32-bit quantities). In fact, now that there are 64-bit microprocessors, it's quite possible a new <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_128">MD</a></span> algorithm optimized for that architecture will be developed.</p>
<a href="15051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch05.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch05lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>