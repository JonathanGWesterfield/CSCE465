<html><head><title>13.2. Tickets and Ticket-Granting Tickets</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch13lev1sec1.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch13lev1sec3.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch13lev1sec2"></a>
<h3 id="643999-865" class="docSection1Title">13.2. Tickets and Ticket-Granting Tickets</h3>
<p class="docText">The KDC shares a secret key, known as a <span class="docEmphStrong">master key</span>, with each <b><a class="docLink" href="app02.html#gloss01_170">principal</a></b> (each user and each resource that will be using Kerberos). When Alice informs the KDC that she wants to talk to Bob, the KDC invents a session key <span class="docEmphasis">K</span><sub>AB</sub> for Alice and Bob to share, encrypts <span class="docEmphasis">K</span><sub>AB</sub> with Alice's master key for Alice, encrypts <span class="docEmphasis">K</span><sub>AB</sub> with Bob's master key for Bob, and returns all this information to Alice. The message consisting of the session key <span class="docEmphasis">K</span><sub>AB</sub> (and other information such as Alice's name) encrypted with Bob's master key is known as a <b><a class="docLink" href="app02.html#gloss01_224">ticket</a></b> to Bob. Alice can't read what's inside the ticket, because it's encrypted with Bob's master key. Bob can decrypt the ticket and discover <span class="docEmphasis">K</span><sub>AB</sub> and Alice's name. Bob knows, based on the ticket, that anyone else who knows <span class="docEmphasis">K</span><sub>AB</sub> is acting on Alice's behalf. So Alice and Bob can authenticate each other, and optionally encrypt or integrity-protect their entire conversation, based on the shared key <span class="docEmphasis">K</span><sub>AB</sub>. The session key <span class="docEmphasis">K</span><sub>AB</sub> together with the ticket to Bob are known as Alice's <b><a class="docLink" href="app02.html#gloss01_057">credentials</a></b> to Bob.</p>
<p class="docText">Alice logs into a workstation by supplying her name and password. Alice's master key is derived from her password. The workstation, which performs the authentication protocol on behalf of Alice, could remember her password during the whole login session and use that when proof of her identity was required. But that is not good security practice for various reasons. One worry is that Alice might, during the login session, run untrustworthy software that might steal her password. To minimize harm, the first thing that happens is that the workstation asks the KDC for a session key <span class="docEmphasis">S</span><sub>A</sub> for Alice to use for just this one session. The session key <span class="docEmphasis">S</span><sub>A</sub> is then used on Alice's behalf when asking for tickets to resources on the network. The key <span class="docEmphasis">S</span><sub>A</sub> is only valid for some small amount of time, generally a few hours. If anyone steals <span class="docEmphasis">S</span><sub>A</sub>, then they can impersonate Alice, but only until <span class="docEmphasis">S</span><sub>A</sub> expires.</p>
<p class="docText">During the initial login, the workstation, on Alice's behalf, asks the KDC for a session key for Alice. The KDC generates a session key <span class="docEmphasis">S</span><sub>A</sub>, and transmits <span class="docEmphasis">S</span><sub>A</sub> (encrypted with Alice's master key) to the workstation. The KDC also sends a <b><a class="docLink" href="app02.html#gloss01_222">ticket-granting ticket <span class="docEmphRoman">(</span>TGT<span class="docEmphRoman">)</span></a></b>, which is <span class="docEmphasis">S</span><sub>A</sub> (and other information such as Alice's name and the TGT's expiration time) encrypted with the KDC's master key.</p>
<p class="docText"><a name="iddle1031"></a><a name="iddle1102"></a><a name="iddle1520"></a><a name="iddle1605"></a><a name="iddle2058"></a><a name="iddle2078"></a>The workstation uses Alice's master key (derived from her password) to decrypt the encrypted <span class="docEmphasis">S</span><sub>A</sub>. Then the workstation forgets Alice's password and only remembers <span class="docEmphasis">S</span><sub>A</sub> and the TGT. When Alice later needs to access a remote resource, her workstation transmits the TGT to the KDC, along with the name of the resource to which Alice needs a ticket (say Bob). The KDC decrypts the TGT to discover <span class="docEmphasis">S</span><sub>A</sub>, and uses <span class="docEmphasis">S</span><sub>A</sub> to encrypt the Alice-Bob session key for Alice. Essentially, the TGT informs the KDC to use <span class="docEmphasis">S</span><sub>A</sub> instead of Alice's master key.</p>
<p class="docText">Earlier versions of Kerberos did not have the notion of a TGT. The user's master key was always used when communicating with the KDC. Later, for enhanced security, the notion of obtaining a limited-lifetime session key at login time was added. The idea was that only TGTs were gotten from the KDC, and that other tickets were obtained from what was theoretically a different entity, which Kerberos calls a <b><a class="docLink" href="app02.html#gloss01_222">Ticket-Granting Server</a></b> or <span class="docEmphStrong">TGS</span>. However, the Ticket-Granting Server has to have the same database as the KDC (it needs to know Bob's secret key in order to give Alice a ticket for Bob). So in Kerberos, the Ticket-Granting Server and the KDC are really the same thing. It would be easier to understand Kerberos if the documentation didn't refer to two different entities (KDC and TGS) and two sets of protocol messages that basically do the same thing. The reason it is described that way in Kerberos documentation is solely due to how the protocol evolved.</p>
<p class="docText">The Kerberos documentation refers to an Authentication Server (AS) and a Ticket-Granting Server (TGS) which are collocated at the KDC, meaning they are really the same thing. We will use the terms KDC, AS, and TGS interchangeably, since we do not find the distinction to be useful for understanding Kerberos, and in reality there is no distinction.</p>
<ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="16051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch13lev1sec1.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch13lev1sec3.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>