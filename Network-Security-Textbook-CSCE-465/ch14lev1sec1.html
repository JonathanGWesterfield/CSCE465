<html><head><title>14.1. ASN.1</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch14.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch14lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">Networking Security Networking Security Networking Security Security Networking Security Networking Security Networking Charlie Kaufman Radia Perlman Mike Speciner Prentice Hall Network Security: Private Communication in a Public World, Second Edition<a name="ch14lev1sec1"></a>
<h3 id="title-IDAZNLAD" class="docSection1Title">14.1. ASN.1</h3>
<p class="docText">ASN.1 [<a class="docLink" href="biblio01.html#biblio01_080">ISO87</a>, <a class="docLink" href="biblio01.html#biblio01_132">PISC93</a>] is a data representation language standardized by ISO. It looks very similar to data structure definitions in programming languages. ASN.1 is popular among spec writers and standards bodies because it gives people a way to precisely define data structures without worrying about different data representations, such as bit and octet order, on different machines.</p>
<p class="docText">Where Kerberos V4 messages had a largely fixed layout with variable-length fields marked in an ad hoc way, Kerberos V5 uses ASN.1 syntax with the Basic Encoding Rules (BER), which makes it easy for fields to be optional, of varying length, and tagged with type information to allow future versions to include additional encodings.</p>
<p class="docText">This flexibility comes with a price. ASN.1 has a lot of overhead. It adds octets of overhead in databases and octets on the wire, and increases the complexity of the code. Often when people define things in ASN.1, they don't realize what the actual format will be. It is possible to use ASN.1 in a way that would create less overhead, but that takes expertise in ASN.1, and there are very few security protocol designers who have any interest in the specifics of ASN.1.</p>
<p class="docText">To illustrate the point, in Kerberos V4 an address is four octets. Admittedly this is not sufficiently flexible, since it assumes IP addresses. Had the Kerberos designers custom-designed a more flexible address format, they'd probably have designed something like</p>
<ul><li><p class="docList">a one-octet address type (defining type codes for IP and perhaps DECnet, <span class="docEmphRoman"><a class="docLink" href="app02.html#gloss01_047">CLNP</a></span>, IPX, and Appletalk)</p></li><li><p class="docList">a one-octet length, specifying the length in octets of the address (this is needed because some address types, for instance CLNP, are variable-length)</p></li><li><p class="docList">and then the address.</p></li></ul>
<p class="docText">With this format it would have taken six octets to encode an IP address, rather than four in Kerberos V4. However, Kerberos V5 defines an address using the ASN.1 definition:</p>
<div class="docText"><pre>90</pre></div><br /><div class="docText"><pre><span class="docEmphStrong">HostAddress ::= SEQUENCE {</span>
            <span class="docEmphStrong">addr-type[0]     INTEGER,</span>
            <span class="docEmphStrong">address[1]       OCTET STRING }</span></pre></div><br />
<p class="docText">What does this mean? It means that an address has two components: <span class="docEmphStrong"><tt>addr-type</tt></span> and <span class="docEmphStrong"><tt>address</tt></span>. That sounds reasonable. But what does the Kerberos V5 definition of an address actually expand into? Somehow it adds 11 octets of overhead to each address, meaning that encoding an IP address in V5 requires 15 octets instead of V4's four octets.</p>
<p class="docText">Where does this 11 octet overhead come from? The construct <span class="docEmphStrong"><tt>SEQUENCE</tt></span> requires an octet to specify that it's a sequence, and an octet to specify the length of the entire sequence. The first component, <span class="docEmphStrong"><tt>addr-type[0] INTEGER</tt></span>, requires four octets of overhead in addition to the single-octet integer that specifies the type of address:</p>
<ul><li><p class="docList"><span class="docEmphStrong"><tt>addr-type[0]</tt></span> requires an octet to specify that it's type 0, then an octet to specify the length of what follows.</p></li><li><p class="docList"><span class="docEmphStrong"><tt>INTEGER</tt></span> requires a minimum of three octets: an octet to specify that it's an integer (<span class="docEmphSmaller">TYPE</span>), an octet to specify how many octets (<span class="docEmphSmaller">LENGTH</span>) of integer, and at least one octet giving the value of the integer.</p></li></ul>
<p class="docText">Similarly, the next component, <span class="docEmphStrong"><tt>address[1] OCTET STRING</tt></span>, requires four octets of overhead in addition to the actual address.</p>
<p class="docText">With clever use of ASN.1, it would have been possible to reduce the overhead substantially. For instance, by defining things with <span class="docEmphStrong"><tt>IMPLICIT</tt></span>, the representations are more compact, because then the <span class="docEmphSmaller">TYPE</span> and <span class="docEmphSmaller">LENGTH</span> fields do not appear. For example, four octets of overhead are avoided by defining an address as follows:</p>
<div class="docText"><pre>90</pre></div><br /><div class="docText"><pre><span class="docEmphStrong">HostAddress ::= SEQUENCE {</span>
            <span class="docEmphStrong">addr-type[0]     IMPLICIT INTEGER,</span>
            <span class="docEmphStrong">address[1]       IMPLICIT OCTET STRING }</span></pre></div><br />
<p class="docText">The above definition would reduce the overhead from 11 octets to 7 octets. An ASN.1 guru might define an address as follows:</p>
<div class="docText"><pre>90</pre></div><br /><div class="docText"><pre><span class="docEmphStrong">HostAddress ::= CHOICE {</span>
    <span class="docEmphStrong">ip_address[0]   IMPLICIT OCTET STRING,</span>
    <span class="docEmphStrong">clnp_address[1] IMPLICIT OCTET STRING,</span>
    <span class="docEmphStrong">ipx_address[2]  IMPLICIT OCTET STRING,</span>
    <span class="docEmphStrong">...}</span></pre></div><br />
<p class="docText"><a name="iddle1249"></a><a name="iddle1461"></a><a name="iddle1673"></a><a name="iddle1891"></a>That definition produces only two octets of overhead for an address (provided that the world doesn't invent more than 64 types of address), since it expands into a type (the number in square brackets), followed by a length, followed by the address.</p>
<p class="docText">Because ASN.1 is ugly to look at, and since the actual octet-expansion is pretty much irrelevant to any reader of this book, when we describe message formats and data structures in Kerberos V5 we'll just list the contents without being specific about the exact encoding.</p>
<p class="docText">In Kerberos V4, the B <span class="docEmphSmaller">BIT</span> in all the messages specifies the octet order of multi-octet fields. In V5, fields are described using ASN.1 syntax, which defines a canonical format for integers. This is an example where use of ASN.1 hides the complexity of the protocol, since ASN.1 ensures a canonical format.</p>
<a href="16051538.html"><img src="pixel.gif" alt="" width="1" height="1" border="0" /></a><ul></ul></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch14.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch14lev1sec2.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table></div><!--IP User 2--></td></tr></table></td></body></head></html>